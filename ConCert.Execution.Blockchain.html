<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
<link href="coqdoc.css" rel="stylesheet" type="text/css" />
<link href="coqdocjs.css" rel="stylesheet" type="text/css"/>
<link href="toc.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="config.js"></script>
<script type="text/javascript" src="coqdocjs.js"></script>
</head>

<body onload="document.getElementById('content').focus()">
  <div id="header">
    <span class="left">
      <span class="modulename"> <script> document.write(document.title) </script> </span>
      <span id="toggle-toc">Contents</span>
    </span>

    <span class="button" id="toggle-proofs"></span>

    <span class="right">
      <a href="https://github.com/AU-COBRA/ConCert" target="_balnk">Project Page</a>
      <a href="index.html">Index</a>
      <a href="toc.html">Table of contents</a>
    </span>
</div>
  <div id="content" tabindex="-1" onblur="document.getElementById('content').focus()">
    <div id="js-toc" class="toc" data-toc="h1,h2,h3,h4" data-toc-container="doc" data-toc-offset="-40">
      <div id="js-toc-header" class="toc-header">Contents:</div>
    </div>
    <div id="main">
<h1 class="libtitle">Library ConCert.Execution.Blockchain</h1>

<div class="code">
<span class="comment">(*&nbsp;This&nbsp;file&nbsp;defines&nbsp;blockchains,&nbsp;both&nbsp;a&nbsp;contract's&nbsp;view&nbsp;(which&nbsp;is<br/>
more&nbsp;computational)&nbsp;and&nbsp;the&nbsp;semantics&nbsp;of&nbsp;executing&nbsp;smart&nbsp;contracts<br/>
in&nbsp;a&nbsp;blockchain.<br/>
<br/>
The&nbsp;most&nbsp;important&nbsp;types&nbsp;are:<br/>
<br/>
*&nbsp;The&nbsp;ChainBase&nbsp;type,&nbsp;describing&nbsp;basic&nbsp;assumptions&nbsp;made&nbsp;of&nbsp;any&nbsp;blockchain.<br/>
In&nbsp;most&nbsp;cases&nbsp;we&nbsp;will&nbsp;abstract&nbsp;over&nbsp;this&nbsp;type.<br/>
<br/>
*&nbsp;The&nbsp;Chain&nbsp;type,&nbsp;describing&nbsp;a&nbsp;smart&nbsp;contract's&nbsp;view&nbsp;of&nbsp;the&nbsp;blockchain.<br/>
This&nbsp;is&nbsp;the&nbsp;the&nbsp;data&nbsp;that&nbsp;can&nbsp;be&nbsp;accessed&nbsp;by&nbsp;smart&nbsp;contracts.<br/>
<br/>
*&nbsp;The&nbsp;Action&nbsp;type,&nbsp;describing&nbsp;how&nbsp;smart&nbsp;contracts&nbsp;(and&nbsp;external&nbsp;users)<br/>
interact&nbsp;with&nbsp;the&nbsp;blockchain.&nbsp;We&nbsp;allow&nbsp;transfers,&nbsp;calls&nbsp;and&nbsp;deployment<br/>
of&nbsp;contracts.<br/>
<br/>
*&nbsp;The&nbsp;WeakContract&nbsp;type,&nbsp;describing&nbsp;a&nbsp;"weak"&nbsp;or&nbsp;"stringly"&nbsp;typed<br/>
version&nbsp;of&nbsp;smart&nbsp;contracts.&nbsp;Contracts&nbsp;are&nbsp;just&nbsp;two&nbsp;functions&nbsp;init&nbsp;and<br/>
receive&nbsp;to&nbsp;respectively&nbsp;initialize&nbsp;state&nbsp;on&nbsp;deployment&nbsp;and&nbsp;to&nbsp;update<br/>
state&nbsp;when&nbsp;receiving&nbsp;messages.&nbsp;The&nbsp;weak&nbsp;version&nbsp;of&nbsp;contracts&nbsp;means&nbsp;that<br/>
the&nbsp;state/message/setup&nbsp;types,&nbsp;which&nbsp;would&nbsp;normally&nbsp;vary&nbsp;with&nbsp;contracts,<br/>
are&nbsp;stored&nbsp;in&nbsp;a&nbsp;serialized&nbsp;format.<br/>
<br/>
*&nbsp;The&nbsp;Contract&nbsp;type,&nbsp;describing&nbsp;a&nbsp;more&nbsp;strongly&nbsp;typed&nbsp;version&nbsp;of&nbsp;a&nbsp;contract.<br/>
This&nbsp;is&nbsp;the&nbsp;same&nbsp;as&nbsp;the&nbsp;above&nbsp;except&nbsp;we&nbsp;abstract&nbsp;over&nbsp;the&nbsp;appropriate&nbsp;types.<br/>
Users&nbsp;of&nbsp;the&nbsp;framework&nbsp;will&nbsp;mostly&nbsp;need&nbsp;to&nbsp;deal&nbsp;with&nbsp;this.<br/>
<br/>
The&nbsp;next&nbsp;types&nbsp;deal&nbsp;with&nbsp;semantics.<br/>
<br/>
*&nbsp;The&nbsp;Environment&nbsp;type.&nbsp;This&nbsp;augments&nbsp;the&nbsp;Chain&nbsp;type&nbsp;with&nbsp;more&nbsp;information.<br/>
Environment&nbsp;can&nbsp;be&nbsp;thought&nbsp;of&nbsp;as&nbsp;the&nbsp;information&nbsp;that&nbsp;a&nbsp;realistic&nbsp;blockchain<br/>
implementation&nbsp;would&nbsp;need&nbsp;to&nbsp;keep&nbsp;track&nbsp;of&nbsp;to&nbsp;implement&nbsp;operations.&nbsp;For&nbsp;instance,<br/>
it&nbsp;is&nbsp;reasonable&nbsp;to&nbsp;assume&nbsp;that&nbsp;an&nbsp;implementation&nbsp;needs&nbsp;to&nbsp;access&nbsp;the&nbsp;state&nbsp;of<br/>
contracts,&nbsp;but&nbsp;not&nbsp;to&nbsp;assume&nbsp;that&nbsp;it&nbsp;needs&nbsp;to&nbsp;store&nbsp;the&nbsp;full&nbsp;transaction&nbsp;history<br/>
of&nbsp;all&nbsp;addresses.<br/>
<br/>
*&nbsp;The&nbsp;ActionEvaluation&nbsp;type.&nbsp;This&nbsp;specifies&nbsp;how&nbsp;to&nbsp;evaluate&nbsp;actions&nbsp;returned&nbsp;by<br/>
contracts&nbsp;or&nbsp;input&nbsp;in&nbsp;blocks.&nbsp;This&nbsp;related&nbsp;an&nbsp;environment&nbsp;and&nbsp;action&nbsp;to&nbsp;a&nbsp;new<br/>
environment&nbsp;and&nbsp;list&nbsp;of&nbsp;new&nbsp;actions&nbsp;to&nbsp;execute.<br/>
<br/>
*&nbsp;The&nbsp;ChainState&nbsp;type.&nbsp;This&nbsp;augments&nbsp;the&nbsp;Environment&nbsp;type&nbsp;with&nbsp;a&nbsp;queue&nbsp;of<br/>
"outstanding"&nbsp;actions&nbsp;that&nbsp;need&nbsp;to&nbsp;be&nbsp;executed.&nbsp;For&nbsp;instance,&nbsp;when&nbsp;a&nbsp;block&nbsp;is<br/>
added,&nbsp;its&nbsp;actions&nbsp;are&nbsp;put&nbsp;into&nbsp;this&nbsp;queue.<br/>
<br/>
*&nbsp;The&nbsp;ChainStep&nbsp;type.&nbsp;This&nbsp;specifies&nbsp;how&nbsp;the&nbsp;blockchain&nbsp;should&nbsp;execute&nbsp;smart<br/>
contracts,&nbsp;and&nbsp;how&nbsp;new&nbsp;blocks&nbsp;are&nbsp;added.&nbsp;It&nbsp;relates&nbsp;a&nbsp;ChainState&nbsp;to&nbsp;a&nbsp;new&nbsp;ChainState.<br/>
There&nbsp;are&nbsp;steps&nbsp;to&nbsp;allow&nbsp;adding&nbsp;blocks,&nbsp;evaluating&nbsp;actions&nbsp;in&nbsp;the&nbsp;queue&nbsp;and&nbsp;to<br/>
permute&nbsp;the&nbsp;queue&nbsp;(allowing&nbsp;to&nbsp;model&nbsp;any&nbsp;execution&nbsp;order).<br/>
<br/>
*&nbsp;The&nbsp;ChainTrace&nbsp;type.&nbsp;This&nbsp;just&nbsp;represents&nbsp;a&nbsp;sequence&nbsp;of&nbsp;steps.&nbsp;If&nbsp;a&nbsp;trace&nbsp;ends<br/>
in&nbsp;a&nbsp;state&nbsp;it&nbsp;means&nbsp;that&nbsp;state&nbsp;is&nbsp;reachable&nbsp;and&nbsp;there&nbsp;is&nbsp;a&nbsp;"semantically&nbsp;correct"<br/>
way&nbsp;of&nbsp;executing&nbsp;to&nbsp;get&nbsp;to&nbsp;this&nbsp;state.&nbsp;This&nbsp;type&nbsp;records&nbsp;the&nbsp;full&nbsp;history&nbsp;of&nbsp;a<br/>
blockchain's&nbsp;execution&nbsp;and&nbsp;it&nbsp;would&nbsp;thus&nbsp;be&nbsp;unrealistic&nbsp;to&nbsp;extract.<br/>
<br/>
*&nbsp;The&nbsp;ChainBuilderType&nbsp;type.&nbsp;This&nbsp;is&nbsp;a&nbsp;typeclass&nbsp;for&nbsp;implementations&nbsp;of&nbsp;blockchains,<br/>
where&nbsp;these&nbsp;implementations&nbsp;need&nbsp;to&nbsp;prove&nbsp;that&nbsp;they&nbsp;satisfy&nbsp;our&nbsp;semantics.<br/>
<br/>
*)</span><br/>

<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">Coq</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.ZArith.ZArith.html#"><span class="id" title="library">ZArith</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">Coq</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Lists.List.html#"><span class="id" title="library">List</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">Coq</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.micromega.Psatz.html#"><span class="id" title="library">Psatz</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">Coq</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Sorting.Permutation.html#"><span class="id" title="library">Permutation</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">Coq</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Classes.Morphisms.html#"><span class="id" title="library">Morphisms</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">ConCert.Execution</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="ConCert.Execution.ChainedList.html#"><span class="id" title="library">ChainedList</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">ConCert.Execution</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="ConCert.Execution.Monads.html#"><span class="id" title="library">Monads</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">ConCert.Execution</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="ConCert.Execution.ResultMonad.html#"><span class="id" title="library">ResultMonad</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">ConCert.Execution</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="ConCert.Execution.Serializable.html#"><span class="id" title="library">Serializable</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">ConCert.Utils</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="ConCert.Utils.Automation.html#"><span class="id" title="library">Automation</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">ConCert.Utils</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="ConCert.Utils.Extras.html#"><span class="id" title="library">Extras</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">ConCert.Utils</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="ConCert.Utils.RecordUpdate.html#"><span class="id" title="library">RecordUpdate</span></a>.<br/>

<br/>
<span class="id" title="keyword">Import</span> <span class="id" title="var">ListNotations</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="Amount" class="idref" href="#Amount"><span class="id" title="definition">Amount</span></a> := <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Numbers.BinNums.html#Z"><span class="id" title="inductive">Z</span></a>.<br/>
<span class="id" title="keyword">Bind Scope</span> <span class="id" title="var">Z_scope</span> <span class="id" title="keyword">with</span> <span class="id" title="var">Amount</span>.<br/>

<br/>
<span class="id" title="keyword">Class</span> <a id="ChainBase" class="idref" href="#ChainBase"><span class="id" title="record">ChainBase</span></a> :=<br/>
&nbsp;&nbsp;<a id="build_chain_base" class="idref" href="#build_chain_base"><span class="id" title="constructor">build_chain_base</span></a> {<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a id="Address" class="idref" href="#Address"><span class="id" title="projection">Address</span></a> : <span class="id" title="keyword">Type</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a id="address_eqb" class="idref" href="#address_eqb"><span class="id" title="projection">address_eqb</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Address:2"><span class="id" title="method">Address</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Address:2"><span class="id" title="method">Address</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#bool"><span class="id" title="inductive">bool</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a id="address_eqb_spec" class="idref" href="#address_eqb_spec"><span class="id" title="projection">address_eqb_spec</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">forall</span> (<a id="a:4" class="idref" href="#a:4"><span class="id" title="binder">a</span></a> <a id="b:5" class="idref" href="#b:5"><span class="id" title="binder">b</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Address:2"><span class="id" title="method">Address</span></a>), <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Bool.Bool.html#reflect"><span class="id" title="inductive">Bool.reflect</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#a:4"><span class="id" title="variable">a</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#b:5"><span class="id" title="variable">b</span></a>) (<a class="idref" href="ConCert.Execution.Blockchain.html#address_eqb:3"><span class="id" title="method">address_eqb</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#a:4"><span class="id" title="variable">a</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#b:5"><span class="id" title="variable">b</span></a>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a id="address_eqdec" class="idref" href="#address_eqdec"><span class="id" title="projection">address_eqdec</span></a> :&gt; <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp/stdpp.base.html#EqDecision"><span class="id" title="abbreviation">stdpp.base.EqDecision</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Address:2"><span class="id" title="method">Address</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a id="address_countable" class="idref" href="#address_countable"><span class="id" title="projection">address_countable</span></a> :&gt; <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp/stdpp.countable.html#Countable"><span class="id" title="class">countable.Countable</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Address:2"><span class="id" title="method">Address</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a id="address_serializable" class="idref" href="#address_serializable"><span class="id" title="projection">address_serializable</span></a> :&gt; <a class="idref" href="ConCert.Execution.Serializable.html#Serializable"><span class="id" title="class">Serializable</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Address:2"><span class="id" title="method">Address</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a id="address_is_contract" class="idref" href="#address_is_contract"><span class="id" title="projection">address_is_contract</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Address:2"><span class="id" title="method">Address</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#bool"><span class="id" title="inductive">bool</span></a>;<br/>
&nbsp;&nbsp;}.<br/>

<br/>
<span class="id" title="keyword">Global Opaque</span> <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#address_eqb"><span class="id" title="method">address_eqb</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#address_eqb_spec"><span class="id" title="method">address_eqb_spec</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#address_eqdec"><span class="id" title="method">address_eqdec</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#address_countable"><span class="id" title="method">address_countable</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#address_serializable"><span class="id" title="method">address_serializable</span></a>.<br/>

<br/>
<span class="id" title="keyword">Delimit</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">address_scope</span> <span class="id" title="keyword">with</span> <span class="id" title="var">address</span>.<br/>
<span class="id" title="keyword">Bind Scope</span> <span class="id" title="var">address_scope</span> <span class="id" title="keyword">with</span> <span class="id" title="var">Address</span>.<br/>
<span class="id" title="keyword">Infix</span> <a id="6f617e0e5500b437e5aeb1eaa876d41f" class="idref" href="#6f617e0e5500b437e5aeb1eaa876d41f"><span class="id" title="notation">&quot;</span></a>=?" := <a class="idref" href="ConCert.Execution.Blockchain.html#address_eqb"><span class="id" title="method">address_eqb</span></a> (<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 70) : <span class="id" title="var">address_scope</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="address_eq_refl" class="idref" href="#address_eq_refl"><span class="id" title="lemma">address_eq_refl</span></a> `{<a id="H:11" class="idref" href="#H:11"><span class="id" title="binder">ChainBase</span></a>} <a id="x:12" class="idref" href="#x:12"><span class="id" title="binder">x</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#address_eqb"><span class="id" title="method">address_eqb</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#x:12"><span class="id" title="variable">x</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#x:12"><span class="id" title="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">destruct</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#address_eqb_spec"><span class="id" title="method">address_eqb_spec</span></a> <span class="id" title="var">x</span> <span class="id" title="var">x</span>); <span class="id" title="tactic">auto</span>; <span class="id" title="tactic">congruence</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="address_eq_ne" class="idref" href="#address_eq_ne"><span class="id" title="lemma">address_eq_ne</span></a> `{<a id="H:13" class="idref" href="#H:13"><span class="id" title="binder">ChainBase</span></a>} <a id="x:14" class="idref" href="#x:14"><span class="id" title="binder">x</span></a> <a id="y:15" class="idref" href="#y:15"><span class="id" title="binder">y</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#x:14"><span class="id" title="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'&lt;&gt;'_x"><span class="id" title="notation">&lt;&gt;</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#y:15"><span class="id" title="variable">y</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#address_eqb"><span class="id" title="method">address_eqb</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#x:14"><span class="id" title="variable">x</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#y:15"><span class="id" title="variable">y</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">destruct</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#address_eqb_spec"><span class="id" title="method">address_eqb_spec</span></a> <span class="id" title="var">x</span> <span class="id" title="var">y</span>) <span class="id" title="keyword">as</span> [-&gt;|]; <span class="id" title="tactic">tauto</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="address_eq_sym" class="idref" href="#address_eq_sym"><span class="id" title="lemma">address_eq_sym</span></a> `{<a id="H:16" class="idref" href="#H:16"><span class="id" title="binder">ChainBase</span></a>} <a id="x:17" class="idref" href="#x:17"><span class="id" title="binder">x</span></a> <a id="y:18" class="idref" href="#y:18"><span class="id" title="binder">y</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#address_eqb"><span class="id" title="method">address_eqb</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#x:17"><span class="id" title="variable">x</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#y:18"><span class="id" title="variable">y</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#address_eqb"><span class="id" title="method">address_eqb</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#y:18"><span class="id" title="variable">y</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#x:17"><span class="id" title="variable">x</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#address_eqb_spec"><span class="id" title="method">address_eqb_spec</span></a> <span class="id" title="var">x</span> <span class="id" title="var">y</span>) <span class="id" title="keyword">as</span> [-&gt;|].<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Execution.Blockchain.html#address_eq_refl"><span class="id" title="lemma">address_eq_refl</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Execution.Blockchain.html#address_eq_ne"><span class="id" title="lemma">address_eq_ne</span></a>; <span class="id" title="tactic">auto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Global Ltac</span> <span class="id" title="var">destruct_address_eq</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="tactic">repeat</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| [<span class="id" title="var">H</span>: <span class="id" title="keyword">context</span>[<a class="idref" href="ConCert.Execution.Blockchain.html#address_eqb"><span class="id" title="method">address_eqb</span></a> ?<span class="id" title="var">a</span> ?<span class="id" title="var">b</span>] |- <span class="id" title="var">_</span>] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="tactic">rewrite</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#address_eq_sym"><span class="id" title="lemma">address_eq_sym</span></a> <span class="id" title="var">b</span> <span class="id" title="var">a</span>) <span class="id" title="tactic">in</span> *; <span class="id" title="tactic">destruct</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#address_eqb_spec"><span class="id" title="method">address_eqb_spec</span></a> <span class="id" title="var">a</span> <span class="id" title="var">b</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| [|- <span class="id" title="keyword">context</span>[<a class="idref" href="ConCert.Execution.Blockchain.html#address_eqb"><span class="id" title="method">address_eqb</span></a> ?<span class="id" title="var">a</span> ?<span class="id" title="var">b</span>]] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="tactic">rewrite</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#address_eq_sym"><span class="id" title="lemma">address_eq_sym</span></a> <span class="id" title="var">b</span> <span class="id" title="var">a</span>) <span class="id" title="tactic">in</span> *; <span class="id" title="tactic">destruct</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#address_eqb_spec"><span class="id" title="method">address_eqb_spec</span></a> <span class="id" title="var">a</span> <span class="id" title="var">b</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Section</span> <a id="Blockchain" class="idref" href="#Blockchain"><span class="id" title="section">Blockchain</span></a>.<br/>
<span class="id" title="keyword">Context</span> {<a id="Base:19" class="idref" href="#Base:19"><span class="id" title="binder">Base</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#ChainBase"><span class="id" title="class">ChainBase</span></a>}.<br/>

<br/>
<span class="comment">(*&nbsp;This&nbsp;represents&nbsp;the&nbsp;view&nbsp;of&nbsp;the&nbsp;blockchain&nbsp;that&nbsp;a&nbsp;contract<br/>
can&nbsp;access&nbsp;and&nbsp;interact&nbsp;with.&nbsp;*)</span><br/>
<span class="id" title="keyword">Record</span> <a id="Chain" class="idref" href="#Chain"><span class="id" title="record">Chain</span></a> :=<br/>
&nbsp;&nbsp;<a id="build_chain" class="idref" href="#build_chain"><span class="id" title="constructor">build_chain</span></a> {<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a id="chain_height" class="idref" href="#chain_height"><span class="id" title="projection">chain_height</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a id="current_slot" class="idref" href="#current_slot"><span class="id" title="projection">current_slot</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a id="finalized_height" class="idref" href="#finalized_height"><span class="id" title="projection">finalized_height</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>;<br/>
&nbsp;&nbsp;}.<br/>

<br/>
<span class="id" title="keyword">Record</span> <a id="ContractCallContext" class="idref" href="#ContractCallContext"><span class="id" title="record">ContractCallContext</span></a> :=<br/>
&nbsp;&nbsp;<a id="build_ctx" class="idref" href="#build_ctx"><span class="id" title="constructor">build_ctx</span></a> {<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;Address&nbsp;that&nbsp;initiated&nbsp;the&nbsp;transaction&nbsp;(never&nbsp;a&nbsp;contract)&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a id="ctx_origin" class="idref" href="#ctx_origin"><span class="id" title="projection">ctx_origin</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;Address&nbsp;of&nbsp;the&nbsp;immediate&nbsp;account&nbsp;that&nbsp;sent&nbsp;the&nbsp;call&nbsp;(can&nbsp;be&nbsp;a&nbsp;contract&nbsp;or&nbsp;a&nbsp;user&nbsp;account)&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a id="ctx_from" class="idref" href="#ctx_from"><span class="id" title="projection">ctx_from</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;Address&nbsp;of&nbsp;the&nbsp;contract&nbsp;being&nbsp;called&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a id="ctx_contract_address" class="idref" href="#ctx_contract_address"><span class="id" title="projection">ctx_contract_address</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;Balance&nbsp;of&nbsp;the&nbsp;contract&nbsp;being&nbsp;called&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a id="ctx_contract_balance" class="idref" href="#ctx_contract_balance"><span class="id" title="projection">ctx_contract_balance</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Amount"><span class="id" title="definition">Amount</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;Amount&nbsp;of&nbsp;currency&nbsp;passed&nbsp;in&nbsp;call&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a id="ctx_amount" class="idref" href="#ctx_amount"><span class="id" title="projection">ctx_amount</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Amount"><span class="id" title="definition">Amount</span></a>;<br/>
&nbsp;&nbsp;}.<br/>

<br/>
<span class="comment">(*&nbsp;Operations&nbsp;that&nbsp;a&nbsp;contract&nbsp;can&nbsp;return&nbsp;or&nbsp;that&nbsp;a&nbsp;user&nbsp;can&nbsp;use<br/>
to&nbsp;interact&nbsp;with&nbsp;a&nbsp;chain.&nbsp;*)</span><br/>
<span class="id" title="keyword">Inductive</span> <a id="ActionBody" class="idref" href="#ActionBody"><span class="id" title="inductive">ActionBody</span></a> :=<br/>
&nbsp;&nbsp;| <a id="act_transfer" class="idref" href="#act_transfer"><span class="id" title="constructor">act_transfer</span></a> (<a id="to:34" class="idref" href="#to:34"><span class="id" title="binder">to</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a>) (<a id="amount:35" class="idref" href="#amount:35"><span class="id" title="binder">amount</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Amount"><span class="id" title="definition">Amount</span></a>)<br/>
&nbsp;&nbsp;| <a id="act_call" class="idref" href="#act_call"><span class="id" title="constructor">act_call</span></a> (<a id="to:36" class="idref" href="#to:36"><span class="id" title="binder">to</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a>) (<a id="amount:37" class="idref" href="#amount:37"><span class="id" title="binder">amount</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Amount"><span class="id" title="definition">Amount</span></a>) (<a id="msg:38" class="idref" href="#msg:38"><span class="id" title="binder">msg</span></a> : <a class="idref" href="ConCert.Execution.Serializable.html#SerializedValue"><span class="id" title="record">SerializedValue</span></a>)<br/>
&nbsp;&nbsp;| <a id="act_deploy" class="idref" href="#act_deploy"><span class="id" title="constructor">act_deploy</span></a> (<a id="amount:39" class="idref" href="#amount:39"><span class="id" title="binder">amount</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Amount"><span class="id" title="definition">Amount</span></a>) (<a id="c:40" class="idref" href="#c:40"><span class="id" title="binder">c</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#WeakContract:31"><span class="id" title="inductive">WeakContract</span></a>) (<a id="setup:41" class="idref" href="#setup:41"><span class="id" title="binder">setup</span></a> : <a class="idref" href="ConCert.Execution.Serializable.html#SerializedValue"><span class="id" title="record">SerializedValue</span></a>)<br/>
<span class="id" title="keyword">with</span> <a id="WeakContract" class="idref" href="#WeakContract"><span class="id" title="inductive">WeakContract</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a id="build_weak_contract" class="idref" href="#build_weak_contract"><span class="id" title="constructor">build_weak_contract</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="init:42" class="idref" href="#init:42"><span class="id" title="binder">init</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#Chain"><span class="id" title="record">Chain</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#ContractCallContext"><span class="id" title="record">ContractCallContext</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Serializable.html#SerializedValue"><span class="id" title="record">SerializedValue</span></a> <span class="comment">(*&nbsp;setup&nbsp;*)</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="ConCert.Execution.Serializable.html#SerializedValue"><span class="id" title="record">SerializedValue</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="receive:43" class="idref" href="#receive:43"><span class="id" title="binder">receive</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#Chain"><span class="id" title="record">Chain</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#ContractCallContext"><span class="id" title="record">ContractCallContext</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Serializable.html#SerializedValue"><span class="id" title="record">SerializedValue</span></a> <span class="comment">(*&nbsp;state&nbsp;*)</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="ConCert.Execution.Serializable.html#SerializedValue"><span class="id" title="record">SerializedValue</span></a> <span class="comment">(*&nbsp;message&nbsp;*)</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> (<a class="idref" href="ConCert.Execution.Serializable.html#SerializedValue"><span class="id" title="record">SerializedValue</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">*</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ActionBody:30"><span class="id" title="inductive">ActionBody</span></a>)).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="act_body_amount" class="idref" href="#act_body_amount"><span class="id" title="definition">act_body_amount</span></a> (<a id="ab:44" class="idref" href="#ab:44"><span class="id" title="binder">ab</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#ActionBody"><span class="id" title="inductive">ActionBody</span></a>) : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Numbers.BinNums.html#Z"><span class="id" title="inductive">Z</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="ConCert.Execution.Blockchain.html#ab:44"><span class="id" title="variable">ab</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="ConCert.Execution.Blockchain.html#act_transfer"><span class="id" title="constructor">act_transfer</span></a> <span class="id" title="var">_</span> <span class="id" title="var">amount</span><br/>
&nbsp;&nbsp;| <a class="idref" href="ConCert.Execution.Blockchain.html#act_call"><span class="id" title="constructor">act_call</span></a> <span class="id" title="var">_</span> <span class="id" title="var">amount</span> <span class="id" title="var">_</span><br/>
&nbsp;&nbsp;| <a class="idref" href="ConCert.Execution.Blockchain.html#act_deploy"><span class="id" title="constructor">act_deploy</span></a> <span class="id" title="var">amount</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">amount</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="wc_init" class="idref" href="#wc_init"><span class="id" title="definition">wc_init</span></a> (<a id="wc:46" class="idref" href="#wc:46"><span class="id" title="binder">wc</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#WeakContract"><span class="id" title="inductive">WeakContract</span></a>) :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> (<a id="i:47" class="idref" href="#i:47"><span class="id" title="binder">i</span></a>, <span class="id" title="var">_</span>) := <a class="idref" href="ConCert.Execution.Blockchain.html#wc:46"><span class="id" title="variable">wc</span></a> <span class="id" title="tactic">in</span> <a class="idref" href="ConCert.Execution.Blockchain.html#i:47"><span class="id" title="variable">i</span></a>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="wc_receive" class="idref" href="#wc_receive"><span class="id" title="definition">wc_receive</span></a> (<a id="wc:48" class="idref" href="#wc:48"><span class="id" title="binder">wc</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#WeakContract"><span class="id" title="inductive">WeakContract</span></a>) :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> (<span class="id" title="var">_</span>, <a id="r:49" class="idref" href="#r:49"><span class="id" title="binder">r</span></a>) := <a class="idref" href="ConCert.Execution.Blockchain.html#wc:48"><span class="id" title="variable">wc</span></a> <span class="id" title="tactic">in</span> <a class="idref" href="ConCert.Execution.Blockchain.html#r:49"><span class="id" title="variable">r</span></a>.<br/>

<br/>
<span class="id" title="keyword">Record</span> <a id="Action" class="idref" href="#Action"><span class="id" title="record">Action</span></a> :=<br/>
&nbsp;&nbsp;<a id="build_act" class="idref" href="#build_act"><span class="id" title="constructor">build_act</span></a> {<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a id="act_origin" class="idref" href="#act_origin"><span class="id" title="projection">act_origin</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a id="act_from" class="idref" href="#act_from"><span class="id" title="projection">act_from</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a id="act_body" class="idref" href="#act_body"><span class="id" title="projection">act_body</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#ActionBody"><span class="id" title="inductive">ActionBody</span></a>;<br/>
&nbsp;&nbsp;}.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="act_amount" class="idref" href="#act_amount"><span class="id" title="definition">act_amount</span></a> (<a id="a:54" class="idref" href="#a:54"><span class="id" title="binder">a</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Action"><span class="id" title="record">Action</span></a>) := <a class="idref" href="ConCert.Execution.Blockchain.html#act_body_amount"><span class="id" title="definition">act_body_amount</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#act_body"><span class="id" title="projection">act_body</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#a:54"><span class="id" title="variable">a</span></a>).<br/>

<br/>
<span class="comment">(*&nbsp;Represents&nbsp;a&nbsp;strongly-typed&nbsp;contract.&nbsp;This&nbsp;is&nbsp;what&nbsp;user's&nbsp;will&nbsp;primarily<br/>
use&nbsp;and&nbsp;interact&nbsp;with&nbsp;when&nbsp;they&nbsp;want&nbsp;deployment.&nbsp;We&nbsp;keep&nbsp;the&nbsp;weak&nbsp;contract<br/>
only&nbsp;"internally"&nbsp;for&nbsp;blockchains,&nbsp;while&nbsp;any&nbsp;strongly-typed&nbsp;contract&nbsp;can<br/>
be&nbsp;converted&nbsp;to&nbsp;and&nbsp;from&nbsp;*)</span><br/>
<span class="id" title="keyword">Record</span> <a id="Contract" class="idref" href="#Contract"><span class="id" title="record">Contract</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="Setup:55" class="idref" href="#Setup:55"><span class="id" title="binder">Setup</span></a> <a id="Msg:56" class="idref" href="#Msg:56"><span class="id" title="binder">Msg</span></a> <a id="State:57" class="idref" href="#State:57"><span class="id" title="binder">State</span></a> : <span class="id" title="keyword">Type</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`{<a id="H:58" class="idref" href="#H:58"><span class="id" title="binder">Serializable</span></a> <a id="H:58" class="idref" href="#H:58"><span class="id" title="binder">Setup</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`{<a id="H0:59" class="idref" href="#H0:59"><span class="id" title="binder">Serializable</span></a> <a id="H0:59" class="idref" href="#H0:59"><span class="id" title="binder">Msg</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`{<a id="H1:60" class="idref" href="#H1:60"><span class="id" title="binder">Serializable</span></a> <a id="H1:60" class="idref" href="#H1:60"><span class="id" title="binder">State</span></a>} :=<br/>
&nbsp;&nbsp;<a id="build_contract" class="idref" href="#build_contract"><span class="id" title="constructor">build_contract</span></a> {<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a id="init" class="idref" href="#init"><span class="id" title="projection">init</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#Chain"><span class="id" title="record">Chain</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#ContractCallContext"><span class="id" title="record">ContractCallContext</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#Setup:55"><span class="id" title="variable">Setup</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#State:57"><span class="id" title="variable">State</span></a>;<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a id="receive" class="idref" href="#receive"><span class="id" title="projection">receive</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#Chain"><span class="id" title="record">Chain</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#ContractCallContext"><span class="id" title="record">ContractCallContext</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#State:57"><span class="id" title="variable">State</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Msg:56"><span class="id" title="variable">Msg</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#State:57"><span class="id" title="variable">State</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">*</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ActionBody"><span class="id" title="inductive">ActionBody</span></a>);<br/>
&nbsp;&nbsp;}.<br/>

<br/>
<span class="id" title="keyword">Global Arguments</span> <a class="idref" href="ConCert.Execution.Blockchain.html#init"><span class="id" title="projection">init</span></a> {<span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>}.<br/>
<span class="id" title="keyword">Global Arguments</span> <a class="idref" href="ConCert.Execution.Blockchain.html#receive"><span class="id" title="projection">receive</span></a> {<span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>}.<br/>
<span class="id" title="keyword">Global Arguments</span> <a class="idref" href="ConCert.Execution.Blockchain.html#build_contract"><span class="id" title="constructor">build_contract</span></a> {<span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>}.<br/>

<br/>
<span class="id" title="keyword">Program Definition</span> <a id="contract_to_weak_contract" class="idref" href="#contract_to_weak_contract"><span class="id" title="definition">contract_to_weak_contract</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<a id="Setup:64" class="idref" href="#Setup:64"><span class="id" title="binder">Setup</span></a> <a id="Msg:65" class="idref" href="#Msg:65"><span class="id" title="binder">Msg</span></a> <a id="State:66" class="idref" href="#State:66"><span class="id" title="binder">State</span></a> : <span class="id" title="keyword">Type</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`{<a id="H:67" class="idref" href="#H:67"><span class="id" title="binder">Serializable</span></a> <a id="H:67" class="idref" href="#H:67"><span class="id" title="binder">Setup</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`{<a id="H0:68" class="idref" href="#H0:68"><span class="id" title="binder">Serializable</span></a> <a id="H0:68" class="idref" href="#H0:68"><span class="id" title="binder">Msg</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`{<a id="H1:69" class="idref" href="#H1:69"><span class="id" title="binder">Serializable</span></a> <a id="H1:69" class="idref" href="#H1:69"><span class="id" title="binder">State</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="c:70" class="idref" href="#c:70"><span class="id" title="binder">c</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Contract"><span class="id" title="record">Contract</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Setup:64"><span class="id" title="variable">Setup</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Msg:65"><span class="id" title="variable">Msg</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#State:66"><span class="id" title="variable">State</span></a>) : <a class="idref" href="ConCert.Execution.Blockchain.html#WeakContract"><span class="id" title="inductive">WeakContract</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="weak_init:76" class="idref" href="#weak_init:76"><span class="id" title="binder">weak_init</span></a> <a id="chain:71" class="idref" href="#chain:71"><span class="id" title="binder">chain</span></a> <a id="ctx:72" class="idref" href="#ctx:72"><span class="id" title="binder">ctx</span></a> <a id="ser_setup:73" class="idref" href="#ser_setup:73"><span class="id" title="binder">ser_setup</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Monads.html#bbeef38f67325be53cb9324ba9182131"><span class="id" title="notation">do</span></a> <a id="setup:74" class="idref" href="#setup:74"><span class="id" title="binder">setup</span></a> <a class="idref" href="ConCert.Execution.Monads.html#bbeef38f67325be53cb9324ba9182131"><span class="id" title="notation">&lt;-</span></a> <a class="idref" href="ConCert.Execution.Serializable.html#deserialize"><span class="id" title="method">deserialize</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ser_setup:73"><span class="id" title="variable">ser_setup</span></a><a class="idref" href="ConCert.Execution.Monads.html#bbeef38f67325be53cb9324ba9182131"><span class="id" title="notation">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Monads.html#bbeef38f67325be53cb9324ba9182131"><span class="id" title="notation">do</span></a> <a id="state:75" class="idref" href="#state:75"><span class="id" title="binder">state</span></a> <a class="idref" href="ConCert.Execution.Monads.html#bbeef38f67325be53cb9324ba9182131"><span class="id" title="notation">&lt;-</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#c:70"><span class="id" title="variable">c</span></a>.(<a class="idref" href="ConCert.Execution.Blockchain.html#init"><span class="id" title="projection">init</span></a>) <a class="idref" href="ConCert.Execution.Blockchain.html#chain:71"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ctx:72"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#setup:74"><span class="id" title="variable">setup</span></a><a class="idref" href="ConCert.Execution.Monads.html#bbeef38f67325be53cb9324ba9182131"><span class="id" title="notation">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Execution.Serializable.html#serialize"><span class="id" title="method">serialize</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#state:75"><span class="id" title="variable">state</span></a>) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="weak_recv:90" class="idref" href="#weak_recv:90"><span class="id" title="binder">weak_recv</span></a> <a id="chain:77" class="idref" href="#chain:77"><span class="id" title="binder">chain</span></a> <a id="ctx:78" class="idref" href="#ctx:78"><span class="id" title="binder">ctx</span></a> <a id="ser_state:79" class="idref" href="#ser_state:79"><span class="id" title="binder">ser_state</span></a> <a id="ser_msg_opt:80" class="idref" href="#ser_msg_opt:80"><span class="id" title="binder">ser_msg_opt</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Monads.html#bbeef38f67325be53cb9324ba9182131"><span class="id" title="notation">do</span></a> <a id="state:81" class="idref" href="#state:81"><span class="id" title="binder">state</span></a> <a class="idref" href="ConCert.Execution.Monads.html#bbeef38f67325be53cb9324ba9182131"><span class="id" title="notation">&lt;-</span></a> <a class="idref" href="ConCert.Execution.Serializable.html#deserialize"><span class="id" title="method">deserialize</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ser_state:79"><span class="id" title="variable">ser_state</span></a><a class="idref" href="ConCert.Execution.Monads.html#bbeef38f67325be53cb9324ba9182131"><span class="id" title="notation">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="ConCert.Execution.Blockchain.html#ser_msg_opt:80"><span class="id" title="variable">ser_msg_opt</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">ser_msg</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Monads.html#bbeef38f67325be53cb9324ba9182131"><span class="id" title="notation">do</span></a> <a id="msg:83" class="idref" href="#msg:83"><span class="id" title="binder">msg</span></a> <a class="idref" href="ConCert.Execution.Monads.html#bbeef38f67325be53cb9324ba9182131"><span class="id" title="notation">&lt;-</span></a> <a class="idref" href="ConCert.Execution.Serializable.html#deserialize"><span class="id" title="method">deserialize</span></a> <span class="id" title="var">ser_msg</span><a class="idref" href="ConCert.Execution.Monads.html#bbeef38f67325be53cb9324ba9182131"><span class="id" title="notation">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Monads.html#4842b7321410137459b4dcd7c5f317e4"><span class="id" title="notation">do</span></a> <a class="idref" href="ConCert.Execution.Monads.html#4842b7321410137459b4dcd7c5f317e4"><span class="id" title="notation">'</span></a><a id="pat:86" class="idref" href="#pat:86"><span class="id" title="binder">(</span></a><a id="pat:86" class="idref" href="#pat:86"><span class="id" title="binder">new_state</span></a><a id="pat:86" class="idref" href="#pat:86"><span class="id" title="binder">,</span></a> <a id="pat:86" class="idref" href="#pat:86"><span class="id" title="binder">acts</span></a><a id="pat:86" class="idref" href="#pat:86"><span class="id" title="binder">)</span></a> <a class="idref" href="ConCert.Execution.Monads.html#4842b7321410137459b4dcd7c5f317e4"><span class="id" title="notation">&lt;-</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#c:70"><span class="id" title="variable">c</span></a>.(<a class="idref" href="ConCert.Execution.Blockchain.html#receive"><span class="id" title="projection">receive</span></a>) <a class="idref" href="ConCert.Execution.Blockchain.html#chain:77"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ctx:78"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#state:81"><span class="id" title="variable">state</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#msg:83"><span class="id" title="variable">msg</span></a>)<a class="idref" href="ConCert.Execution.Monads.html#4842b7321410137459b4dcd7c5f317e4"><span class="id" title="notation">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Execution.Serializable.html#serialize"><span class="id" title="method">serialize</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#new_state:85"><span class="id" title="variable">new_state</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#acts:84"><span class="id" title="variable">acts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Monads.html#4842b7321410137459b4dcd7c5f317e4"><span class="id" title="notation">do</span></a> <a class="idref" href="ConCert.Execution.Monads.html#4842b7321410137459b4dcd7c5f317e4"><span class="id" title="notation">'</span></a><a id="pat:89" class="idref" href="#pat:89"><span class="id" title="binder">(</span></a><a id="pat:89" class="idref" href="#pat:89"><span class="id" title="binder">new_state</span></a><a id="pat:89" class="idref" href="#pat:89"><span class="id" title="binder">,</span></a> <a id="pat:89" class="idref" href="#pat:89"><span class="id" title="binder">acts</span></a><a id="pat:89" class="idref" href="#pat:89"><span class="id" title="binder">)</span></a> <a class="idref" href="ConCert.Execution.Monads.html#4842b7321410137459b4dcd7c5f317e4"><span class="id" title="notation">&lt;-</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#c:70"><span class="id" title="variable">c</span></a>.(<a class="idref" href="ConCert.Execution.Blockchain.html#receive"><span class="id" title="projection">receive</span></a>) <a class="idref" href="ConCert.Execution.Blockchain.html#chain:77"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ctx:78"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#state:81"><span class="id" title="variable">state</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a><a class="idref" href="ConCert.Execution.Monads.html#4842b7321410137459b4dcd7c5f317e4"><span class="id" title="notation">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Execution.Serializable.html#serialize"><span class="id" title="method">serialize</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#new_state:88"><span class="id" title="variable">new_state</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#acts:87"><span class="id" title="variable">acts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#build_weak_contract"><span class="id" title="constructor">build_weak_contract</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#weak_init:76"><span class="id" title="variable">weak_init</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#weak_recv:90"><span class="id" title="variable">weak_recv</span></a>.<br/>

<br/>
<span class="id" title="keyword">Coercion</span> <a class="idref" href="ConCert.Execution.Blockchain.html#contract_to_weak_contract"><span class="id" title="definition">contract_to_weak_contract</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#contract_to_weak_contract"><span class="id" title="definition">:</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#contract_to_weak_contract"><span class="id" title="definition">Contract</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#contract_to_weak_contract"><span class="id" title="definition">&gt;-&gt;</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#contract_to_weak_contract"><span class="id" title="definition">WeakContract</span></a>.<br/>

<br/>
<span class="comment">(*&nbsp;Deploy&nbsp;a&nbsp;strongly&nbsp;typed&nbsp;contract&nbsp;with&nbsp;some&nbsp;amount&nbsp;and&nbsp;setup&nbsp;*)</span><br/>
<span class="id" title="keyword">Definition</span> <a id="create_deployment" class="idref" href="#create_deployment"><span class="id" title="definition">create_deployment</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<a id="Setup:91" class="idref" href="#Setup:91"><span class="id" title="binder">Setup</span></a> <a id="Msg:92" class="idref" href="#Msg:92"><span class="id" title="binder">Msg</span></a> <a id="State:93" class="idref" href="#State:93"><span class="id" title="binder">State</span></a> : <span class="id" title="keyword">Type</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`{<a id="H:94" class="idref" href="#H:94"><span class="id" title="binder">Serializable</span></a> <a id="H:94" class="idref" href="#H:94"><span class="id" title="binder">Setup</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`{<a id="H0:95" class="idref" href="#H0:95"><span class="id" title="binder">Serializable</span></a> <a id="H0:95" class="idref" href="#H0:95"><span class="id" title="binder">Msg</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`{<a id="H1:96" class="idref" href="#H1:96"><span class="id" title="binder">Serializable</span></a> <a id="H1:96" class="idref" href="#H1:96"><span class="id" title="binder">State</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="amount:97" class="idref" href="#amount:97"><span class="id" title="binder">amount</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Amount"><span class="id" title="definition">Amount</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="contract:98" class="idref" href="#contract:98"><span class="id" title="binder">contract</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Contract"><span class="id" title="record">Contract</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Setup:91"><span class="id" title="variable">Setup</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Msg:92"><span class="id" title="variable">Msg</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#State:93"><span class="id" title="variable">State</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="setup:99" class="idref" href="#setup:99"><span class="id" title="binder">setup</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Setup:91"><span class="id" title="variable">Setup</span></a>) : <a class="idref" href="ConCert.Execution.Blockchain.html#ActionBody"><span class="id" title="inductive">ActionBody</span></a> :=<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#act_deploy"><span class="id" title="constructor">act_deploy</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#amount:97"><span class="id" title="variable">amount</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#contract:98"><span class="id" title="variable">contract</span></a> (<a class="idref" href="ConCert.Execution.Serializable.html#serialize"><span class="id" title="method">serialize</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#setup:99"><span class="id" title="variable">setup</span></a>).<br/>

<br/>
<span class="comment">(*&nbsp;The&nbsp;contract&nbsp;interface&nbsp;is&nbsp;the&nbsp;main&nbsp;mechanism&nbsp;allowing&nbsp;a&nbsp;deployed<br/>
contract&nbsp;to&nbsp;interact&nbsp;with&nbsp;another&nbsp;deployed&nbsp;contract.&nbsp;This&nbsp;hides<br/>
the&nbsp;ugly&nbsp;details&nbsp;of&nbsp;everything&nbsp;being&nbsp;SerializedValue&nbsp;away&nbsp;from&nbsp;contracts.&nbsp;*)</span><br/>
<span class="id" title="keyword">Record</span> <a id="ContractInterface" class="idref" href="#ContractInterface"><span class="id" title="record">ContractInterface</span></a> {<a id="Msg:100" class="idref" href="#Msg:100"><span class="id" title="binder">Msg</span></a> : <span class="id" title="keyword">Type</span>} :=<br/>
&nbsp;&nbsp;<a id="build_contract_interface" class="idref" href="#build_contract_interface"><span class="id" title="constructor">build_contract_interface</span></a> {<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;The&nbsp;address&nbsp;of&nbsp;the&nbsp;contract&nbsp;being&nbsp;interfaced&nbsp;with&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a id="contract_address" class="idref" href="#contract_address"><span class="id" title="projection">contract_address</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;Make&nbsp;an&nbsp;action&nbsp;sending&nbsp;money&nbsp;and&nbsp;optionally&nbsp;a&nbsp;message&nbsp;to&nbsp;the&nbsp;contract&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a id="send" class="idref" href="#send"><span class="id" title="projection">send</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Amount"><span class="id" title="definition">Amount</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Msg:100"><span class="id" title="variable">Msg</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ActionBody"><span class="id" title="inductive">ActionBody</span></a>;<br/>
&nbsp;&nbsp;}.<br/>

<br/>
<span class="id" title="keyword">Global Arguments</span> <a class="idref" href="ConCert.Execution.Blockchain.html#ContractInterface"><span class="id" title="record">ContractInterface</span></a> <span class="id" title="var">_</span> : <span class="id" title="tactic">clear</span> <span class="id" title="var">implicits</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="get_contract_interface" class="idref" href="#get_contract_interface"><span class="id" title="definition">get_contract_interface</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="chain:104" class="idref" href="#chain:104"><span class="id" title="binder">chain</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Chain"><span class="id" title="record">Chain</span></a>) (<a id="addr:105" class="idref" href="#addr:105"><span class="id" title="binder">addr</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="Msg:106" class="idref" href="#Msg:106"><span class="id" title="binder">Msg</span></a> : <span class="id" title="keyword">Type</span>) `{<a id="H:107" class="idref" href="#H:107"><span class="id" title="binder">Serializable</span></a> <a id="H:107" class="idref" href="#H:107"><span class="id" title="binder">Msg</span></a>}<br/>
&nbsp;&nbsp;: <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#ContractInterface"><span class="id" title="record">ContractInterface</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Msg:106"><span class="id" title="variable">Msg</span></a>) :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="ifc_send:111" class="idref" href="#ifc_send:111"><span class="id" title="binder">ifc_send</span></a> <a id="amount:108" class="idref" href="#amount:108"><span class="id" title="binder">amount</span></a> <a id="msg:109" class="idref" href="#msg:109"><span class="id" title="binder">msg</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="ConCert.Execution.Blockchain.html#msg:109"><span class="id" title="variable">msg</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> =&gt; <a class="idref" href="ConCert.Execution.Blockchain.html#act_transfer"><span class="id" title="constructor">act_transfer</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#addr:105"><span class="id" title="variable">addr</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#amount:108"><span class="id" title="variable">amount</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">msg</span> =&gt; <a class="idref" href="ConCert.Execution.Blockchain.html#act_call"><span class="id" title="constructor">act_call</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#addr:105"><span class="id" title="variable">addr</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#amount:108"><span class="id" title="variable">amount</span></a> (<a class="idref" href="ConCert.Execution.Serializable.html#serialize"><span class="id" title="method">serialize</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#msg:109"><span class="id" title="variable">msg</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> {| <a class="idref" href="ConCert.Execution.Blockchain.html#contract_address"><span class="id" title="projection">contract_address</span></a> := <a class="idref" href="ConCert.Execution.Blockchain.html#addr:105"><span class="id" title="variable">addr</span></a>; <a class="idref" href="ConCert.Execution.Blockchain.html#send"><span class="id" title="projection">send</span></a> := <a class="idref" href="ConCert.Execution.Blockchain.html#ifc_send:111"><span class="id" title="variable">ifc_send</span></a>; |}.<br/>

<br/>
<span class="id" title="keyword">Section</span> <a id="Blockchain.Semantics" class="idref" href="#Blockchain.Semantics"><span class="id" title="section">Semantics</span></a>.<br/>
<span class="id" title="var">MetaCoq</span> <span class="id" title="var">Run</span> (<a class="idref" href="ConCert.Utils.RecordSet.html#make_setters"><span class="id" title="definition">make_setters</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Chain"><span class="id" title="record">Chain</span></a>).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="add_balance" class="idref" href="#add_balance"><span class="id" title="definition">add_balance</span></a> (<a id="addr:112" class="idref" href="#addr:112"><span class="id" title="binder">addr</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a>) (<a id="amount:113" class="idref" href="#amount:113"><span class="id" title="binder">amount</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Amount"><span class="id" title="definition">Amount</span></a>) (<a id="map:114" class="idref" href="#map:114"><span class="id" title="binder">map</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Amount"><span class="id" title="definition">Amount</span></a>) :<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Amount"><span class="id" title="definition">Amount</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">fun</span> <a id="a:115" class="idref" href="#a:115"><span class="id" title="binder">a</span></a> =&gt; <span class="id" title="keyword">if</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#a:115"><span class="id" title="variable">a</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#6f617e0e5500b437e5aeb1eaa876d41f"><span class="id" title="notation">=?</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#addr:112"><span class="id" title="variable">addr</span></a>)%<span class="id" title="var">address</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">then</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#amount:113"><span class="id" title="variable">amount</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a"><span class="id" title="notation">+</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#map:114"><span class="id" title="variable">map</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#a:115"><span class="id" title="variable">a</span></a>)%<span class="id" title="var">Z</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">else</span> <a class="idref" href="ConCert.Execution.Blockchain.html#map:114"><span class="id" title="variable">map</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#a:115"><span class="id" title="variable">a</span></a>.<br/>

<br/>
<span class="id" title="keyword">Global Arguments</span> <a class="idref" href="ConCert.Execution.Blockchain.html#add_balance"><span class="id" title="definition">add_balance</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> /.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="set_chain_contract_state" class="idref" href="#set_chain_contract_state"><span class="id" title="definition">set_chain_contract_state</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="addr:116" class="idref" href="#addr:116"><span class="id" title="binder">addr</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a>) (<a id="state:117" class="idref" href="#state:117"><span class="id" title="binder">state</span></a> : <a class="idref" href="ConCert.Execution.Serializable.html#SerializedValue"><span class="id" title="record">SerializedValue</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="map:118" class="idref" href="#map:118"><span class="id" title="binder">map</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="ConCert.Execution.Serializable.html#SerializedValue"><span class="id" title="record">SerializedValue</span></a>)<br/>
&nbsp;&nbsp;: <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="ConCert.Execution.Serializable.html#SerializedValue"><span class="id" title="record">SerializedValue</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">fun</span> <a id="a:119" class="idref" href="#a:119"><span class="id" title="binder">a</span></a> =&gt; <span class="id" title="keyword">if</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#a:119"><span class="id" title="variable">a</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#6f617e0e5500b437e5aeb1eaa876d41f"><span class="id" title="notation">=?</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#addr:116"><span class="id" title="variable">addr</span></a>)%<span class="id" title="var">address</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">then</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#state:117"><span class="id" title="variable">state</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">else</span> <a class="idref" href="ConCert.Execution.Blockchain.html#map:118"><span class="id" title="variable">map</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#a:119"><span class="id" title="variable">a</span></a>.<br/>

<br/>
<span class="id" title="keyword">Record</span> <a id="Environment" class="idref" href="#Environment"><span class="id" title="record">Environment</span></a> :=<br/>
&nbsp;&nbsp;<a id="build_env" class="idref" href="#build_env"><span class="id" title="constructor">build_env</span></a> {<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a id="env_chain" class="idref" href="#env_chain"><span class="id" title="projection">env_chain</span></a> :&gt; <a class="idref" href="ConCert.Execution.Blockchain.html#Chain"><span class="id" title="record">Chain</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a id="env_account_balances" class="idref" href="#env_account_balances"><span class="id" title="projection">env_account_balances</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Amount"><span class="id" title="definition">Amount</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a id="env_contracts" class="idref" href="#env_contracts"><span class="id" title="projection">env_contracts</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#WeakContract"><span class="id" title="inductive">WeakContract</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a id="env_contract_states" class="idref" href="#env_contract_states"><span class="id" title="projection">env_contract_states</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="ConCert.Execution.Serializable.html#SerializedValue"><span class="id" title="record">SerializedValue</span></a>;<br/>
&nbsp;&nbsp;}.<br/>

<br/>
<span class="comment">(*&nbsp;Two&nbsp;environments&nbsp;are&nbsp;equivalent&nbsp;if&nbsp;they&nbsp;are&nbsp;extensionally&nbsp;equal&nbsp;*)</span><br/>
<span class="id" title="keyword">Record</span> <a id="EnvironmentEquiv" class="idref" href="#EnvironmentEquiv"><span class="id" title="record">EnvironmentEquiv</span></a> (<a id="e1:125" class="idref" href="#e1:125"><span class="id" title="binder">e1</span></a> <a id="e2:126" class="idref" href="#e2:126"><span class="id" title="binder">e2</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Environment"><span class="id" title="record">Environment</span></a>) : <span class="id" title="keyword">Prop</span> :=<br/>
&nbsp;&nbsp;<a id="build_env_equiv" class="idref" href="#build_env_equiv"><span class="id" title="constructor">build_env_equiv</span></a> {<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a id="chain_eq" class="idref" href="#chain_eq"><span class="id" title="projection">chain_eq</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#env_chain"><span class="id" title="projection">env_chain</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#e1:125"><span class="id" title="variable">e1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#env_chain"><span class="id" title="projection">env_chain</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#e2:126"><span class="id" title="variable">e2</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a id="account_balances_eq" class="idref" href="#account_balances_eq"><span class="id" title="projection">account_balances_eq</span></a> : <span class="id" title="keyword">forall</span> <a id="a:129" class="idref" href="#a:129"><span class="id" title="binder">a</span></a>, <a class="idref" href="ConCert.Execution.Blockchain.html#env_account_balances"><span class="id" title="projection">env_account_balances</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#e1:125"><span class="id" title="variable">e1</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#a:129"><span class="id" title="variable">a</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#env_account_balances"><span class="id" title="projection">env_account_balances</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#e2:126"><span class="id" title="variable">e2</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#a:129"><span class="id" title="variable">a</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a id="contracts_eq" class="idref" href="#contracts_eq"><span class="id" title="projection">contracts_eq</span></a> : <span class="id" title="keyword">forall</span> <a id="a:131" class="idref" href="#a:131"><span class="id" title="binder">a</span></a>, <a class="idref" href="ConCert.Execution.Blockchain.html#env_contracts"><span class="id" title="projection">env_contracts</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#e1:125"><span class="id" title="variable">e1</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#a:131"><span class="id" title="variable">a</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#env_contracts"><span class="id" title="projection">env_contracts</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#e2:126"><span class="id" title="variable">e2</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#a:131"><span class="id" title="variable">a</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a id="contract_states_eq" class="idref" href="#contract_states_eq"><span class="id" title="projection">contract_states_eq</span></a> : <span class="id" title="keyword">forall</span> <a id="addr:133" class="idref" href="#addr:133"><span class="id" title="binder">addr</span></a>, <a class="idref" href="ConCert.Execution.Blockchain.html#env_contract_states"><span class="id" title="projection">env_contract_states</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#e1:125"><span class="id" title="variable">e1</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#addr:133"><span class="id" title="variable">addr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#env_contract_states"><span class="id" title="projection">env_contract_states</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#e2:126"><span class="id" title="variable">e2</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#addr:133"><span class="id" title="variable">addr</span></a>;<br/>
&nbsp;&nbsp;}.<br/>

<br/>
<span class="comment">(*&nbsp;Strongly&nbsp;typed&nbsp;version&nbsp;of&nbsp;contract&nbsp;state&nbsp;*)</span><br/>
<span class="id" title="keyword">Definition</span> <a id="contract_state" class="idref" href="#contract_state"><span class="id" title="definition">contract_state</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<a id="A:135" class="idref" href="#A:135"><span class="id" title="binder">A</span></a> : <span class="id" title="keyword">Type</span>} `{<a id="H:136" class="idref" href="#H:136"><span class="id" title="binder">Serializable</span></a> <a id="H:136" class="idref" href="#H:136"><span class="id" title="binder">A</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="env:137" class="idref" href="#env:137"><span class="id" title="binder">env</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Environment"><span class="id" title="record">Environment</span></a>) (<a id="addr:138" class="idref" href="#addr:138"><span class="id" title="binder">addr</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a>) : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#A:135"><span class="id" title="variable">A</span></a> :=<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#env_contract_states"><span class="id" title="projection">env_contract_states</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#env:137"><span class="id" title="variable">env</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#addr:138"><span class="id" title="variable">addr</span></a> <a class="idref" href="ConCert.Execution.Monads.html#f1146025ce6377896c1a30f88a02c8cb"><span class="id" title="notation">&gt;&gt;=</span></a> <a class="idref" href="ConCert.Execution.Serializable.html#deserialize"><span class="id" title="method">deserialize</span></a>.<br/>

<br/>
<span class="id" title="keyword">Global</span> <span class="id" title="var">Program</span> <span class="id" title="keyword">Instance</span> <a id="environment_equiv_equivalence" class="idref" href="#environment_equiv_equivalence"><span class="id" title="instance">environment_equiv_equivalence</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Classes.RelationClasses.html#Equivalence"><span class="id" title="class">Equivalence</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#EnvironmentEquiv"><span class="id" title="record">EnvironmentEquiv</span></a>.<br/>
<span class="id" title="keyword">Next</span> <span class="id" title="keyword">Obligation</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Execution.Blockchain.html#build_env_equiv"><span class="id" title="constructor">build_env_equiv</span></a>; <span class="id" title="tactic">reflexivity</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
<span class="id" title="keyword">Next</span> <span class="id" title="keyword">Obligation</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">H</span>; <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Execution.Blockchain.html#build_env_equiv"><span class="id" title="constructor">build_env_equiv</span></a>; <span class="id" title="var">now</span> <span class="id" title="tactic">symmetry</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
<span class="id" title="keyword">Next</span> <span class="id" title="keyword">Obligation</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">H</span>, <span class="id" title="var">H0</span>; <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Execution.Blockchain.html#build_env_equiv"><span class="id" title="constructor">build_env_equiv</span></a>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Global Instance</span> <a id="environment_equiv_env_account_balances_proper" class="idref" href="#environment_equiv_env_account_balances_proper"><span class="id" title="instance">environment_equiv_env_account_balances_proper</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Classes.Morphisms.html#Proper"><span class="id" title="class">Proper</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#EnvironmentEquiv"><span class="id" title="record">EnvironmentEquiv</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Classes.Morphisms.html#8dc5652698a6e16f72dd37bd17d3b973"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#eq"><span class="id" title="inductive">eq</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Classes.Morphisms.html#8dc5652698a6e16f72dd37bd17d3b973"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#eq"><span class="id" title="inductive">eq</span></a>) <a class="idref" href="ConCert.Execution.Blockchain.html#env_account_balances"><span class="id" title="projection">env_account_balances</span></a>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">repeat</span> <span class="id" title="tactic">intro</span>; <span class="id" title="tactic">subst</span>; <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Execution.Blockchain.html#account_balances_eq"><span class="id" title="projection">account_balances_eq</span></a>; <span class="id" title="tactic">assumption</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Global Instance</span> <a id="environment_equiv_env_contracts_proper" class="idref" href="#environment_equiv_env_contracts_proper"><span class="id" title="instance">environment_equiv_env_contracts_proper</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Classes.Morphisms.html#Proper"><span class="id" title="class">Proper</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#EnvironmentEquiv"><span class="id" title="record">EnvironmentEquiv</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Classes.Morphisms.html#8dc5652698a6e16f72dd37bd17d3b973"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#eq"><span class="id" title="inductive">eq</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Classes.Morphisms.html#8dc5652698a6e16f72dd37bd17d3b973"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#eq"><span class="id" title="inductive">eq</span></a>) <a class="idref" href="ConCert.Execution.Blockchain.html#env_contracts"><span class="id" title="projection">env_contracts</span></a>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">repeat</span> <span class="id" title="tactic">intro</span>; <span class="id" title="tactic">subst</span>; <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Execution.Blockchain.html#contracts_eq"><span class="id" title="projection">contracts_eq</span></a>; <span class="id" title="tactic">assumption</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Global Instance</span> <a id="environment_equiv_env_contract_states_proper" class="idref" href="#environment_equiv_env_contract_states_proper"><span class="id" title="instance">environment_equiv_env_contract_states_proper</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Classes.Morphisms.html#Proper"><span class="id" title="class">Proper</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#EnvironmentEquiv"><span class="id" title="record">EnvironmentEquiv</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Classes.Morphisms.html#8dc5652698a6e16f72dd37bd17d3b973"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#eq"><span class="id" title="inductive">eq</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Classes.Morphisms.html#8dc5652698a6e16f72dd37bd17d3b973"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#eq"><span class="id" title="inductive">eq</span></a>) <a class="idref" href="ConCert.Execution.Blockchain.html#env_contract_states"><span class="id" title="projection">env_contract_states</span></a>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">repeat</span> <span class="id" title="tactic">intro</span>; <span class="id" title="tactic">subst</span>; <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Execution.Blockchain.html#contract_states_eq"><span class="id" title="projection">contract_states_eq</span></a>; <span class="id" title="tactic">assumption</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Global Instance</span> <a id="environment_equiv_env_chain_equiv_proper" class="idref" href="#environment_equiv_env_chain_equiv_proper"><span class="id" title="instance">environment_equiv_env_chain_equiv_proper</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Classes.Morphisms.html#Proper"><span class="id" title="class">Proper</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#EnvironmentEquiv"><span class="id" title="record">EnvironmentEquiv</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Classes.Morphisms.html#8dc5652698a6e16f72dd37bd17d3b973"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#eq"><span class="id" title="inductive">eq</span></a>) <a class="idref" href="ConCert.Execution.Blockchain.html#env_chain"><span class="id" title="projection">env_chain</span></a>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">repeat</span> <span class="id" title="tactic">intro</span>; <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Execution.Blockchain.html#chain_eq"><span class="id" title="projection">chain_eq</span></a>; <span class="id" title="tactic">assumption</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Global Instance</span> <a id="environment_equiv_contract_state_proper" class="idref" href="#environment_equiv_contract_state_proper"><span class="id" title="instance">environment_equiv_contract_state_proper</span></a><br/>
&nbsp;&nbsp;{<a id="A:139" class="idref" href="#A:139"><span class="id" title="binder">A</span></a> : <span class="id" title="keyword">Type</span>} `{<a id="H:140" class="idref" href="#H:140"><span class="id" title="binder">Serializable</span></a> <a id="H:140" class="idref" href="#H:140"><span class="id" title="binder">A</span></a>} :<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Classes.Morphisms.html#Proper"><span class="id" title="class">Proper</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#EnvironmentEquiv"><span class="id" title="record">EnvironmentEquiv</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Classes.Morphisms.html#8dc5652698a6e16f72dd37bd17d3b973"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#eq"><span class="id" title="inductive">eq</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Classes.Morphisms.html#8dc5652698a6e16f72dd37bd17d3b973"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Classes.Morphisms.html#8dc5652698a6e16f72dd37bd17d3b973"><span class="id" title="notation">(</span></a>@<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#eq"><span class="id" title="inductive">eq</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#A:139"><span class="id" title="variable">A</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Classes.Morphisms.html#8dc5652698a6e16f72dd37bd17d3b973"><span class="id" title="notation">)</span></a>) <a class="idref" href="ConCert.Execution.Blockchain.html#contract_state"><span class="id" title="definition">contract_state</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> ? ? <span class="id" title="var">env_eq</span> ? ? ?.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="ConCert.Execution.Blockchain.html#contract_state"><span class="id" title="definition">contract_state</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">env_eq</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="var">MetaCoq</span> <span class="id" title="var">Run</span> (<a class="idref" href="ConCert.Utils.RecordSet.html#make_setters"><span class="id" title="definition">make_setters</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Environment"><span class="id" title="record">Environment</span></a>).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="transfer_balance" class="idref" href="#transfer_balance"><span class="id" title="definition">transfer_balance</span></a> (<a id="from:141" class="idref" href="#from:141"><span class="id" title="binder">from</span></a> <a id="to:142" class="idref" href="#to:142"><span class="id" title="binder">to</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a>) (<a id="amount:143" class="idref" href="#amount:143"><span class="id" title="binder">amount</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Amount"><span class="id" title="definition">Amount</span></a>) (<a id="env:144" class="idref" href="#env:144"><span class="id" title="binder">env</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Environment"><span class="id" title="record">Environment</span></a>) :=<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#env:144"><span class="id" title="variable">env</span></a><a class="idref" href="ConCert.Utils.RecordSet.html#394068d0cf93ac4dd96dfc7ba41b06b2"><span class="id" title="notation">&lt;|</span></a><a class="idref" href="ConCert.Execution.Blockchain.html#env_account_balances"><span class="id" title="projection">env_account_balances</span></a> <a class="idref" href="ConCert.Utils.RecordSet.html#394068d0cf93ac4dd96dfc7ba41b06b2"><span class="id" title="notation">::=</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#add_balance"><span class="id" title="definition">add_balance</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#to:142"><span class="id" title="variable">to</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#amount:143"><span class="id" title="variable">amount</span></a><a class="idref" href="ConCert.Utils.RecordSet.html#394068d0cf93ac4dd96dfc7ba41b06b2"><span class="id" title="notation">|&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Utils.RecordSet.html#394068d0cf93ac4dd96dfc7ba41b06b2"><span class="id" title="notation">&lt;|</span></a><a class="idref" href="ConCert.Execution.Blockchain.html#env_account_balances"><span class="id" title="projection">env_account_balances</span></a> <a class="idref" href="ConCert.Utils.RecordSet.html#394068d0cf93ac4dd96dfc7ba41b06b2"><span class="id" title="notation">::=</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#add_balance"><span class="id" title="definition">add_balance</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#from:141"><span class="id" title="variable">from</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.ZArith.BinInt.html#::Z_scope:'-'_x"><span class="id" title="notation">-</span></a><a class="idref" href="ConCert.Execution.Blockchain.html#amount:143"><span class="id" title="variable">amount</span></a>)<a class="idref" href="ConCert.Utils.RecordSet.html#394068d0cf93ac4dd96dfc7ba41b06b2"><span class="id" title="notation">|&gt;</span></a>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="add_contract" class="idref" href="#add_contract"><span class="id" title="definition">add_contract</span></a> (<a id="addr:145" class="idref" href="#addr:145"><span class="id" title="binder">addr</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a>) (<a id="contract:146" class="idref" href="#contract:146"><span class="id" title="binder">contract</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#WeakContract"><span class="id" title="inductive">WeakContract</span></a>) (<a id="env:147" class="idref" href="#env:147"><span class="id" title="binder">env</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Environment"><span class="id" title="record">Environment</span></a>)<br/>
&nbsp;&nbsp;: <a class="idref" href="ConCert.Execution.Blockchain.html#Environment"><span class="id" title="record">Environment</span></a> :=<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#env:147"><span class="id" title="variable">env</span></a><a class="idref" href="ConCert.Utils.RecordSet.html#394068d0cf93ac4dd96dfc7ba41b06b2"><span class="id" title="notation">&lt;|</span></a><a class="idref" href="ConCert.Execution.Blockchain.html#env_contracts"><span class="id" title="projection">env_contracts</span></a> <a class="idref" href="ConCert.Utils.RecordSet.html#394068d0cf93ac4dd96dfc7ba41b06b2"><span class="id" title="notation">::=</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">fun</span> <a id="f:148" class="idref" href="#f:148"><span class="id" title="binder">f</span></a> <a id="a:149" class="idref" href="#a:149"><span class="id" title="binder">a</span></a> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">if</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#a:149"><span class="id" title="variable">a</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#6f617e0e5500b437e5aeb1eaa876d41f"><span class="id" title="notation">=?</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#addr:145"><span class="id" title="variable">addr</span></a>)%<span class="id" title="var">address</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">then</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#contract:146"><span class="id" title="variable">contract</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">else</span> <a class="idref" href="ConCert.Execution.Blockchain.html#f:148"><span class="id" title="variable">f</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#a:149"><span class="id" title="variable">a</span></a><a class="idref" href="ConCert.Utils.RecordSet.html#394068d0cf93ac4dd96dfc7ba41b06b2"><span class="id" title="notation">|&gt;</span></a>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="set_contract_state" class="idref" href="#set_contract_state"><span class="id" title="definition">set_contract_state</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="addr:150" class="idref" href="#addr:150"><span class="id" title="binder">addr</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a>) (<a id="state:151" class="idref" href="#state:151"><span class="id" title="binder">state</span></a> : <a class="idref" href="ConCert.Execution.Serializable.html#SerializedValue"><span class="id" title="record">SerializedValue</span></a>) (<a id="env:152" class="idref" href="#env:152"><span class="id" title="binder">env</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Environment"><span class="id" title="record">Environment</span></a>) :=<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#env:152"><span class="id" title="variable">env</span></a><a class="idref" href="ConCert.Utils.RecordSet.html#394068d0cf93ac4dd96dfc7ba41b06b2"><span class="id" title="notation">&lt;|</span></a><a class="idref" href="ConCert.Execution.Blockchain.html#env_contract_states"><span class="id" title="projection">env_contract_states</span></a> <a class="idref" href="ConCert.Utils.RecordSet.html#394068d0cf93ac4dd96dfc7ba41b06b2"><span class="id" title="notation">::=</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#set_chain_contract_state"><span class="id" title="definition">set_chain_contract_state</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#addr:150"><span class="id" title="variable">addr</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#state:151"><span class="id" title="variable">state</span></a><a class="idref" href="ConCert.Utils.RecordSet.html#394068d0cf93ac4dd96dfc7ba41b06b2"><span class="id" title="notation">|&gt;</span></a>.<br/>

<br/>
<span class="comment">(*&nbsp;set_chain_contract_state&nbsp;updates&nbsp;a&nbsp;map&nbsp;(function)&nbsp;by&nbsp;returning&nbsp;a<br/>
&nbsp;&nbsp;&nbsp;new&nbsp;map&nbsp;(function).&nbsp;&nbsp;If&nbsp;this&nbsp;function&nbsp;is&nbsp;immediately&nbsp;applied&nbsp;to&nbsp;a<br/>
&nbsp;&nbsp;&nbsp;key,&nbsp;then&nbsp;unfold&nbsp;it.&nbsp;*)</span><br/>
<span class="id" title="keyword">Global Arguments</span> <a class="idref" href="ConCert.Execution.Blockchain.html#set_chain_contract_state"><span class="id" title="definition">set_chain_contract_state</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> /.<br/>

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">rewrite_environment_equiv</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| [<span class="id" title="var">H</span>: <a class="idref" href="ConCert.Execution.Blockchain.html#EnvironmentEquiv"><span class="id" title="record">EnvironmentEquiv</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> |- <span class="id" title="var">_</span>] =&gt; <span class="id" title="tactic">try</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H</span> <span class="id" title="tactic">in</span> *<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">solve_proper</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Execution.Blockchain.html#build_env_equiv"><span class="id" title="constructor">build_env_equiv</span></a>;<br/>
&nbsp;&nbsp;<span class="id" title="var">cbn</span>;<br/>
&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> <span class="id" title="tactic">intro</span>;<br/>
&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> <span class="id" title="var">rewrite_environment_equiv</span>;<br/>
&nbsp;&nbsp;<span class="id" title="tactic">auto</span>.<br/>

<br/>
<span class="id" title="keyword">Global Instance</span> <a id="transfer_balance_proper" class="idref" href="#transfer_balance_proper"><span class="id" title="instance">transfer_balance_proper</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Classes.Morphisms.html#Proper"><span class="id" title="class">Proper</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#eq"><span class="id" title="inductive">eq</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Classes.Morphisms.html#8dc5652698a6e16f72dd37bd17d3b973"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#eq"><span class="id" title="inductive">eq</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Classes.Morphisms.html#8dc5652698a6e16f72dd37bd17d3b973"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#eq"><span class="id" title="inductive">eq</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Classes.Morphisms.html#8dc5652698a6e16f72dd37bd17d3b973"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#EnvironmentEquiv"><span class="id" title="record">EnvironmentEquiv</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Classes.Morphisms.html#8dc5652698a6e16f72dd37bd17d3b973"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#EnvironmentEquiv"><span class="id" title="record">EnvironmentEquiv</span></a>) <a class="idref" href="ConCert.Execution.Blockchain.html#transfer_balance"><span class="id" title="definition">transfer_balance</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> <span class="id" title="tactic">intro</span>; <span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="ConCert.Execution.Blockchain.html#transfer_balance"><span class="id" title="definition">transfer_balance</span></a>, <a class="idref" href="ConCert.Execution.Blockchain.html#add_balance"><span class="id" title="definition">add_balance</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="var">solve_proper</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Global Instance</span> <a id="add_contract_proper" class="idref" href="#add_contract_proper"><span class="id" title="instance">add_contract_proper</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Classes.Morphisms.html#Proper"><span class="id" title="class">Proper</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#eq"><span class="id" title="inductive">eq</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Classes.Morphisms.html#8dc5652698a6e16f72dd37bd17d3b973"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#eq"><span class="id" title="inductive">eq</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Classes.Morphisms.html#8dc5652698a6e16f72dd37bd17d3b973"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#EnvironmentEquiv"><span class="id" title="record">EnvironmentEquiv</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Classes.Morphisms.html#8dc5652698a6e16f72dd37bd17d3b973"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#EnvironmentEquiv"><span class="id" title="record">EnvironmentEquiv</span></a>) <a class="idref" href="ConCert.Execution.Blockchain.html#add_contract"><span class="id" title="definition">add_contract</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> <span class="id" title="tactic">intro</span>; <span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="ConCert.Execution.Blockchain.html#add_contract"><span class="id" title="definition">add_contract</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="var">solve_proper</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Global Instance</span> <a id="set_contract_state_proper" class="idref" href="#set_contract_state_proper"><span class="id" title="instance">set_contract_state_proper</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Classes.Morphisms.html#Proper"><span class="id" title="class">Proper</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#eq"><span class="id" title="inductive">eq</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Classes.Morphisms.html#8dc5652698a6e16f72dd37bd17d3b973"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#eq"><span class="id" title="inductive">eq</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Classes.Morphisms.html#8dc5652698a6e16f72dd37bd17d3b973"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#EnvironmentEquiv"><span class="id" title="record">EnvironmentEquiv</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Classes.Morphisms.html#8dc5652698a6e16f72dd37bd17d3b973"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#EnvironmentEquiv"><span class="id" title="record">EnvironmentEquiv</span></a>) <a class="idref" href="ConCert.Execution.Blockchain.html#set_contract_state"><span class="id" title="definition">set_contract_state</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> <span class="id" title="tactic">intro</span>; <span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="ConCert.Execution.Blockchain.html#set_contract_state"><span class="id" title="definition">set_contract_state</span></a>, <a class="idref" href="ConCert.Execution.Blockchain.html#set_chain_contract_state"><span class="id" title="definition">set_chain_contract_state</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="var">solve_proper</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Local Open</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">Z</span>.<br/>
<span class="comment">(*&nbsp;Next&nbsp;we&nbsp;define&nbsp;how&nbsp;actions&nbsp;are&nbsp;executed.&nbsp;It&nbsp;specifies&nbsp;how&nbsp;an&nbsp;action<br/>
changes&nbsp;an&nbsp;environment&nbsp;and&nbsp;which&nbsp;external&nbsp;actions&nbsp;to&nbsp;execute&nbsp;after&nbsp;it.<br/>
Note&nbsp;that&nbsp;there&nbsp;can&nbsp;be&nbsp;multiple&nbsp;ways&nbsp;to&nbsp;execute&nbsp;an&nbsp;action.&nbsp;For&nbsp;example,&nbsp;if<br/>
the&nbsp;action&nbsp;says&nbsp;to&nbsp;deploy&nbsp;a&nbsp;contract,&nbsp;the&nbsp;implementation&nbsp;is&nbsp;responsible&nbsp;for<br/>
selecting&nbsp;which&nbsp;address&nbsp;the&nbsp;new&nbsp;contract&nbsp;should&nbsp;get.&nbsp;*)</span><br/>
<span class="id" title="keyword">Inductive</span> <a id="ActionEvaluation" class="idref" href="#ActionEvaluation"><span class="id" title="inductive">ActionEvaluation</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="prev_env:153" class="idref" href="#prev_env:153"><span class="id" title="binder">prev_env</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Environment"><span class="id" title="record">Environment</span></a>) (<a id="act:154" class="idref" href="#act:154"><span class="id" title="binder">act</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Action"><span class="id" title="record">Action</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="new_env:155" class="idref" href="#new_env:155"><span class="id" title="binder">new_env</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Environment"><span class="id" title="record">Environment</span></a>) (<a id="new_acts:156" class="idref" href="#new_acts:156"><span class="id" title="binder">new_acts</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Action"><span class="id" title="record">Action</span></a>) : <span class="id" title="keyword">Type</span> :=<br/>
&nbsp;&nbsp;| <a id="eval_transfer" class="idref" href="#eval_transfer"><span class="id" title="constructor">eval_transfer</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">forall</span> (<a id="origin:159" class="idref" href="#origin:159"><span class="id" title="binder">origin</span></a> <a id="from_addr:160" class="idref" href="#from_addr:160"><span class="id" title="binder">from_addr</span></a> <a id="to_addr:161" class="idref" href="#to_addr:161"><span class="id" title="binder">to_addr</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="amount:162" class="idref" href="#amount:162"><span class="id" title="binder">amount</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Amount"><span class="id" title="definition">Amount</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#amount:162"><span class="id" title="variable">amount</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.ZArith.BinInt.html#b1f0780291abe9bd18804d2c9a5039d4"><span class="id" title="notation">&gt;=</span></a> 0 <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#amount:162"><span class="id" title="variable">amount</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.ZArith.BinInt.html#306329b0eca7a2b86c198702f594ad8e"><span class="id" title="notation">&lt;=</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#env_account_balances"><span class="id" title="projection">env_account_balances</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#prev_env:153"><span class="id" title="variable">prev_env</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#from_addr:160"><span class="id" title="variable">from_addr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#address_is_contract"><span class="id" title="method">address_is_contract</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#to_addr:161"><span class="id" title="variable">to_addr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#act:154"><span class="id" title="variable">act</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#build_act"><span class="id" title="constructor">build_act</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#origin:159"><span class="id" title="variable">origin</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#from_addr:160"><span class="id" title="variable">from_addr</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#act_transfer"><span class="id" title="constructor">act_transfer</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#to_addr:161"><span class="id" title="variable">to_addr</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#amount:162"><span class="id" title="variable">amount</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#EnvironmentEquiv"><span class="id" title="record">EnvironmentEquiv</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#new_env:155"><span class="id" title="variable">new_env</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ConCert.Execution.Blockchain.html#transfer_balance"><span class="id" title="definition">transfer_balance</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#from_addr:160"><span class="id" title="variable">from_addr</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#to_addr:161"><span class="id" title="variable">to_addr</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#amount:162"><span class="id" title="variable">amount</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#prev_env:153"><span class="id" title="variable">prev_env</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#new_acts:156"><span class="id" title="variable">new_acts</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#ActionEvaluation:157"><span class="id" title="inductive">ActionEvaluation</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#prev_env:153"><span class="id" title="variable">prev_env</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#act:154"><span class="id" title="variable">act</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#new_env:155"><span class="id" title="variable">new_env</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#new_acts:156"><span class="id" title="variable">new_acts</span></a><br/>
&nbsp;&nbsp;| <a id="eval_deploy" class="idref" href="#eval_deploy"><span class="id" title="constructor">eval_deploy</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">forall</span> (<a id="origin:163" class="idref" href="#origin:163"><span class="id" title="binder">origin</span></a> <a id="from_addr:164" class="idref" href="#from_addr:164"><span class="id" title="binder">from_addr</span></a> <a id="to_addr:165" class="idref" href="#to_addr:165"><span class="id" title="binder">to_addr</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="amount:166" class="idref" href="#amount:166"><span class="id" title="binder">amount</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Amount"><span class="id" title="definition">Amount</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="wc:167" class="idref" href="#wc:167"><span class="id" title="binder">wc</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#WeakContract"><span class="id" title="inductive">WeakContract</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="setup:168" class="idref" href="#setup:168"><span class="id" title="binder">setup</span></a> : <a class="idref" href="ConCert.Execution.Serializable.html#SerializedValue"><span class="id" title="record">SerializedValue</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="state:169" class="idref" href="#state:169"><span class="id" title="binder">state</span></a> : <a class="idref" href="ConCert.Execution.Serializable.html#SerializedValue"><span class="id" title="record">SerializedValue</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#amount:166"><span class="id" title="variable">amount</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.ZArith.BinInt.html#b1f0780291abe9bd18804d2c9a5039d4"><span class="id" title="notation">&gt;=</span></a> 0 <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#amount:166"><span class="id" title="variable">amount</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.ZArith.BinInt.html#306329b0eca7a2b86c198702f594ad8e"><span class="id" title="notation">&lt;=</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#env_account_balances"><span class="id" title="projection">env_account_balances</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#prev_env:153"><span class="id" title="variable">prev_env</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#from_addr:164"><span class="id" title="variable">from_addr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#address_is_contract"><span class="id" title="method">address_is_contract</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#to_addr:165"><span class="id" title="variable">to_addr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#env_contracts"><span class="id" title="projection">env_contracts</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#prev_env:153"><span class="id" title="variable">prev_env</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#to_addr:165"><span class="id" title="variable">to_addr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#act:154"><span class="id" title="variable">act</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#build_act"><span class="id" title="constructor">build_act</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#origin:163"><span class="id" title="variable">origin</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#from_addr:164"><span class="id" title="variable">from_addr</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#act_deploy"><span class="id" title="constructor">act_deploy</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#amount:166"><span class="id" title="variable">amount</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#wc:167"><span class="id" title="variable">wc</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#setup:168"><span class="id" title="variable">setup</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#wc_init"><span class="id" title="definition">wc_init</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#wc:167"><span class="id" title="variable">wc</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ConCert.Execution.Blockchain.html#transfer_balance"><span class="id" title="definition">transfer_balance</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#from_addr:164"><span class="id" title="variable">from_addr</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#to_addr:165"><span class="id" title="variable">to_addr</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#amount:166"><span class="id" title="variable">amount</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#prev_env:153"><span class="id" title="variable">prev_env</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ConCert.Execution.Blockchain.html#build_ctx"><span class="id" title="constructor">build_ctx</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#origin:163"><span class="id" title="variable">origin</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#from_addr:164"><span class="id" title="variable">from_addr</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#to_addr:165"><span class="id" title="variable">to_addr</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#amount:166"><span class="id" title="variable">amount</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#amount:166"><span class="id" title="variable">amount</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#setup:168"><span class="id" title="variable">setup</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#state:169"><span class="id" title="variable">state</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#EnvironmentEquiv"><span class="id" title="record">EnvironmentEquiv</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#new_env:155"><span class="id" title="variable">new_env</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ConCert.Execution.Blockchain.html#set_contract_state"><span class="id" title="definition">set_contract_state</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#to_addr:165"><span class="id" title="variable">to_addr</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#state:169"><span class="id" title="variable">state</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#add_contract"><span class="id" title="definition">add_contract</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#to_addr:165"><span class="id" title="variable">to_addr</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#wc:167"><span class="id" title="variable">wc</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#transfer_balance"><span class="id" title="definition">transfer_balance</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#from_addr:164"><span class="id" title="variable">from_addr</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#to_addr:165"><span class="id" title="variable">to_addr</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#amount:166"><span class="id" title="variable">amount</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#prev_env:153"><span class="id" title="variable">prev_env</span></a>))) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#new_acts:156"><span class="id" title="variable">new_acts</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#ActionEvaluation:157"><span class="id" title="inductive">ActionEvaluation</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#prev_env:153"><span class="id" title="variable">prev_env</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#act:154"><span class="id" title="variable">act</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#new_env:155"><span class="id" title="variable">new_env</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#new_acts:156"><span class="id" title="variable">new_acts</span></a><br/>
&nbsp;&nbsp;| <a id="eval_call" class="idref" href="#eval_call"><span class="id" title="constructor">eval_call</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">forall</span> (<a id="origin:170" class="idref" href="#origin:170"><span class="id" title="binder">origin</span></a> <a id="from_addr:171" class="idref" href="#from_addr:171"><span class="id" title="binder">from_addr</span></a> <a id="to_addr:172" class="idref" href="#to_addr:172"><span class="id" title="binder">to_addr</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="amount:173" class="idref" href="#amount:173"><span class="id" title="binder">amount</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Amount"><span class="id" title="definition">Amount</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="wc:174" class="idref" href="#wc:174"><span class="id" title="binder">wc</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#WeakContract"><span class="id" title="inductive">WeakContract</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="msg:175" class="idref" href="#msg:175"><span class="id" title="binder">msg</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="ConCert.Execution.Serializable.html#SerializedValue"><span class="id" title="record">SerializedValue</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="prev_state:176" class="idref" href="#prev_state:176"><span class="id" title="binder">prev_state</span></a> : <a class="idref" href="ConCert.Execution.Serializable.html#SerializedValue"><span class="id" title="record">SerializedValue</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="new_state:177" class="idref" href="#new_state:177"><span class="id" title="binder">new_state</span></a> : <a class="idref" href="ConCert.Execution.Serializable.html#SerializedValue"><span class="id" title="record">SerializedValue</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="resp_acts:178" class="idref" href="#resp_acts:178"><span class="id" title="binder">resp_acts</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ActionBody"><span class="id" title="inductive">ActionBody</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#amount:173"><span class="id" title="variable">amount</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.ZArith.BinInt.html#b1f0780291abe9bd18804d2c9a5039d4"><span class="id" title="notation">&gt;=</span></a> 0 <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#amount:173"><span class="id" title="variable">amount</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.ZArith.BinInt.html#306329b0eca7a2b86c198702f594ad8e"><span class="id" title="notation">&lt;=</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#env_account_balances"><span class="id" title="projection">env_account_balances</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#prev_env:153"><span class="id" title="variable">prev_env</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#from_addr:171"><span class="id" title="variable">from_addr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#env_contracts"><span class="id" title="projection">env_contracts</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#prev_env:153"><span class="id" title="variable">prev_env</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#to_addr:172"><span class="id" title="variable">to_addr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#wc:174"><span class="id" title="variable">wc</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#env_contract_states"><span class="id" title="projection">env_contract_states</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#prev_env:153"><span class="id" title="variable">prev_env</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#to_addr:172"><span class="id" title="variable">to_addr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#prev_state:176"><span class="id" title="variable">prev_state</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#act:154"><span class="id" title="variable">act</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#build_act"><span class="id" title="constructor">build_act</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#origin:170"><span class="id" title="variable">origin</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#from_addr:171"><span class="id" title="variable">from_addr</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">match</span> <a class="idref" href="ConCert.Execution.Blockchain.html#msg:175"><span class="id" title="variable">msg</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> =&gt; <a class="idref" href="ConCert.Execution.Blockchain.html#act_transfer"><span class="id" title="constructor">act_transfer</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#to_addr:172"><span class="id" title="variable">to_addr</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#amount:173"><span class="id" title="variable">amount</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">msg</span> =&gt; <a class="idref" href="ConCert.Execution.Blockchain.html#act_call"><span class="id" title="constructor">act_call</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#to_addr:172"><span class="id" title="variable">to_addr</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#amount:173"><span class="id" title="variable">amount</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#msg:175"><span class="id" title="variable">msg</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#wc_receive"><span class="id" title="definition">wc_receive</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#wc:174"><span class="id" title="variable">wc</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ConCert.Execution.Blockchain.html#transfer_balance"><span class="id" title="definition">transfer_balance</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#from_addr:171"><span class="id" title="variable">from_addr</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#to_addr:172"><span class="id" title="variable">to_addr</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#amount:173"><span class="id" title="variable">amount</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#prev_env:153"><span class="id" title="variable">prev_env</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ConCert.Execution.Blockchain.html#build_ctx"><span class="id" title="constructor">build_ctx</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#origin:170"><span class="id" title="variable">origin</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#from_addr:171"><span class="id" title="variable">from_addr</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#to_addr:172"><span class="id" title="variable">to_addr</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#env_account_balances"><span class="id" title="projection">env_account_balances</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#new_env:155"><span class="id" title="variable">new_env</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#to_addr:172"><span class="id" title="variable">to_addr</span></a>) <a class="idref" href="ConCert.Execution.Blockchain.html#amount:173"><span class="id" title="variable">amount</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#prev_state:176"><span class="id" title="variable">prev_state</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#msg:175"><span class="id" title="variable">msg</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Execution.Blockchain.html#new_state:177"><span class="id" title="variable">new_state</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#resp_acts:178"><span class="id" title="variable">resp_acts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#new_acts:156"><span class="id" title="variable">new_acts</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Lists.List.html#map"><span class="id" title="definition">map</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#build_act"><span class="id" title="constructor">build_act</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#origin:170"><span class="id" title="variable">origin</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#to_addr:172"><span class="id" title="variable">to_addr</span></a>) <a class="idref" href="ConCert.Execution.Blockchain.html#resp_acts:178"><span class="id" title="variable">resp_acts</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#EnvironmentEquiv"><span class="id" title="record">EnvironmentEquiv</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#new_env:155"><span class="id" title="variable">new_env</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ConCert.Execution.Blockchain.html#set_contract_state"><span class="id" title="definition">set_contract_state</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#to_addr:172"><span class="id" title="variable">to_addr</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#new_state:177"><span class="id" title="variable">new_state</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#transfer_balance"><span class="id" title="definition">transfer_balance</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#from_addr:171"><span class="id" title="variable">from_addr</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#to_addr:172"><span class="id" title="variable">to_addr</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#amount:173"><span class="id" title="variable">amount</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#prev_env:153"><span class="id" title="variable">prev_env</span></a>)) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#ActionEvaluation:157"><span class="id" title="inductive">ActionEvaluation</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#prev_env:153"><span class="id" title="variable">prev_env</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#act:154"><span class="id" title="variable">act</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#new_env:155"><span class="id" title="variable">new_env</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#new_acts:156"><span class="id" title="variable">new_acts</span></a>.<br/>

<br/>
<span class="id" title="keyword">Global Arguments</span> <a class="idref" href="ConCert.Execution.Blockchain.html#eval_transfer"><span class="id" title="constructor">eval_transfer</span></a> {<span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> }.<br/>
<span class="id" title="keyword">Global Arguments</span> <a class="idref" href="ConCert.Execution.Blockchain.html#eval_deploy"><span class="id" title="constructor">eval_deploy</span></a> {<span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> }.<br/>
<span class="id" title="keyword">Global Arguments</span> <a class="idref" href="ConCert.Execution.Blockchain.html#eval_call"><span class="id" title="constructor">eval_call</span></a> {<span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>}.<br/>

<br/>
<span class="id" title="keyword">Section</span> <a id="Blockchain.Semantics.Accessors" class="idref" href="#Blockchain.Semantics.Accessors"><span class="id" title="section">Accessors</span></a>.<br/>
<span class="id" title="keyword">Context</span> {<a id="origin:180" class="idref" href="#origin:180"><span class="id" title="binder">origin</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<a id="pre:181" class="idref" href="#pre:181"><span class="id" title="binder">pre</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Environment"><span class="id" title="record">Environment</span></a>} {<a id="act:182" class="idref" href="#act:182"><span class="id" title="binder">act</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Action"><span class="id" title="record">Action</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<a id="post:183" class="idref" href="#post:183"><span class="id" title="binder">post</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Environment"><span class="id" title="record">Environment</span></a>} {<a id="new_acts:184" class="idref" href="#new_acts:184"><span class="id" title="binder">new_acts</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Action"><span class="id" title="record">Action</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="eval:185" class="idref" href="#eval:185"><span class="id" title="binder">eval</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#ActionEvaluation"><span class="id" title="inductive">ActionEvaluation</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#pre:181"><span class="id" title="variable">pre</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#act:182"><span class="id" title="variable">act</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#post:183"><span class="id" title="variable">post</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#new_acts:184"><span class="id" title="variable">new_acts</span></a>).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="eval_origin" class="idref" href="#eval_origin"><span class="id" title="definition">eval_origin</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="ConCert.Execution.Blockchain.html#Blockchain.Semantics.Accessors.eval"><span class="id" title="variable">eval</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="ConCert.Execution.Blockchain.html#eval_transfer"><span class="id" title="constructor">eval_transfer</span></a> <span class="id" title="var">origin</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span><br/>
&nbsp;&nbsp;| <a class="idref" href="ConCert.Execution.Blockchain.html#eval_deploy"><span class="id" title="constructor">eval_deploy</span></a> <span class="id" title="var">origin</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span><br/>
&nbsp;&nbsp;| <a class="idref" href="ConCert.Execution.Blockchain.html#eval_call"><span class="id" title="constructor">eval_call</span></a> <span class="id" title="var">origin</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">origin</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="eval_from" class="idref" href="#eval_from"><span class="id" title="definition">eval_from</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="ConCert.Execution.Blockchain.html#Blockchain.Semantics.Accessors.eval"><span class="id" title="variable">eval</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="ConCert.Execution.Blockchain.html#eval_transfer"><span class="id" title="constructor">eval_transfer</span></a> <span class="id" title="var">_</span> <span class="id" title="var">from</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span><br/>
&nbsp;&nbsp;| <a class="idref" href="ConCert.Execution.Blockchain.html#eval_deploy"><span class="id" title="constructor">eval_deploy</span></a> <span class="id" title="var">_</span> <span class="id" title="var">from</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span><br/>
&nbsp;&nbsp;| <a class="idref" href="ConCert.Execution.Blockchain.html#eval_call"><span class="id" title="constructor">eval_call</span></a> <span class="id" title="var">_</span> <span class="id" title="var">from</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">from</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="eval_to" class="idref" href="#eval_to"><span class="id" title="definition">eval_to</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="ConCert.Execution.Blockchain.html#Blockchain.Semantics.Accessors.eval"><span class="id" title="variable">eval</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="ConCert.Execution.Blockchain.html#eval_transfer"><span class="id" title="constructor">eval_transfer</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">to</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span><br/>
&nbsp;&nbsp;| <a class="idref" href="ConCert.Execution.Blockchain.html#eval_deploy"><span class="id" title="constructor">eval_deploy</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">to</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span><br/>
&nbsp;&nbsp;| <a class="idref" href="ConCert.Execution.Blockchain.html#eval_call"><span class="id" title="constructor">eval_call</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">to</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">to</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="eval_amount" class="idref" href="#eval_amount"><span class="id" title="definition">eval_amount</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Amount"><span class="id" title="definition">Amount</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="ConCert.Execution.Blockchain.html#Blockchain.Semantics.Accessors.eval"><span class="id" title="variable">eval</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="ConCert.Execution.Blockchain.html#eval_transfer"><span class="id" title="constructor">eval_transfer</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">amount</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span><br/>
&nbsp;&nbsp;| <a class="idref" href="ConCert.Execution.Blockchain.html#eval_deploy"><span class="id" title="constructor">eval_deploy</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">amount</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span><br/>
&nbsp;&nbsp;| <a class="idref" href="ConCert.Execution.Blockchain.html#eval_call"><span class="id" title="constructor">eval_call</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">amount</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">amount</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>
<span class="id" title="keyword">End</span> <a class="idref" href="ConCert.Execution.Blockchain.html#Blockchain.Semantics.Accessors"><span class="id" title="section">Accessors</span></a>.<br/>

<br/>
<span class="id" title="keyword">Section</span> <a id="Blockchain.Semantics.Theories" class="idref" href="#Blockchain.Semantics.Theories"><span class="id" title="section">Theories</span></a>.<br/>
<span class="id" title="keyword">Context</span> {<a id="origin:190" class="idref" href="#origin:190"><span class="id" title="binder">origin</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<a id="pre:191" class="idref" href="#pre:191"><span class="id" title="binder">pre</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Environment"><span class="id" title="record">Environment</span></a>} {<a id="act:192" class="idref" href="#act:192"><span class="id" title="binder">act</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Action"><span class="id" title="record">Action</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<a id="post:193" class="idref" href="#post:193"><span class="id" title="binder">post</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Environment"><span class="id" title="record">Environment</span></a>} {<a id="new_acts:194" class="idref" href="#new_acts:194"><span class="id" title="binder">new_acts</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Action"><span class="id" title="record">Action</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="eval:195" class="idref" href="#eval:195"><span class="id" title="binder">eval</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#ActionEvaluation"><span class="id" title="inductive">ActionEvaluation</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#pre:191"><span class="id" title="variable">pre</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#act:192"><span class="id" title="variable">act</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#post:193"><span class="id" title="variable">post</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#new_acts:194"><span class="id" title="variable">new_acts</span></a>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="account_balance_post" class="idref" href="#account_balance_post"><span class="id" title="lemma">account_balance_post</span></a> (<a id="addr:196" class="idref" href="#addr:196"><span class="id" title="binder">addr</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a>) :<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#env_account_balances"><span class="id" title="projection">env_account_balances</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Blockchain.Semantics.Theories.post"><span class="id" title="variable">post</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#addr:196"><span class="id" title="variable">addr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#env_account_balances"><span class="id" title="projection">env_account_balances</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Blockchain.Semantics.Theories.pre"><span class="id" title="variable">pre</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#addr:196"><span class="id" title="variable">addr</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a"><span class="id" title="notation">+</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a"><span class="id" title="notation">(</span></a><span class="id" title="keyword">if</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#addr:196"><span class="id" title="variable">addr</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#6f617e0e5500b437e5aeb1eaa876d41f"><span class="id" title="notation">=?</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#eval_to"><span class="id" title="definition">eval_to</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Blockchain.Semantics.Theories.eval"><span class="id" title="variable">eval</span></a>)%<span class="id" title="var">address</span> <span class="id" title="keyword">then</span> <a class="idref" href="ConCert.Execution.Blockchain.html#eval_amount"><span class="id" title="definition">eval_amount</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Blockchain.Semantics.Theories.eval"><span class="id" title="variable">eval</span></a> <span class="id" title="keyword">else</span> 0<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.ZArith.BinInt.html#::Z_scope:x_'-'_x"><span class="id" title="notation">-</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.ZArith.BinInt.html#::Z_scope:x_'-'_x"><span class="id" title="notation">(</span></a><span class="id" title="keyword">if</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#addr:196"><span class="id" title="variable">addr</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#6f617e0e5500b437e5aeb1eaa876d41f"><span class="id" title="notation">=?</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#eval_from"><span class="id" title="definition">eval_from</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Blockchain.Semantics.Theories.eval"><span class="id" title="variable">eval</span></a>)%<span class="id" title="var">address</span> <span class="id" title="keyword">then</span> <a class="idref" href="ConCert.Execution.Blockchain.html#eval_amount"><span class="id" title="definition">eval_amount</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Blockchain.Semantics.Theories.eval"><span class="id" title="variable">eval</span></a> <span class="id" title="keyword">else</span> 0<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.ZArith.BinInt.html#::Z_scope:x_'-'_x"><span class="id" title="notation">)</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <a class="idref" href="ConCert.Execution.Blockchain.html#Blockchain.Semantics.Theories.eval"><span class="id" title="variable">eval</span></a>; <span class="id" title="var">cbn</span>; <span class="id" title="var">rewrite_environment_equiv</span>; <span class="id" title="var">cbn</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">destruct_address_eq</span>; <span class="id" title="var">lia</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="account_balance_post_to" class="idref" href="#account_balance_post_to"><span class="id" title="lemma">account_balance_post_to</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#eval_from"><span class="id" title="definition">eval_from</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Blockchain.Semantics.Theories.eval"><span class="id" title="variable">eval</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'&lt;&gt;'_x"><span class="id" title="notation">&lt;&gt;</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#eval_to"><span class="id" title="definition">eval_to</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Blockchain.Semantics.Theories.eval"><span class="id" title="variable">eval</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#env_account_balances"><span class="id" title="projection">env_account_balances</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Blockchain.Semantics.Theories.post"><span class="id" title="variable">post</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#eval_to"><span class="id" title="definition">eval_to</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Blockchain.Semantics.Theories.eval"><span class="id" title="variable">eval</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#env_account_balances"><span class="id" title="projection">env_account_balances</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Blockchain.Semantics.Theories.pre"><span class="id" title="variable">pre</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#eval_to"><span class="id" title="definition">eval_to</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Blockchain.Semantics.Theories.eval"><span class="id" title="variable">eval</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a"><span class="id" title="notation">+</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#eval_amount"><span class="id" title="definition">eval_amount</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Blockchain.Semantics.Theories.eval"><span class="id" title="variable">eval</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">neq</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Execution.Blockchain.html#account_balance_post"><span class="id" title="lemma">account_balance_post</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Execution.Blockchain.html#address_eq_refl"><span class="id" title="lemma">address_eq_refl</span></a>, <a class="idref" href="ConCert.Execution.Blockchain.html#address_eq_ne"><span class="id" title="lemma">address_eq_ne</span></a> <span class="id" title="tactic">by</span> <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">lia</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="account_balance_post_from" class="idref" href="#account_balance_post_from"><span class="id" title="lemma">account_balance_post_from</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#eval_from"><span class="id" title="definition">eval_from</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Blockchain.Semantics.Theories.eval"><span class="id" title="variable">eval</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'&lt;&gt;'_x"><span class="id" title="notation">&lt;&gt;</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#eval_to"><span class="id" title="definition">eval_to</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Blockchain.Semantics.Theories.eval"><span class="id" title="variable">eval</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#env_account_balances"><span class="id" title="projection">env_account_balances</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Blockchain.Semantics.Theories.post"><span class="id" title="variable">post</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#eval_from"><span class="id" title="definition">eval_from</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Blockchain.Semantics.Theories.eval"><span class="id" title="variable">eval</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#env_account_balances"><span class="id" title="projection">env_account_balances</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Blockchain.Semantics.Theories.pre"><span class="id" title="variable">pre</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#eval_from"><span class="id" title="definition">eval_from</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Blockchain.Semantics.Theories.eval"><span class="id" title="variable">eval</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.ZArith.BinInt.html#::Z_scope:x_'-'_x"><span class="id" title="notation">-</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#eval_amount"><span class="id" title="definition">eval_amount</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Blockchain.Semantics.Theories.eval"><span class="id" title="variable">eval</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">neq</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Execution.Blockchain.html#account_balance_post"><span class="id" title="lemma">account_balance_post</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Execution.Blockchain.html#address_eq_refl"><span class="id" title="lemma">address_eq_refl</span></a>, <a class="idref" href="ConCert.Execution.Blockchain.html#address_eq_ne"><span class="id" title="lemma">address_eq_ne</span></a> <span class="id" title="tactic">by</span> <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">lia</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="account_balance_post_irrelevant" class="idref" href="#account_balance_post_irrelevant"><span class="id" title="lemma">account_balance_post_irrelevant</span></a> (<a id="addr:197" class="idref" href="#addr:197"><span class="id" title="binder">addr</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a>) :<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#addr:197"><span class="id" title="variable">addr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'&lt;&gt;'_x"><span class="id" title="notation">&lt;&gt;</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#eval_from"><span class="id" title="definition">eval_from</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Blockchain.Semantics.Theories.eval"><span class="id" title="variable">eval</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#addr:197"><span class="id" title="variable">addr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'&lt;&gt;'_x"><span class="id" title="notation">&lt;&gt;</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#eval_to"><span class="id" title="definition">eval_to</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Blockchain.Semantics.Theories.eval"><span class="id" title="variable">eval</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#env_account_balances"><span class="id" title="projection">env_account_balances</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Blockchain.Semantics.Theories.post"><span class="id" title="variable">post</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#addr:197"><span class="id" title="variable">addr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#env_account_balances"><span class="id" title="projection">env_account_balances</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Blockchain.Semantics.Theories.pre"><span class="id" title="variable">pre</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#addr:197"><span class="id" title="variable">addr</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">neq_from</span> <span class="id" title="var">neq_to</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Execution.Blockchain.html#account_balance_post"><span class="id" title="lemma">account_balance_post</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Execution.Blockchain.html#address_eq_ne"><span class="id" title="lemma">address_eq_ne</span></a> <span class="id" title="tactic">by</span> <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">lia</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="chain_height_post_action" class="idref" href="#chain_height_post_action"><span class="id" title="lemma">chain_height_post_action</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#chain_height"><span class="id" title="projection">chain_height</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Blockchain.Semantics.Theories.post"><span class="id" title="variable">post</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#chain_height"><span class="id" title="projection">chain_height</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Blockchain.Semantics.Theories.pre"><span class="id" title="variable">pre</span></a>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">destruct</span> <a class="idref" href="ConCert.Execution.Blockchain.html#Blockchain.Semantics.Theories.eval"><span class="id" title="variable">eval</span></a>; <span class="id" title="var">rewrite_environment_equiv</span>; <span class="id" title="tactic">auto</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="current_slot_post_action" class="idref" href="#current_slot_post_action"><span class="id" title="lemma">current_slot_post_action</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#current_slot"><span class="id" title="projection">current_slot</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Blockchain.Semantics.Theories.post"><span class="id" title="variable">post</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#current_slot"><span class="id" title="projection">current_slot</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Blockchain.Semantics.Theories.pre"><span class="id" title="variable">pre</span></a>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">destruct</span> <a class="idref" href="ConCert.Execution.Blockchain.html#Blockchain.Semantics.Theories.eval"><span class="id" title="variable">eval</span></a>; <span class="id" title="var">rewrite_environment_equiv</span>; <span class="id" title="tactic">auto</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="finalized_height_post_action" class="idref" href="#finalized_height_post_action"><span class="id" title="lemma">finalized_height_post_action</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#finalized_height"><span class="id" title="projection">finalized_height</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Blockchain.Semantics.Theories.post"><span class="id" title="variable">post</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#finalized_height"><span class="id" title="projection">finalized_height</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Blockchain.Semantics.Theories.pre"><span class="id" title="variable">pre</span></a>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">destruct</span> <a class="idref" href="ConCert.Execution.Blockchain.html#Blockchain.Semantics.Theories.eval"><span class="id" title="variable">eval</span></a>; <span class="id" title="var">rewrite_environment_equiv</span>; <span class="id" title="tactic">auto</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="contracts_post_pre_none" class="idref" href="#contracts_post_pre_none"><span class="id" title="lemma">contracts_post_pre_none</span></a> <a id="contract:198" class="idref" href="#contract:198"><span class="id" title="binder">contract</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#env_contracts"><span class="id" title="projection">env_contracts</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Blockchain.Semantics.Theories.post"><span class="id" title="variable">post</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#contract:198"><span class="id" title="variable">contract</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#env_contracts"><span class="id" title="projection">env_contracts</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Blockchain.Semantics.Theories.pre"><span class="id" title="variable">pre</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#contract:198"><span class="id" title="variable">contract</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <a class="idref" href="ConCert.Execution.Blockchain.html#Blockchain.Semantics.Theories.eval"><span class="id" title="variable">eval</span></a>; <span class="id" title="var">rewrite_environment_equiv</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;<span class="id" title="var">destruct_address_eq</span>; <span class="id" title="tactic">congruence</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="eval_amount_nonnegative" class="idref" href="#eval_amount_nonnegative"><span class="id" title="lemma">eval_amount_nonnegative</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#eval_amount"><span class="id" title="definition">eval_amount</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Blockchain.Semantics.Theories.eval"><span class="id" title="variable">eval</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.ZArith.BinInt.html#b1f0780291abe9bd18804d2c9a5039d4"><span class="id" title="notation">&gt;=</span></a> 0.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="var">now</span> <span class="id" title="tactic">destruct</span> <a class="idref" href="ConCert.Execution.Blockchain.html#Blockchain.Semantics.Theories.eval"><span class="id" title="variable">eval</span></a>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="eval_amount_le_account_balance" class="idref" href="#eval_amount_le_account_balance"><span class="id" title="lemma">eval_amount_le_account_balance</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#eval_amount"><span class="id" title="definition">eval_amount</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Blockchain.Semantics.Theories.eval"><span class="id" title="variable">eval</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.ZArith.BinInt.html#306329b0eca7a2b86c198702f594ad8e"><span class="id" title="notation">&lt;=</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#env_account_balances"><span class="id" title="projection">env_account_balances</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Blockchain.Semantics.Theories.pre"><span class="id" title="variable">pre</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#eval_from"><span class="id" title="definition">eval_from</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Blockchain.Semantics.Theories.eval"><span class="id" title="variable">eval</span></a>).<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="var">now</span> <span class="id" title="tactic">destruct</span> <a class="idref" href="ConCert.Execution.Blockchain.html#Blockchain.Semantics.Theories.eval"><span class="id" title="variable">eval</span></a>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">End</span> <a class="idref" href="ConCert.Execution.Blockchain.html#Blockchain.Semantics.Theories"><span class="id" title="section">Theories</span></a>.<br/>

<br/>
<span class="id" title="keyword">Section</span> <a id="Blockchain.Semantics.Trace" class="idref" href="#Blockchain.Semantics.Trace"><span class="id" title="section">Trace</span></a>.<br/>

<br/>
<span class="id" title="keyword">Record</span> <a id="BlockHeader" class="idref" href="#BlockHeader"><span class="id" title="record">BlockHeader</span></a> :=<br/>
&nbsp;&nbsp;<a id="build_block_Header" class="idref" href="#build_block_Header"><span class="id" title="constructor">build_block_Header</span></a> {<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a id="block_height" class="idref" href="#block_height"><span class="id" title="projection">block_height</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a id="block_slot" class="idref" href="#block_slot"><span class="id" title="projection">block_slot</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a id="block_finalized_height" class="idref" href="#block_finalized_height"><span class="id" title="projection">block_finalized_height</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a id="block_reward" class="idref" href="#block_reward"><span class="id" title="projection">block_reward</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Amount"><span class="id" title="definition">Amount</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a id="block_creator" class="idref" href="#block_creator"><span class="id" title="projection">block_creator</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a>;<br/>
&nbsp;&nbsp;}.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="add_new_block_to_env" class="idref" href="#add_new_block_to_env"><span class="id" title="definition">add_new_block_to_env</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="header:205" class="idref" href="#header:205"><span class="id" title="binder">header</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#BlockHeader"><span class="id" title="record">BlockHeader</span></a>) (<a id="env:206" class="idref" href="#env:206"><span class="id" title="binder">env</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Environment"><span class="id" title="record">Environment</span></a>) : <a class="idref" href="ConCert.Execution.Blockchain.html#Environment"><span class="id" title="record">Environment</span></a> :=<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#env:206"><span class="id" title="variable">env</span></a><a class="idref" href="ConCert.Utils.RecordSet.html#d8ee35e247a15fc7b8a66b09a91f7b72"><span class="id" title="notation">&lt;|</span></a><a class="idref" href="ConCert.Execution.Blockchain.html#env_chain"><span class="id" title="projection">env_chain</span></a><a class="idref" href="ConCert.Utils.RecordSet.html#d8ee35e247a15fc7b8a66b09a91f7b72"><span class="id" title="notation">;</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#chain_height"><span class="id" title="projection">chain_height</span></a> <a class="idref" href="ConCert.Utils.RecordSet.html#d8ee35e247a15fc7b8a66b09a91f7b72"><span class="id" title="notation">:=</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#block_height"><span class="id" title="projection">block_height</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#header:205"><span class="id" title="variable">header</span></a><a class="idref" href="ConCert.Utils.RecordSet.html#d8ee35e247a15fc7b8a66b09a91f7b72"><span class="id" title="notation">|&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Utils.RecordSet.html#d8ee35e247a15fc7b8a66b09a91f7b72"><span class="id" title="notation">&lt;|</span></a><a class="idref" href="ConCert.Execution.Blockchain.html#env_chain"><span class="id" title="projection">env_chain</span></a><a class="idref" href="ConCert.Utils.RecordSet.html#d8ee35e247a15fc7b8a66b09a91f7b72"><span class="id" title="notation">;</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#current_slot"><span class="id" title="projection">current_slot</span></a> <a class="idref" href="ConCert.Utils.RecordSet.html#d8ee35e247a15fc7b8a66b09a91f7b72"><span class="id" title="notation">:=</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#block_slot"><span class="id" title="projection">block_slot</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#header:205"><span class="id" title="variable">header</span></a><a class="idref" href="ConCert.Utils.RecordSet.html#d8ee35e247a15fc7b8a66b09a91f7b72"><span class="id" title="notation">|&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Utils.RecordSet.html#d8ee35e247a15fc7b8a66b09a91f7b72"><span class="id" title="notation">&lt;|</span></a><a class="idref" href="ConCert.Execution.Blockchain.html#env_chain"><span class="id" title="projection">env_chain</span></a><a class="idref" href="ConCert.Utils.RecordSet.html#d8ee35e247a15fc7b8a66b09a91f7b72"><span class="id" title="notation">;</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#finalized_height"><span class="id" title="projection">finalized_height</span></a> <a class="idref" href="ConCert.Utils.RecordSet.html#d8ee35e247a15fc7b8a66b09a91f7b72"><span class="id" title="notation">:=</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#block_finalized_height"><span class="id" title="projection">block_finalized_height</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#header:205"><span class="id" title="variable">header</span></a><a class="idref" href="ConCert.Utils.RecordSet.html#d8ee35e247a15fc7b8a66b09a91f7b72"><span class="id" title="notation">|&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Utils.RecordSet.html#394068d0cf93ac4dd96dfc7ba41b06b2"><span class="id" title="notation">&lt;|</span></a><a class="idref" href="ConCert.Execution.Blockchain.html#env_account_balances"><span class="id" title="projection">env_account_balances</span></a> <a class="idref" href="ConCert.Utils.RecordSet.html#394068d0cf93ac4dd96dfc7ba41b06b2"><span class="id" title="notation">::=</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#add_balance"><span class="id" title="definition">add_balance</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#block_creator"><span class="id" title="projection">block_creator</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#header:205"><span class="id" title="variable">header</span></a>) (<a class="idref" href="ConCert.Execution.Blockchain.html#block_reward"><span class="id" title="projection">block_reward</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#header:205"><span class="id" title="variable">header</span></a>)<a class="idref" href="ConCert.Utils.RecordSet.html#394068d0cf93ac4dd96dfc7ba41b06b2"><span class="id" title="notation">|&gt;</span></a>.<br/>

<br/>
<span class="comment">(*&nbsp;Todo:&nbsp;this&nbsp;should&nbsp;just&nbsp;be&nbsp;a&nbsp;computation.&nbsp;But&nbsp;I&nbsp;still&nbsp;do&nbsp;not&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;know&nbsp;exactly&nbsp;what&nbsp;the&nbsp;best&nbsp;way&nbsp;of&nbsp;working&nbsp;with&nbsp;reflect&nbsp;is&nbsp;*)</span><br/>
<span class="id" title="keyword">Local Open</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">nat</span>.<br/>
<span class="id" title="keyword">Definition</span> <a id="act_is_from_account" class="idref" href="#act_is_from_account"><span class="id" title="definition">act_is_from_account</span></a> (<a id="act:207" class="idref" href="#act:207"><span class="id" title="binder">act</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Action"><span class="id" title="record">Action</span></a>) : <span class="id" title="keyword">Prop</span> :=<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#address_is_contract"><span class="id" title="method">address_is_contract</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#act_from"><span class="id" title="projection">act_from</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#act:207"><span class="id" title="variable">act</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="act_origin_is_account" class="idref" href="#act_origin_is_account"><span class="id" title="definition">act_origin_is_account</span></a> (<a id="act:208" class="idref" href="#act:208"><span class="id" title="binder">act</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Action"><span class="id" title="record">Action</span></a>) : <span class="id" title="keyword">Prop</span> :=<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#address_is_contract"><span class="id" title="method">address_is_contract</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#act_origin"><span class="id" title="projection">act_origin</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#act:208"><span class="id" title="variable">act</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="act_origin_is_eq_from" class="idref" href="#act_origin_is_eq_from"><span class="id" title="definition">act_origin_is_eq_from</span></a> (<a id="act:209" class="idref" href="#act:209"><span class="id" title="binder">act</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Action"><span class="id" title="record">Action</span></a>) : <span class="id" title="keyword">Prop</span> :=<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#address_eqb"><span class="id" title="method">address_eqb</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#act_origin"><span class="id" title="projection">act_origin</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#act:209"><span class="id" title="variable">act</span></a>) (<a class="idref" href="ConCert.Execution.Blockchain.html#act_from"><span class="id" title="projection">act_from</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#act:209"><span class="id" title="variable">act</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a>.<br/>

<br/>
<span class="id" title="keyword">Record</span> <a id="IsValidNextBlock" class="idref" href="#IsValidNextBlock"><span class="id" title="record">IsValidNextBlock</span></a> (<a id="header:210" class="idref" href="#header:210"><span class="id" title="binder">header</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#BlockHeader"><span class="id" title="record">BlockHeader</span></a>) (<a id="chain:211" class="idref" href="#chain:211"><span class="id" title="binder">chain</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Chain"><span class="id" title="record">Chain</span></a>) : <span class="id" title="keyword">Prop</span> :=<br/>
&nbsp;&nbsp;<a id="build_is_valid_next_block" class="idref" href="#build_is_valid_next_block"><span class="id" title="constructor">build_is_valid_next_block</span></a> {<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a id="valid_height" class="idref" href="#valid_height"><span class="id" title="projection">valid_height</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#block_height"><span class="id" title="projection">block_height</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#header:210"><span class="id" title="variable">header</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#chain_height"><span class="id" title="projection">chain_height</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#chain:211"><span class="id" title="variable">chain</span></a>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a id="valid_slot" class="idref" href="#valid_slot"><span class="id" title="projection">valid_slot</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#block_slot"><span class="id" title="projection">block_slot</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#header:210"><span class="id" title="variable">header</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Peano.html#::nat_scope:x_'&gt;'_x"><span class="id" title="notation">&gt;</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#current_slot"><span class="id" title="projection">current_slot</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#chain:211"><span class="id" title="variable">chain</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a id="valid_finalized_height" class="idref" href="#valid_finalized_height"><span class="id" title="projection">valid_finalized_height</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#block_finalized_height"><span class="id" title="projection">block_finalized_height</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#header:210"><span class="id" title="variable">header</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Peano.html#73030c22bc0b1fa771c65aa5414c65f9"><span class="id" title="notation">&gt;=</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#finalized_height"><span class="id" title="projection">finalized_height</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#chain:211"><span class="id" title="variable">chain</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#block_finalized_height"><span class="id" title="projection">block_finalized_height</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#header:210"><span class="id" title="variable">header</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Peano.html#::nat_scope:x_'&lt;'_x"><span class="id" title="notation">&lt;</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#block_height"><span class="id" title="projection">block_height</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#header:210"><span class="id" title="variable">header</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a id="valid_creator" class="idref" href="#valid_creator"><span class="id" title="projection">valid_creator</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#address_is_contract"><span class="id" title="method">address_is_contract</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#block_creator"><span class="id" title="projection">block_creator</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#header:210"><span class="id" title="variable">header</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a id="valid_reward" class="idref" href="#valid_reward"><span class="id" title="projection">valid_reward</span></a> : (<a class="idref" href="ConCert.Execution.Blockchain.html#block_reward"><span class="id" title="projection">block_reward</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#header:210"><span class="id" title="variable">header</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.ZArith.BinInt.html#b1f0780291abe9bd18804d2c9a5039d4"><span class="id" title="notation">&gt;=</span></a> 0)%<span class="id" title="var">Z</span>;<br/>
&nbsp;&nbsp;}.<br/>

<br/>
<span class="id" title="keyword">Record</span> <a id="ChainState" class="idref" href="#ChainState"><span class="id" title="record">ChainState</span></a> :=<br/>
&nbsp;&nbsp;<a id="build_chain_state" class="idref" href="#build_chain_state"><span class="id" title="constructor">build_chain_state</span></a> {<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a id="chain_state_env" class="idref" href="#chain_state_env"><span class="id" title="projection">chain_state_env</span></a> :&gt; <a class="idref" href="ConCert.Execution.Blockchain.html#Environment"><span class="id" title="record">Environment</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a id="chain_state_queue" class="idref" href="#chain_state_queue"><span class="id" title="projection">chain_state_queue</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Action"><span class="id" title="record">Action</span></a>;<br/>
&nbsp;&nbsp;}.<br/>

<br/>
<span class="id" title="var">MetaCoq</span> <span class="id" title="var">Run</span> (<a class="idref" href="ConCert.Utils.RecordSet.html#make_setters"><span class="id" title="definition">make_setters</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ChainState"><span class="id" title="record">ChainState</span></a>).<br/>

<br/>
<span class="id" title="keyword">Inductive</span> <a id="ChainStep" class="idref" href="#ChainStep"><span class="id" title="inductive">ChainStep</span></a> (<a id="prev_bstate:221" class="idref" href="#prev_bstate:221"><span class="id" title="binder">prev_bstate</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#ChainState"><span class="id" title="record">ChainState</span></a>) (<a id="next_bstate:222" class="idref" href="#next_bstate:222"><span class="id" title="binder">next_bstate</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#ChainState"><span class="id" title="record">ChainState</span></a>) :=<br/>
| <a id="step_block" class="idref" href="#step_block"><span class="id" title="constructor">step_block</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">forall</span> (<a id="header:225" class="idref" href="#header:225"><span class="id" title="binder">header</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#BlockHeader"><span class="id" title="record">BlockHeader</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#chain_state_queue"><span class="id" title="projection">chain_state_queue</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#prev_bstate:221"><span class="id" title="variable">prev_bstate</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#IsValidNextBlock"><span class="id" title="record">IsValidNextBlock</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#header:225"><span class="id" title="variable">header</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#prev_bstate:221"><span class="id" title="variable">prev_bstate</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Lists.List.html#Forall"><span class="id" title="inductive">Forall</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#act_is_from_account"><span class="id" title="definition">act_is_from_account</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#chain_state_queue"><span class="id" title="projection">chain_state_queue</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#next_bstate:222"><span class="id" title="variable">next_bstate</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Lists.List.html#Forall"><span class="id" title="inductive">Forall</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#act_origin_is_eq_from"><span class="id" title="definition">act_origin_is_eq_from</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#chain_state_queue"><span class="id" title="projection">chain_state_queue</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#next_bstate:222"><span class="id" title="variable">next_bstate</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#EnvironmentEquiv"><span class="id" title="record">EnvironmentEquiv</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#next_bstate:222"><span class="id" title="variable">next_bstate</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ConCert.Execution.Blockchain.html#add_new_block_to_env"><span class="id" title="definition">add_new_block_to_env</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#header:225"><span class="id" title="variable">header</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#prev_bstate:221"><span class="id" title="variable">prev_bstate</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#ChainStep:223"><span class="id" title="inductive">ChainStep</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#prev_bstate:221"><span class="id" title="variable">prev_bstate</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#next_bstate:222"><span class="id" title="variable">next_bstate</span></a><br/>
| <a id="step_action" class="idref" href="#step_action"><span class="id" title="constructor">step_action</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">forall</span> (<a id="act:226" class="idref" href="#act:226"><span class="id" title="binder">act</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Action"><span class="id" title="record">Action</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="acts:227" class="idref" href="#acts:227"><span class="id" title="binder">acts</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Action"><span class="id" title="record">Action</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="new_acts:228" class="idref" href="#new_acts:228"><span class="id" title="binder">new_acts</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Action"><span class="id" title="record">Action</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#chain_state_queue"><span class="id" title="projection">chain_state_queue</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#prev_bstate:221"><span class="id" title="variable">prev_bstate</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#act:226"><span class="id" title="variable">act</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#::list_scope:x_'::'_x"><span class="id" title="notation">::</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#acts:227"><span class="id" title="variable">acts</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#ActionEvaluation"><span class="id" title="inductive">ActionEvaluation</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#prev_bstate:221"><span class="id" title="variable">prev_bstate</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#act:226"><span class="id" title="variable">act</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#next_bstate:222"><span class="id" title="variable">next_bstate</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#new_acts:228"><span class="id" title="variable">new_acts</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#chain_state_queue"><span class="id" title="projection">chain_state_queue</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#next_bstate:222"><span class="id" title="variable">next_bstate</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#new_acts:228"><span class="id" title="variable">new_acts</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#bc347c51eaf667706ae54503b26d52c6"><span class="id" title="notation">++</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#acts:227"><span class="id" title="variable">acts</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#ChainStep:223"><span class="id" title="inductive">ChainStep</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#prev_bstate:221"><span class="id" title="variable">prev_bstate</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#next_bstate:222"><span class="id" title="variable">next_bstate</span></a><br/>
| <a id="step_action_invalid" class="idref" href="#step_action_invalid"><span class="id" title="constructor">step_action_invalid</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">forall</span> (<a id="act:229" class="idref" href="#act:229"><span class="id" title="binder">act</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Action"><span class="id" title="record">Action</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="acts:230" class="idref" href="#acts:230"><span class="id" title="binder">acts</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Action"><span class="id" title="record">Action</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#EnvironmentEquiv"><span class="id" title="record">EnvironmentEquiv</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#next_bstate:222"><span class="id" title="variable">next_bstate</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#prev_bstate:221"><span class="id" title="variable">prev_bstate</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#chain_state_queue"><span class="id" title="projection">chain_state_queue</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#prev_bstate:221"><span class="id" title="variable">prev_bstate</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#act:229"><span class="id" title="variable">act</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#::list_scope:x_'::'_x"><span class="id" title="notation">::</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#acts:230"><span class="id" title="variable">acts</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#chain_state_queue"><span class="id" title="projection">chain_state_queue</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#next_bstate:222"><span class="id" title="variable">next_bstate</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#acts:230"><span class="id" title="variable">acts</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#act_is_from_account"><span class="id" title="definition">act_is_from_account</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#act:229"><span class="id" title="variable">act</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">(</span></a><span class="id" title="keyword">forall</span> <a id="bstate:231" class="idref" href="#bstate:231"><span class="id" title="binder">bstate</span></a> <a id="new_acts:232" class="idref" href="#new_acts:232"><span class="id" title="binder">new_acts</span></a>, <a class="idref" href="ConCert.Execution.Blockchain.html#ActionEvaluation"><span class="id" title="inductive">ActionEvaluation</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#prev_bstate:221"><span class="id" title="variable">prev_bstate</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#act:229"><span class="id" title="variable">act</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#bstate:231"><span class="id" title="variable">bstate</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#new_acts:232"><span class="id" title="variable">new_acts</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#False"><span class="id" title="inductive">False</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#ChainStep:223"><span class="id" title="inductive">ChainStep</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#prev_bstate:221"><span class="id" title="variable">prev_bstate</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#next_bstate:222"><span class="id" title="variable">next_bstate</span></a><br/>
| <a id="step_permute" class="idref" href="#step_permute"><span class="id" title="constructor">step_permute</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#EnvironmentEquiv"><span class="id" title="record">EnvironmentEquiv</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#next_bstate:222"><span class="id" title="variable">next_bstate</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#prev_bstate:221"><span class="id" title="variable">prev_bstate</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Sorting.Permutation.html#Permutation"><span class="id" title="inductive">Permutation</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#chain_state_queue"><span class="id" title="projection">chain_state_queue</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#prev_bstate:221"><span class="id" title="variable">prev_bstate</span></a>) (<a class="idref" href="ConCert.Execution.Blockchain.html#chain_state_queue"><span class="id" title="projection">chain_state_queue</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#next_bstate:222"><span class="id" title="variable">next_bstate</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#ChainStep:223"><span class="id" title="inductive">ChainStep</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#prev_bstate:221"><span class="id" title="variable">prev_bstate</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#next_bstate:222"><span class="id" title="variable">next_bstate</span></a>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="origin_is_account" class="idref" href="#origin_is_account"><span class="id" title="lemma">origin_is_account</span></a> <a id="acts:233" class="idref" href="#acts:233"><span class="id" title="binder">acts</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Lists.List.html#Forall"><span class="id" title="inductive">Forall</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#act_is_from_account"><span class="id" title="definition">act_is_from_account</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#acts:233"><span class="id" title="variable">acts</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Lists.List.html#Forall"><span class="id" title="inductive">Forall</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#act_origin_is_eq_from"><span class="id" title="definition">act_origin_is_eq_from</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#acts:233"><span class="id" title="variable">acts</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Lists.List.html#Forall"><span class="id" title="inductive">Forall</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#act_origin_is_account"><span class="id" title="definition">act_origin_is_account</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#acts:233"><span class="id" title="variable">acts</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">Hall</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">Hall</span> <span class="id" title="keyword">as</span> [| <span class="id" title="var">a</span> <span class="id" title="var">Ha</span>];<span class="id" title="tactic">intros</span> <span class="id" title="var">Hall0</span>;<span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">Hall0</span>;<span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">constructor</span>;<span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#address_eqb_spec"><span class="id" title="method">address_eqb_spec</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#act_origin"><span class="id" title="projection">act_origin</span></a> <span class="id" title="var">a</span>) (<a class="idref" href="ConCert.Execution.Blockchain.html#act_from"><span class="id" title="projection">act_from</span></a> <span class="id" title="var">a</span>)) <span class="id" title="keyword">as</span> <span class="id" title="var">Haddr</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="ConCert.Execution.Blockchain.html#act_origin_is_eq_from"><span class="id" title="definition">act_origin_is_eq_from</span></a> <span class="id" title="tactic">in</span> *; <span class="id" title="tactic">destruct</span> <span class="id" title="var">Haddr</span>;<span class="id" title="var">easy</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="empty_state" class="idref" href="#empty_state"><span class="id" title="definition">empty_state</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#ChainState"><span class="id" title="record">ChainState</span></a> :=<br/>
&nbsp;&nbsp;{| <a class="idref" href="ConCert.Execution.Blockchain.html#chain_state_env"><span class="id" title="projection">chain_state_env</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{| <a class="idref" href="ConCert.Execution.Blockchain.html#env_chain"><span class="id" title="projection">env_chain</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{| <a class="idref" href="ConCert.Execution.Blockchain.html#chain_height"><span class="id" title="projection">chain_height</span></a> := 0;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#current_slot"><span class="id" title="projection">current_slot</span></a> := 0;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#finalized_height"><span class="id" title="projection">finalized_height</span></a> := 0; |};<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#env_account_balances"><span class="id" title="projection">env_account_balances</span></a> <a id="a:234" class="idref" href="#a:234"><span class="id" title="binder">a</span></a> := 0%<span class="id" title="var">Z</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#env_contract_states"><span class="id" title="projection">env_contract_states</span></a> <a id="a:236" class="idref" href="#a:236"><span class="id" title="binder">a</span></a> := <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#env_contracts"><span class="id" title="projection">env_contracts</span></a> <a id="a:235" class="idref" href="#a:235"><span class="id" title="binder">a</span></a> := <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a>; |};<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#chain_state_queue"><span class="id" title="projection">chain_state_queue</span></a> := <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a> |}.<br/>

<br/>
<span class="comment">(*&nbsp;The&nbsp;ChainTrace&nbsp;captures&nbsp;that&nbsp;there&nbsp;is&nbsp;a&nbsp;valid&nbsp;execution&nbsp;where,<br/>
starting&nbsp;from&nbsp;one&nbsp;environment&nbsp;and&nbsp;queue&nbsp;of&nbsp;actions,&nbsp;we&nbsp;end&nbsp;up&nbsp;in&nbsp;a<br/>
different&nbsp;environment&nbsp;and&nbsp;queue&nbsp;of&nbsp;actions.&nbsp;*)</span><br/>
<span class="id" title="keyword">Definition</span> <a id="ChainTrace" class="idref" href="#ChainTrace"><span class="id" title="definition">ChainTrace</span></a> := <a class="idref" href="ConCert.Execution.ChainedList.html#ChainedList"><span class="id" title="inductive">ChainedList</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ChainState"><span class="id" title="record">ChainState</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ChainStep"><span class="id" title="inductive">ChainStep</span></a>.<br/>

<br/>
<span class="comment">(*&nbsp;Additionally,&nbsp;a&nbsp;state&nbsp;is&nbsp;reachable&nbsp;if&nbsp;there&nbsp;is&nbsp;a&nbsp;trace&nbsp;ending&nbsp;in&nbsp;this&nbsp;trace.&nbsp;*)</span><br/>
<span class="id" title="keyword">Definition</span> <a id="reachable" class="idref" href="#reachable"><span class="id" title="definition">reachable</span></a> (<a id="state:237" class="idref" href="#state:237"><span class="id" title="binder">state</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#ChainState"><span class="id" title="record">ChainState</span></a>) : <span class="id" title="keyword">Prop</span> :=<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#inhabited"><span class="id" title="inductive">inhabited</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#ChainTrace"><span class="id" title="definition">ChainTrace</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#empty_state"><span class="id" title="definition">empty_state</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#state:237"><span class="id" title="variable">state</span></a>).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="outgoing_acts" class="idref" href="#outgoing_acts"><span class="id" title="definition">outgoing_acts</span></a> (<a id="state:238" class="idref" href="#state:238"><span class="id" title="binder">state</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#ChainState"><span class="id" title="record">ChainState</span></a>) (<a id="addr:239" class="idref" href="#addr:239"><span class="id" title="binder">addr</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a>) : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ActionBody"><span class="id" title="inductive">ActionBody</span></a> :=<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Lists.List.html#map"><span class="id" title="definition">map</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#act_body"><span class="id" title="projection">act_body</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Lists.List.html#filter"><span class="id" title="definition">filter</span></a> (<span class="id" title="keyword">fun</span> <a id="act:240" class="idref" href="#act:240"><span class="id" title="binder">act</span></a> =&gt; (<a class="idref" href="ConCert.Execution.Blockchain.html#act_from"><span class="id" title="projection">act_from</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#act:240"><span class="id" title="variable">act</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#6f617e0e5500b437e5aeb1eaa876d41f"><span class="id" title="notation">=?</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#addr:239"><span class="id" title="variable">addr</span></a>)%<span class="id" title="var">address</span>) (<a class="idref" href="ConCert.Execution.Blockchain.html#chain_state_queue"><span class="id" title="projection">chain_state_queue</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#state:238"><span class="id" title="variable">state</span></a>)).<br/>

<br/>
<span class="comment">(*&nbsp;We&nbsp;define&nbsp;a&nbsp;transaction&nbsp;as&nbsp;a&nbsp;"fully&nbsp;specified"&nbsp;action,&nbsp;recording&nbsp;all&nbsp;info.&nbsp;For<br/>
example,&nbsp;a&nbsp;transaction&nbsp;contains&nbsp;the&nbsp;contract&nbsp;address&nbsp;that&nbsp;was&nbsp;created&nbsp;when&nbsp;a&nbsp;contract<br/>
is&nbsp;deployed.&nbsp;This&nbsp;is&nbsp;more&nbsp;about&nbsp;bridging&nbsp;the&nbsp;gap&nbsp;between&nbsp;our&nbsp;definitions&nbsp;and&nbsp;what<br/>
a&nbsp;normal&nbsp;blockchain&nbsp;is.&nbsp;Each&nbsp;evaluation&nbsp;of&nbsp;an&nbsp;action&nbsp;in&nbsp;the&nbsp;blockchain&nbsp;corresponds&nbsp;to<br/>
a&nbsp;transaction,&nbsp;so&nbsp;we&nbsp;can&nbsp;go&nbsp;from&nbsp;a&nbsp;trace&nbsp;to&nbsp;a&nbsp;list&nbsp;of&nbsp;transactions.&nbsp;*)</span><br/>
<span class="id" title="keyword">Inductive</span> <a id="TxBody" class="idref" href="#TxBody"><span class="id" title="inductive">TxBody</span></a> :=<br/>
&nbsp;&nbsp;| <a id="tx_empty" class="idref" href="#tx_empty"><span class="id" title="constructor">tx_empty</span></a><br/>
&nbsp;&nbsp;| <a id="tx_deploy" class="idref" href="#tx_deploy"><span class="id" title="constructor">tx_deploy</span></a> (<a id="wc:243" class="idref" href="#wc:243"><span class="id" title="binder">wc</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#WeakContract"><span class="id" title="inductive">WeakContract</span></a>) (<a id="setup:244" class="idref" href="#setup:244"><span class="id" title="binder">setup</span></a> : <a class="idref" href="ConCert.Execution.Serializable.html#SerializedValue"><span class="id" title="record">SerializedValue</span></a>)<br/>
&nbsp;&nbsp;| <a id="tx_call" class="idref" href="#tx_call"><span class="id" title="constructor">tx_call</span></a> (<a id="msg:245" class="idref" href="#msg:245"><span class="id" title="binder">msg</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="ConCert.Execution.Serializable.html#SerializedValue"><span class="id" title="record">SerializedValue</span></a>).<br/>

<br/>
<span class="id" title="keyword">Record</span> <a id="Tx" class="idref" href="#Tx"><span class="id" title="record">Tx</span></a> :=<br/>
&nbsp;&nbsp;<a id="build_tx" class="idref" href="#build_tx"><span class="id" title="constructor">build_tx</span></a> {<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a id="tx_origin" class="idref" href="#tx_origin"><span class="id" title="projection">tx_origin</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a id="tx_from" class="idref" href="#tx_from"><span class="id" title="projection">tx_from</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a id="tx_to" class="idref" href="#tx_to"><span class="id" title="projection">tx_to</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a id="tx_amount" class="idref" href="#tx_amount"><span class="id" title="projection">tx_amount</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Amount"><span class="id" title="definition">Amount</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a id="tx_body" class="idref" href="#tx_body"><span class="id" title="projection">tx_body</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#TxBody"><span class="id" title="inductive">TxBody</span></a>;<br/>
&nbsp;&nbsp;}.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="eval_tx" class="idref" href="#eval_tx"><span class="id" title="definition">eval_tx</span></a> {<a id="pre:252" class="idref" href="#pre:252"><span class="id" title="binder">pre</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Environment"><span class="id" title="record">Environment</span></a>} {<a id="act:253" class="idref" href="#act:253"><span class="id" title="binder">act</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Action"><span class="id" title="record">Action</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<a id="post:254" class="idref" href="#post:254"><span class="id" title="binder">post</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Environment"><span class="id" title="record">Environment</span></a>} {<a id="new_acts:255" class="idref" href="#new_acts:255"><span class="id" title="binder">new_acts</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Action"><span class="id" title="record">Action</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="step:256" class="idref" href="#step:256"><span class="id" title="binder">step</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#ActionEvaluation"><span class="id" title="inductive">ActionEvaluation</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#pre:252"><span class="id" title="variable">pre</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#act:253"><span class="id" title="variable">act</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#post:254"><span class="id" title="variable">post</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#new_acts:255"><span class="id" title="variable">new_acts</span></a>) : <a class="idref" href="ConCert.Execution.Blockchain.html#Tx"><span class="id" title="record">Tx</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="ConCert.Execution.Blockchain.html#step:256"><span class="id" title="variable">step</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="ConCert.Execution.Blockchain.html#eval_transfer"><span class="id" title="constructor">eval_transfer</span></a> <span class="id" title="var">origin</span> <span class="id" title="var">from</span> <span class="id" title="var">to</span> <span class="id" title="var">amount</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#build_tx"><span class="id" title="constructor">build_tx</span></a> <span class="id" title="var">origin</span> <span class="id" title="var">from</span> <span class="id" title="var">to</span> <span class="id" title="var">amount</span> <a class="idref" href="ConCert.Execution.Blockchain.html#tx_empty"><span class="id" title="constructor">tx_empty</span></a><br/>
&nbsp;&nbsp;| <a class="idref" href="ConCert.Execution.Blockchain.html#eval_deploy"><span class="id" title="constructor">eval_deploy</span></a> <span class="id" title="var">origin</span> <span class="id" title="var">from</span> <span class="id" title="var">to</span> <span class="id" title="var">amount</span> <span class="id" title="var">wc</span> <span class="id" title="var">setup</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#build_tx"><span class="id" title="constructor">build_tx</span></a> <span class="id" title="var">origin</span> <span class="id" title="var">from</span> <span class="id" title="var">to</span> <span class="id" title="var">amount</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#tx_deploy"><span class="id" title="constructor">tx_deploy</span></a> <span class="id" title="var">wc</span> <span class="id" title="var">setup</span>)<br/>
&nbsp;&nbsp;| <a class="idref" href="ConCert.Execution.Blockchain.html#eval_call"><span class="id" title="constructor">eval_call</span></a> <span class="id" title="var">origin</span> <span class="id" title="var">from</span> <span class="id" title="var">to</span> <span class="id" title="var">amount</span> <span class="id" title="var">_</span> <span class="id" title="var">msg</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#build_tx"><span class="id" title="constructor">build_tx</span></a> <span class="id" title="var">origin</span> <span class="id" title="var">from</span> <span class="id" title="var">to</span> <span class="id" title="var">amount</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#tx_call"><span class="id" title="constructor">tx_call</span></a> <span class="id" title="var">msg</span>)<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Fixpoint</span> <a id="trace_txs" class="idref" href="#trace_txs"><span class="id" title="definition">trace_txs</span></a> {<a id="from:258" class="idref" href="#from:258"><span class="id" title="binder">from</span></a> <a id="to:259" class="idref" href="#to:259"><span class="id" title="binder">to</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#ChainState"><span class="id" title="record">ChainState</span></a>} (<a id="trace:260" class="idref" href="#trace:260"><span class="id" title="binder">trace</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#ChainTrace"><span class="id" title="definition">ChainTrace</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#from:258"><span class="id" title="variable">from</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#to:259"><span class="id" title="variable">to</span></a>) : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Tx"><span class="id" title="record">Tx</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="ConCert.Execution.Blockchain.html#trace:260"><span class="id" title="variable">trace</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="ConCert.Execution.ChainedList.html#snoc"><span class="id" title="constructor">snoc</span></a> <span class="id" title="var">trace'</span> <span class="id" title="var">step</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">step</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="ConCert.Execution.Blockchain.html#step_action"><span class="id" title="constructor">step_action</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="tactic">eval</span> <span class="id" title="var">_</span> =&gt; <a class="idref" href="ConCert.Execution.Blockchain.html#eval_tx"><span class="id" title="definition">eval_tx</span></a> <span class="id" title="tactic">eval</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#::list_scope:x_'::'_x"><span class="id" title="notation">::</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#trace_txs:261"><span class="id" title="definition">trace_txs</span></a> <span class="id" title="var">trace'</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <a class="idref" href="ConCert.Execution.Blockchain.html#trace_txs:261"><span class="id" title="definition">trace_txs</span></a> <span class="id" title="var">trace'</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="incoming_txs" class="idref" href="#incoming_txs"><span class="id" title="definition">incoming_txs</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<a id="from:264" class="idref" href="#from:264"><span class="id" title="binder">from</span></a> <a id="to:265" class="idref" href="#to:265"><span class="id" title="binder">to</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#ChainState"><span class="id" title="record">ChainState</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="trace:266" class="idref" href="#trace:266"><span class="id" title="binder">trace</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#ChainTrace"><span class="id" title="definition">ChainTrace</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#from:264"><span class="id" title="variable">from</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#to:265"><span class="id" title="variable">to</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="addr:267" class="idref" href="#addr:267"><span class="id" title="binder">addr</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a>) : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Tx"><span class="id" title="record">Tx</span></a> :=<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Lists.List.html#filter"><span class="id" title="definition">filter</span></a> (<span class="id" title="keyword">fun</span> <a id="tx:268" class="idref" href="#tx:268"><span class="id" title="binder">tx</span></a> =&gt; (<a class="idref" href="ConCert.Execution.Blockchain.html#tx_to"><span class="id" title="projection">tx_to</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#tx:268"><span class="id" title="variable">tx</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#6f617e0e5500b437e5aeb1eaa876d41f"><span class="id" title="notation">=?</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#addr:267"><span class="id" title="variable">addr</span></a>)%<span class="id" title="var">address</span>) (<a class="idref" href="ConCert.Execution.Blockchain.html#trace_txs"><span class="id" title="definition">trace_txs</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#trace:266"><span class="id" title="variable">trace</span></a>).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="outgoing_txs" class="idref" href="#outgoing_txs"><span class="id" title="definition">outgoing_txs</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<a id="from:269" class="idref" href="#from:269"><span class="id" title="binder">from</span></a> <a id="to:270" class="idref" href="#to:270"><span class="id" title="binder">to</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#ChainState"><span class="id" title="record">ChainState</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="trace:271" class="idref" href="#trace:271"><span class="id" title="binder">trace</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#ChainTrace"><span class="id" title="definition">ChainTrace</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#from:269"><span class="id" title="variable">from</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#to:270"><span class="id" title="variable">to</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="addr:272" class="idref" href="#addr:272"><span class="id" title="binder">addr</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a>) : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Tx"><span class="id" title="record">Tx</span></a> :=<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Lists.List.html#filter"><span class="id" title="definition">filter</span></a> (<span class="id" title="keyword">fun</span> <a id="tx:273" class="idref" href="#tx:273"><span class="id" title="binder">tx</span></a> =&gt; (<a class="idref" href="ConCert.Execution.Blockchain.html#tx_from"><span class="id" title="projection">tx_from</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#tx:273"><span class="id" title="variable">tx</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#6f617e0e5500b437e5aeb1eaa876d41f"><span class="id" title="notation">=?</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#addr:272"><span class="id" title="variable">addr</span></a>)%<span class="id" title="var">address</span>) (<a class="idref" href="ConCert.Execution.Blockchain.html#trace_txs"><span class="id" title="definition">trace_txs</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#trace:271"><span class="id" title="variable">trace</span></a>).<br/>

<br/>
<span class="id" title="keyword">Record</span> <a id="ContractCallInfo" class="idref" href="#ContractCallInfo"><span class="id" title="record">ContractCallInfo</span></a> (<a id="Msg:274" class="idref" href="#Msg:274"><span class="id" title="binder">Msg</span></a> : <span class="id" title="keyword">Type</span>) :=<br/>
&nbsp;&nbsp;<a id="build_call_info" class="idref" href="#build_call_info"><span class="id" title="constructor">build_call_info</span></a><br/>
&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a id="call_origin" class="idref" href="#call_origin"><span class="id" title="projection">call_origin</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a id="call_from" class="idref" href="#call_from"><span class="id" title="projection">call_from</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a id="call_amount" class="idref" href="#call_amount"><span class="id" title="projection">call_amount</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Amount"><span class="id" title="definition">Amount</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a id="call_msg" class="idref" href="#call_msg"><span class="id" title="projection">call_msg</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Msg:274"><span class="id" title="variable">Msg</span></a>;<br/>
&nbsp;&nbsp;}.<br/>

<br/>
<span class="id" title="keyword">Global Arguments</span> <a class="idref" href="ConCert.Execution.Blockchain.html#build_call_info"><span class="id" title="constructor">build_call_info</span></a> {<span class="id" title="var">_</span>}.<br/>
<span class="id" title="keyword">Global Arguments</span> <a class="idref" href="ConCert.Execution.Blockchain.html#call_origin"><span class="id" title="projection">call_origin</span></a> {<span class="id" title="var">_</span>}.<br/>
<span class="id" title="keyword">Global Arguments</span> <a class="idref" href="ConCert.Execution.Blockchain.html#call_from"><span class="id" title="projection">call_from</span></a> {<span class="id" title="var">_</span>}.<br/>
<span class="id" title="keyword">Global Arguments</span> <a class="idref" href="ConCert.Execution.Blockchain.html#call_amount"><span class="id" title="projection">call_amount</span></a> {<span class="id" title="var">_</span>}.<br/>
<span class="id" title="keyword">Global Arguments</span> <a class="idref" href="ConCert.Execution.Blockchain.html#call_msg"><span class="id" title="projection">call_msg</span></a> {<span class="id" title="var">_</span>}.<br/>

<br/>
<span class="id" title="keyword">Fixpoint</span> <a id="incoming_calls" class="idref" href="#incoming_calls"><span class="id" title="definition">incoming_calls</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="Msg:280" class="idref" href="#Msg:280"><span class="id" title="binder">Msg</span></a> : <span class="id" title="keyword">Type</span>) `{<a id="H:281" class="idref" href="#H:281"><span class="id" title="binder">Serializable</span></a> <a id="H:281" class="idref" href="#H:281"><span class="id" title="binder">Msg</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<a id="from:282" class="idref" href="#from:282"><span class="id" title="binder">from</span></a> <a id="to:283" class="idref" href="#to:283"><span class="id" title="binder">to</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#ChainState"><span class="id" title="record">ChainState</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="trace:284" class="idref" href="#trace:284"><span class="id" title="binder">trace</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#ChainTrace"><span class="id" title="definition">ChainTrace</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#from:282"><span class="id" title="variable">from</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#to:283"><span class="id" title="variable">to</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="caddr:285" class="idref" href="#caddr:285"><span class="id" title="binder">caddr</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a>) : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#ContractCallInfo"><span class="id" title="record">ContractCallInfo</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Msg:280"><span class="id" title="variable">Msg</span></a>)) :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="ConCert.Execution.Blockchain.html#trace:284"><span class="id" title="variable">trace</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="ConCert.Execution.ChainedList.html#snoc"><span class="id" title="constructor">snoc</span></a> <span class="id" title="var">trace'</span> <span class="id" title="var">step</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">step</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="ConCert.Execution.Blockchain.html#step_action"><span class="id" title="constructor">step_action</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#eval_call"><span class="id" title="constructor">eval_call</span></a> <span class="id" title="var">origin</span> <span class="id" title="var">from</span> <span class="id" title="var">to</span> <span class="id" title="var">amount</span> <span class="id" title="var">_</span> <span class="id" title="var">msg</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) <span class="id" title="var">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">if</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#to:283"><span class="id" title="variable">to</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#6f617e0e5500b437e5aeb1eaa876d41f"><span class="id" title="notation">=?</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#caddr:285"><span class="id" title="variable">caddr</span></a>)%<span class="id" title="var">address</span> <span class="id" title="keyword">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;If&nbsp;there&nbsp;is&nbsp;a&nbsp;message&nbsp;it&nbsp;should&nbsp;deserialize&nbsp;correctly,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;otherwise&nbsp;the&nbsp;entire&nbsp;operation&nbsp;returns&nbsp;None.&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Monads.html#bbeef38f67325be53cb9324ba9182131"><span class="id" title="notation">do</span></a> <a id="hd_msg:290" class="idref" href="#hd_msg:290"><span class="id" title="binder">hd_msg</span></a> <a class="idref" href="ConCert.Execution.Monads.html#bbeef38f67325be53cb9324ba9182131"><span class="id" title="notation">&lt;-</span></a> <span class="id" title="keyword">match</span> <span class="id" title="var">msg</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">msg</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="ConCert.Execution.Serializable.html#deserialize"><span class="id" title="method">deserialize</span></a> <span class="id" title="var">msg</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">msg</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">msg</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><a class="idref" href="ConCert.Execution.Monads.html#bbeef38f67325be53cb9324ba9182131"><span class="id" title="notation">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Monads.html#bbeef38f67325be53cb9324ba9182131"><span class="id" title="notation">do</span></a> <a id="tl:291" class="idref" href="#tl:291"><span class="id" title="binder">tl</span></a> <a class="idref" href="ConCert.Execution.Monads.html#bbeef38f67325be53cb9324ba9182131"><span class="id" title="notation">&lt;-</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#incoming_calls:286"><span class="id" title="definition">incoming_calls</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Msg:280"><span class="id" title="variable">Msg</span></a> <span class="id" title="var">trace'</span> <a class="idref" href="ConCert.Execution.Blockchain.html#caddr:285"><span class="id" title="variable">caddr</span></a><a class="idref" href="ConCert.Execution.Monads.html#bbeef38f67325be53cb9324ba9182131"><span class="id" title="notation">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#build_call_info"><span class="id" title="constructor">build_call_info</span></a> <span class="id" title="var">origin</span> <a class="idref" href="ConCert.Execution.Blockchain.html#from:282"><span class="id" title="variable">from</span></a> <span class="id" title="var">amount</span> <a class="idref" href="ConCert.Execution.Blockchain.html#hd_msg:290"><span class="id" title="variable">hd_msg</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#::list_scope:x_'::'_x"><span class="id" title="notation">::</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#tl:291"><span class="id" title="variable">tl</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">else</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#incoming_calls:286"><span class="id" title="definition">incoming_calls</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Msg:280"><span class="id" title="variable">Msg</span></a> <span class="id" title="var">trace'</span> <a class="idref" href="ConCert.Execution.Blockchain.html#caddr:285"><span class="id" title="variable">caddr</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <a class="idref" href="ConCert.Execution.Blockchain.html#incoming_calls:286"><span class="id" title="definition">incoming_calls</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Msg:280"><span class="id" title="variable">Msg</span></a> <span class="id" title="var">trace'</span> <a class="idref" href="ConCert.Execution.Blockchain.html#caddr:285"><span class="id" title="variable">caddr</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Record</span> <a id="DeploymentInfo" class="idref" href="#DeploymentInfo"><span class="id" title="record">DeploymentInfo</span></a> (<a id="Setup:292" class="idref" href="#Setup:292"><span class="id" title="binder">Setup</span></a> : <span class="id" title="keyword">Type</span>) :=<br/>
&nbsp;&nbsp;<a id="build_deployment_info" class="idref" href="#build_deployment_info"><span class="id" title="constructor">build_deployment_info</span></a><br/>
&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a id="deployment_origin" class="idref" href="#deployment_origin"><span class="id" title="projection">deployment_origin</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a id="deployment_from" class="idref" href="#deployment_from"><span class="id" title="projection">deployment_from</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a id="deployment_amount" class="idref" href="#deployment_amount"><span class="id" title="projection">deployment_amount</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Amount"><span class="id" title="definition">Amount</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a id="deployment_setup" class="idref" href="#deployment_setup"><span class="id" title="projection">deployment_setup</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Setup:292"><span class="id" title="variable">Setup</span></a>;<br/>
&nbsp;&nbsp;}.<br/>

<br/>
<span class="id" title="keyword">Global Arguments</span> <a class="idref" href="ConCert.Execution.Blockchain.html#build_deployment_info"><span class="id" title="constructor">build_deployment_info</span></a> {<span class="id" title="var">_</span>}.<br/>
<span class="id" title="keyword">Global Arguments</span> <a class="idref" href="ConCert.Execution.Blockchain.html#deployment_origin"><span class="id" title="projection">deployment_origin</span></a> {<span class="id" title="var">_</span>}.<br/>
<span class="id" title="keyword">Global Arguments</span> <a class="idref" href="ConCert.Execution.Blockchain.html#deployment_from"><span class="id" title="projection">deployment_from</span></a> {<span class="id" title="var">_</span>}.<br/>
<span class="id" title="keyword">Global Arguments</span> <a class="idref" href="ConCert.Execution.Blockchain.html#deployment_amount"><span class="id" title="projection">deployment_amount</span></a> {<span class="id" title="var">_</span>}.<br/>
<span class="id" title="keyword">Global Arguments</span> <a class="idref" href="ConCert.Execution.Blockchain.html#deployment_setup"><span class="id" title="projection">deployment_setup</span></a> {<span class="id" title="var">_</span>}.<br/>

<br/>
<span class="id" title="keyword">Fixpoint</span> <a id="deployment_info" class="idref" href="#deployment_info"><span class="id" title="definition">deployment_info</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="Setup:298" class="idref" href="#Setup:298"><span class="id" title="binder">Setup</span></a> : <span class="id" title="keyword">Type</span>) `{<a id="H:299" class="idref" href="#H:299"><span class="id" title="binder">Serializable</span></a> <a id="H:299" class="idref" href="#H:299"><span class="id" title="binder">Setup</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<a id="from:300" class="idref" href="#from:300"><span class="id" title="binder">from</span></a> <a id="to:301" class="idref" href="#to:301"><span class="id" title="binder">to</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#ChainState"><span class="id" title="record">ChainState</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="trace:302" class="idref" href="#trace:302"><span class="id" title="binder">trace</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#ChainTrace"><span class="id" title="definition">ChainTrace</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#from:300"><span class="id" title="variable">from</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#to:301"><span class="id" title="variable">to</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="caddr:303" class="idref" href="#caddr:303"><span class="id" title="binder">caddr</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a>) : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#DeploymentInfo"><span class="id" title="record">DeploymentInfo</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Setup:298"><span class="id" title="variable">Setup</span></a>) :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="ConCert.Execution.Blockchain.html#trace:302"><span class="id" title="variable">trace</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="ConCert.Execution.ChainedList.html#snoc"><span class="id" title="constructor">snoc</span></a> <span class="id" title="var">trace'</span> <span class="id" title="var">step</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">step</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="ConCert.Execution.Blockchain.html#step_action"><span class="id" title="constructor">step_action</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#eval_deploy"><span class="id" title="constructor">eval_deploy</span></a> <span class="id" title="var">origin</span> <span class="id" title="var">from</span> <span class="id" title="var">to</span> <span class="id" title="var">amount</span> <span class="id" title="var">_</span> <span class="id" title="var">setup</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) <span class="id" title="var">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">if</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#to:301"><span class="id" title="variable">to</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#6f617e0e5500b437e5aeb1eaa876d41f"><span class="id" title="notation">=?</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#caddr:303"><span class="id" title="variable">caddr</span></a>)%<span class="id" title="var">address</span> <span class="id" title="keyword">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Monads.html#bbeef38f67325be53cb9324ba9182131"><span class="id" title="notation">do</span></a> <a id="setup:307" class="idref" href="#setup:307"><span class="id" title="binder">setup</span></a> <a class="idref" href="ConCert.Execution.Monads.html#bbeef38f67325be53cb9324ba9182131"><span class="id" title="notation">&lt;-</span></a> <a class="idref" href="ConCert.Execution.Serializable.html#deserialize"><span class="id" title="method">deserialize</span></a> <span class="id" title="var">setup</span><a class="idref" href="ConCert.Execution.Monads.html#bbeef38f67325be53cb9324ba9182131"><span class="id" title="notation">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#build_deployment_info"><span class="id" title="constructor">build_deployment_info</span></a> <span class="id" title="var">origin</span> <a class="idref" href="ConCert.Execution.Blockchain.html#from:300"><span class="id" title="variable">from</span></a> <span class="id" title="var">amount</span> <a class="idref" href="ConCert.Execution.Blockchain.html#setup:307"><span class="id" title="variable">setup</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">else</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#deployment_info:304"><span class="id" title="definition">deployment_info</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Setup:298"><span class="id" title="variable">Setup</span></a> <span class="id" title="var">trace'</span> <a class="idref" href="ConCert.Execution.Blockchain.html#caddr:303"><span class="id" title="variable">caddr</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <a class="idref" href="ConCert.Execution.Blockchain.html#deployment_info:304"><span class="id" title="definition">deployment_info</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Setup:298"><span class="id" title="variable">Setup</span></a> <span class="id" title="var">trace'</span> <a class="idref" href="ConCert.Execution.Blockchain.html#caddr:303"><span class="id" title="variable">caddr</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;| <a class="idref" href="ConCert.Execution.ChainedList.html#clnil"><span class="id" title="constructor">clnil</span></a> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Fixpoint</span> <a id="trace_blocks" class="idref" href="#trace_blocks"><span class="id" title="definition">trace_blocks</span></a> {<a id="from:308" class="idref" href="#from:308"><span class="id" title="binder">from</span></a> <a id="to:309" class="idref" href="#to:309"><span class="id" title="binder">to</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#ChainState"><span class="id" title="record">ChainState</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="trace:310" class="idref" href="#trace:310"><span class="id" title="binder">trace</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#ChainTrace"><span class="id" title="definition">ChainTrace</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#from:308"><span class="id" title="variable">from</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#to:309"><span class="id" title="variable">to</span></a>) : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#BlockHeader"><span class="id" title="record">BlockHeader</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="ConCert.Execution.Blockchain.html#trace:310"><span class="id" title="variable">trace</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="ConCert.Execution.ChainedList.html#snoc"><span class="id" title="constructor">snoc</span></a> <span class="id" title="var">trace'</span> <span class="id" title="var">step</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">step</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="ConCert.Execution.Blockchain.html#step_block"><span class="id" title="constructor">step_block</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">header</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">header</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#::list_scope:x_'::'_x"><span class="id" title="notation">::</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#trace_blocks:311"><span class="id" title="definition">trace_blocks</span></a> <span class="id" title="var">trace'</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <a class="idref" href="ConCert.Execution.Blockchain.html#trace_blocks:311"><span class="id" title="definition">trace_blocks</span></a> <span class="id" title="var">trace'</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;| <a class="idref" href="ConCert.Execution.ChainedList.html#clnil"><span class="id" title="constructor">clnil</span></a> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="created_blocks" class="idref" href="#created_blocks"><span class="id" title="definition">created_blocks</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<a id="from:314" class="idref" href="#from:314"><span class="id" title="binder">from</span></a> <a id="to:315" class="idref" href="#to:315"><span class="id" title="binder">to</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#ChainState"><span class="id" title="record">ChainState</span></a>} (<a id="trace:316" class="idref" href="#trace:316"><span class="id" title="binder">trace</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#ChainTrace"><span class="id" title="definition">ChainTrace</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#from:314"><span class="id" title="variable">from</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#to:315"><span class="id" title="variable">to</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="creator:317" class="idref" href="#creator:317"><span class="id" title="binder">creator</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a>) : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#BlockHeader"><span class="id" title="record">BlockHeader</span></a> :=<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Lists.List.html#filter"><span class="id" title="definition">filter</span></a> (<span class="id" title="keyword">fun</span> <a id="b:318" class="idref" href="#b:318"><span class="id" title="binder">b</span></a> =&gt; (<a class="idref" href="ConCert.Execution.Blockchain.html#block_creator"><span class="id" title="projection">block_creator</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#b:318"><span class="id" title="variable">b</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#6f617e0e5500b437e5aeb1eaa876d41f"><span class="id" title="notation">=?</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#creator:317"><span class="id" title="variable">creator</span></a>)%<span class="id" title="var">address</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ConCert.Execution.Blockchain.html#trace_blocks"><span class="id" title="definition">trace_blocks</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#trace:316"><span class="id" title="variable">trace</span></a>).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="is_deploy" class="idref" href="#is_deploy"><span class="id" title="definition">is_deploy</span></a> (<a id="ac:319" class="idref" href="#ac:319"><span class="id" title="binder">ac</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#ActionBody"><span class="id" title="inductive">ActionBody</span></a>) : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#bool"><span class="id" title="inductive">bool</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="ConCert.Execution.Blockchain.html#ac:319"><span class="id" title="variable">ac</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="ConCert.Execution.Blockchain.html#act_transfer"><span class="id" title="constructor">act_transfer</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a><br/>
&nbsp;&nbsp;| <a class="idref" href="ConCert.Execution.Blockchain.html#act_call"><span class="id" title="constructor">act_call</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a><br/>
&nbsp;&nbsp;| <a class="idref" href="ConCert.Execution.Blockchain.html#act_deploy"><span class="id" title="constructor">act_deploy</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="is_call" class="idref" href="#is_call"><span class="id" title="definition">is_call</span></a> (<a id="ac:321" class="idref" href="#ac:321"><span class="id" title="binder">ac</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#ActionBody"><span class="id" title="inductive">ActionBody</span></a>) : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#bool"><span class="id" title="inductive">bool</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="ConCert.Execution.Blockchain.html#ac:321"><span class="id" title="variable">ac</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="ConCert.Execution.Blockchain.html#act_transfer"><span class="id" title="constructor">act_transfer</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a><br/>
&nbsp;&nbsp;| <a class="idref" href="ConCert.Execution.Blockchain.html#act_call"><span class="id" title="constructor">act_call</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a><br/>
&nbsp;&nbsp;| <a class="idref" href="ConCert.Execution.Blockchain.html#act_deploy"><span class="id" title="constructor">act_deploy</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="is_transfer" class="idref" href="#is_transfer"><span class="id" title="definition">is_transfer</span></a> (<a id="ac:323" class="idref" href="#ac:323"><span class="id" title="binder">ac</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#ActionBody"><span class="id" title="inductive">ActionBody</span></a>) : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#bool"><span class="id" title="inductive">bool</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="ConCert.Execution.Blockchain.html#ac:323"><span class="id" title="variable">ac</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="ConCert.Execution.Blockchain.html#act_transfer"><span class="id" title="constructor">act_transfer</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a><br/>
&nbsp;&nbsp;| <a class="idref" href="ConCert.Execution.Blockchain.html#act_call"><span class="id" title="constructor">act_call</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a><br/>
&nbsp;&nbsp;| <a class="idref" href="ConCert.Execution.Blockchain.html#act_deploy"><span class="id" title="constructor">act_deploy</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Section</span> <a id="Blockchain.Semantics.Trace.Theories" class="idref" href="#Blockchain.Semantics.Trace.Theories"><span class="id" title="section">Theories</span></a>.<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">destruct_chain_step</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| [<span class="id" title="var">step</span>: <a class="idref" href="ConCert.Execution.Blockchain.html#ChainStep"><span class="id" title="inductive">ChainStep</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> |- <span class="id" title="var">_</span>] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">step</span> <span class="id" title="keyword">as</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="var">header</span> <span class="id" title="var">queue_prev</span> <span class="id" title="var">valid_header</span> <span class="id" title="var">acts_from_accs</span> <span class="id" title="var">origin_correct</span> <span class="id" title="var">env_eq</span>|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">act</span> <span class="id" title="var">acts</span> <span class="id" title="var">new_acts</span> <span class="id" title="var">queue_prev</span> <span class="id" title="tactic">eval</span> <span class="id" title="var">queue_new</span>|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">act</span> <span class="id" title="var">acts</span> <span class="id" title="var">env_eq</span> <span class="id" title="var">queue_prev</span> <span class="id" title="var">queue_new</span> <span class="id" title="var">act_from_acc</span> <span class="id" title="var">no_eval</span>|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">env_eq</span> <span class="id" title="var">perm</span>]<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">destruct_action_eval</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| [<span class="id" title="tactic">eval</span>: <a class="idref" href="ConCert.Execution.Blockchain.html#ActionEvaluation"><span class="id" title="inductive">ActionEvaluation</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> |- <span class="id" title="var">_</span>] =&gt; <span class="id" title="tactic">destruct</span> <span class="id" title="tactic">eval</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="trace_reachable" class="idref" href="#trace_reachable"><span class="id" title="lemma">trace_reachable</span></a> : <span class="id" title="keyword">forall</span> {<a id="to:325" class="idref" href="#to:325"><span class="id" title="binder">to</span></a>},<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#ChainTrace"><span class="id" title="definition">ChainTrace</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#empty_state"><span class="id" title="definition">empty_state</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#to:325"><span class="id" title="variable">to</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#reachable"><span class="id" title="definition">reachable</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#to:325"><span class="id" title="variable">to</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">constructor</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assumption</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="contract_addr_format" class="idref" href="#contract_addr_format"><span class="id" title="lemma">contract_addr_format</span></a> {<a id="to:326" class="idref" href="#to:326"><span class="id" title="binder">to</span></a>} (<a id="addr:327" class="idref" href="#addr:327"><span class="id" title="binder">addr</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a>) (<a id="wc:328" class="idref" href="#wc:328"><span class="id" title="binder">wc</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#WeakContract"><span class="id" title="inductive">WeakContract</span></a>) :<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#reachable"><span class="id" title="definition">reachable</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#to:326"><span class="id" title="variable">to</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#env_contracts"><span class="id" title="projection">env_contracts</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#to:326"><span class="id" title="variable">to</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#addr:327"><span class="id" title="variable">addr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#wc:328"><span class="id" title="variable">wc</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#address_is_contract"><span class="id" title="method">address_is_contract</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#addr:327"><span class="id" title="variable">addr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> [<span class="id" title="var">trace</span>] <span class="id" title="var">contract_at_addr</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">remember</span> <a class="idref" href="ConCert.Execution.Blockchain.html#empty_state"><span class="id" title="definition">empty_state</span></a> <span class="id" title="var">eqn</span>:<span class="id" title="var">eq</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">trace</span>; <span class="id" title="tactic">rewrite</span> <span class="id" title="var">eq</span> <span class="id" title="tactic">in</span> *; <span class="id" title="tactic">clear</span> <span class="id" title="var">eq</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">destruct_chain_step</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="var">now</span> <span class="id" title="var">rewrite_environment_equiv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">destruct_action_eval</span>; <span class="id" title="var">rewrite_environment_equiv</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="var">destruct_address_eq</span>; <span class="id" title="tactic">subst</span>; <span class="id" title="tactic">auto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="new_acts_no_out_queue" class="idref" href="#new_acts_no_out_queue"><span class="id" title="lemma">new_acts_no_out_queue</span></a> <a id="orig:329" class="idref" href="#orig:329"><span class="id" title="binder">orig</span></a> <a id="addr1:330" class="idref" href="#addr1:330"><span class="id" title="binder">addr1</span></a> <a id="addr2:331" class="idref" href="#addr2:331"><span class="id" title="binder">addr2</span></a> <a id="new_acts:332" class="idref" href="#new_acts:332"><span class="id" title="binder">new_acts</span></a> <a id="resp_acts:333" class="idref" href="#resp_acts:333"><span class="id" title="binder">resp_acts</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#addr1:330"><span class="id" title="variable">addr1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'&lt;&gt;'_x"><span class="id" title="notation">&lt;&gt;</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#addr2:331"><span class="id" title="variable">addr2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#new_acts:332"><span class="id" title="variable">new_acts</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Lists.List.html#map"><span class="id" title="definition">map</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#build_act"><span class="id" title="constructor">build_act</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#orig:329"><span class="id" title="variable">orig</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#addr2:331"><span class="id" title="variable">addr2</span></a>) <a class="idref" href="ConCert.Execution.Blockchain.html#resp_acts:333"><span class="id" title="variable">resp_acts</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Lists.List.html#Forall"><span class="id" title="inductive">Forall</span></a> (<span class="id" title="keyword">fun</span> <a id="a:334" class="idref" href="#a:334"><span class="id" title="binder">a</span></a> =&gt; (<a class="idref" href="ConCert.Execution.Blockchain.html#act_from"><span class="id" title="projection">act_from</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#a:334"><span class="id" title="variable">a</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#6f617e0e5500b437e5aeb1eaa876d41f"><span class="id" title="notation">=?</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#addr1:330"><span class="id" title="variable">addr1</span></a>)%<span class="id" title="var">address</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a>) <a class="idref" href="ConCert.Execution.Blockchain.html#new_acts:332"><span class="id" title="variable">new_acts</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">neq</span> ?; <span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">resp_acts</span>; <span class="id" title="var">cbn</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">constructor</span>; <span class="id" title="var">destruct_address_eq</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="tactic">congruence</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="outgoing_acts_after_block_nil" class="idref" href="#outgoing_acts_after_block_nil"><span class="id" title="lemma">outgoing_acts_after_block_nil</span></a> <a id="bstate:335" class="idref" href="#bstate:335"><span class="id" title="binder">bstate</span></a> <a id="addr:336" class="idref" href="#addr:336"><span class="id" title="binder">addr</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Lists.List.html#Forall"><span class="id" title="inductive">Forall</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#act_is_from_account"><span class="id" title="definition">act_is_from_account</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#chain_state_queue"><span class="id" title="projection">chain_state_queue</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#bstate:335"><span class="id" title="variable">bstate</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#address_is_contract"><span class="id" title="method">address_is_contract</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#addr:336"><span class="id" title="variable">addr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#outgoing_acts"><span class="id" title="definition">outgoing_acts</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#bstate:335"><span class="id" title="variable">bstate</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#addr:336"><span class="id" title="variable">addr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">all</span> <span class="id" title="var">is_contract</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="ConCert.Execution.Blockchain.html#outgoing_acts"><span class="id" title="definition">outgoing_acts</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#chain_state_queue"><span class="id" title="projection">chain_state_queue</span></a> <span class="id" title="var">bstate</span>); <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">inversion_clear</span> <span class="id" title="var">all</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">destruct_address_eq</span>; <span class="id" title="tactic">subst</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="ConCert.Execution.Blockchain.html#act_is_from_account"><span class="id" title="definition">act_is_from_account</span></a> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">congruence</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="outgoing_acts_after_deploy_nil" class="idref" href="#outgoing_acts_after_deploy_nil"><span class="id" title="lemma">outgoing_acts_after_deploy_nil</span></a> <a id="bstate:337" class="idref" href="#bstate:337"><span class="id" title="binder">bstate</span></a> <a id="addr:338" class="idref" href="#addr:338"><span class="id" title="binder">addr</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Lists.List.html#Forall"><span class="id" title="inductive">Forall</span></a> (<span class="id" title="keyword">fun</span> <a id="act:339" class="idref" href="#act:339"><span class="id" title="binder">act</span></a> =&gt; (<a class="idref" href="ConCert.Execution.Blockchain.html#act_from"><span class="id" title="projection">act_from</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#act:339"><span class="id" title="variable">act</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#6f617e0e5500b437e5aeb1eaa876d41f"><span class="id" title="notation">=?</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#addr:338"><span class="id" title="variable">addr</span></a>)%<span class="id" title="var">address</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a>) (<a class="idref" href="ConCert.Execution.Blockchain.html#chain_state_queue"><span class="id" title="projection">chain_state_queue</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#bstate:337"><span class="id" title="variable">bstate</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#outgoing_acts"><span class="id" title="definition">outgoing_acts</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#bstate:337"><span class="id" title="variable">bstate</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#addr:338"><span class="id" title="variable">addr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">all</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="ConCert.Execution.Blockchain.html#outgoing_acts"><span class="id" title="definition">outgoing_acts</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#chain_state_queue"><span class="id" title="projection">chain_state_queue</span></a> <span class="id" title="var">bstate</span>) <span class="id" title="keyword">as</span> [|<span class="id" title="var">hd</span> <span class="id" title="var">tl</span> <span class="id" title="var">IH</span>]; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">inversion_clear</span> <span class="id" title="var">all</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">auto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Local Open</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">address</span>.<br/>
<span class="comment">(*&nbsp;This&nbsp;next&nbsp;lemma&nbsp;shows&nbsp;that&nbsp;any&nbsp;for&nbsp;a&nbsp;full&nbsp;chain&nbsp;trace,<br/>
the&nbsp;ending&nbsp;state&nbsp;will&nbsp;not&nbsp;have&nbsp;any&nbsp;queued&nbsp;actions&nbsp;from<br/>
undeployed&nbsp;contracts.&nbsp;*)</span><br/>
<span class="id" title="keyword">Lemma</span> <a id="undeployed_contract_no_out_queue" class="idref" href="#undeployed_contract_no_out_queue"><span class="id" title="lemma">undeployed_contract_no_out_queue</span></a> <a id="contract:340" class="idref" href="#contract:340"><span class="id" title="binder">contract</span></a> <a id="state:341" class="idref" href="#state:341"><span class="id" title="binder">state</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#reachable"><span class="id" title="definition">reachable</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#state:341"><span class="id" title="variable">state</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#address_is_contract"><span class="id" title="method">address_is_contract</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#contract:340"><span class="id" title="variable">contract</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#env_contracts"><span class="id" title="projection">env_contracts</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#state:341"><span class="id" title="variable">state</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#contract:340"><span class="id" title="variable">contract</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Lists.List.html#Forall"><span class="id" title="inductive">Forall</span></a> (<span class="id" title="keyword">fun</span> <a id="act:342" class="idref" href="#act:342"><span class="id" title="binder">act</span></a> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Execution.Blockchain.html#act_from"><span class="id" title="projection">act_from</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#act:342"><span class="id" title="variable">act</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#6f617e0e5500b437e5aeb1eaa876d41f"><span class="id" title="notation">=?</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#contract:340"><span class="id" title="variable">contract</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a>) (<a class="idref" href="ConCert.Execution.Blockchain.html#chain_state_queue"><span class="id" title="projection">chain_state_queue</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#state:341"><span class="id" title="variable">state</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> [<span class="id" title="var">trace</span>] <span class="id" title="var">is_contract</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">remember</span> <a class="idref" href="ConCert.Execution.Blockchain.html#empty_state"><span class="id" title="definition">empty_state</span></a> <span class="id" title="var">eqn</span>:<span class="id" title="var">eq</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">trace</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">undeployed</span>; <span class="id" title="tactic">rewrite</span> <span class="id" title="var">eq</span> <span class="id" title="tactic">in</span> *; <span class="id" title="tactic">clear</span> <span class="id" title="var">eq</span>; <span class="id" title="var">cbn</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">destruct_chain_step</span>; [|<span class="id" title="var">destruct_action_eval</span>| |];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="var">rewrite_environment_equiv</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">repeat</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [<span class="id" title="var">H</span>: <a class="idref" href="ConCert.Execution.Blockchain.html#chain_state_queue"><span class="id" title="projection">chain_state_queue</span></a> <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="var">_</span> |- <span class="id" title="var">_</span>] =&gt; <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H</span> <span class="id" title="tactic">in</span> *; <span class="id" title="tactic">clear</span> <span class="id" title="var">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">subst</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;New&nbsp;block&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| [<span class="id" title="var">H</span>: <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Lists.List.html#Forall"><span class="id" title="inductive">Forall</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#act_is_from_account"><span class="id" title="definition">act_is_from_account</span></a> <span class="id" title="var">_</span> |- <span class="id" title="var">_</span>] =&gt; <span class="id" title="tactic">induction</span> <span class="id" title="var">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| [<span class="id" title="var">H</span>: <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Lists.List.html#Forall"><span class="id" title="inductive">Forall</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#act_origin_is_eq_from"><span class="id" title="definition">act_origin_is_eq_from</span></a> <span class="id" title="var">_</span> |- <span class="id" title="var">_</span>] =&gt; <span class="id" title="tactic">inversion</span> <span class="id" title="var">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>; <span class="id" title="tactic">constructor</span>; <span class="id" title="tactic">auto</span>; <span class="id" title="var">destruct_address_eq</span>; <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;Transfer&nbsp;step,&nbsp;just&nbsp;use&nbsp;IH&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp/stdpp.list.html#Forall_cons"><span class="id" title="lemma">list.Forall_cons</span></a>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;Deploy&nbsp;step.&nbsp;First&nbsp;show&nbsp;that&nbsp;it&nbsp;is&nbsp;not&nbsp;to&nbsp;contract&nbsp;and&nbsp;then&nbsp;use&nbsp;IH.&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">destruct_address_eq</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp/stdpp.list.html#Forall_cons"><span class="id" title="lemma">list.Forall_cons</span></a>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;Call.&nbsp;Show&nbsp;that&nbsp;it&nbsp;holds&nbsp;for&nbsp;new&nbsp;actions&nbsp;as&nbsp;it&nbsp;is&nbsp;from&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;another&nbsp;contract,&nbsp;and&nbsp;use&nbsp;IH&nbsp;for&nbsp;remaining.&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp/stdpp.list.html#Forall_app"><span class="id" title="lemma">list.Forall_app</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">contract</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'&lt;&gt;'_x"><span class="id" title="notation">&lt;&gt;</span></a> <span class="id" title="var">to_addr</span>) <span class="id" title="tactic">by</span> <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; [<span class="id" title="tactic">eapply</span> <a class="idref" href="ConCert.Execution.Blockchain.html#new_acts_no_out_queue"><span class="id" title="lemma">new_acts_no_out_queue</span></a>|<span class="id" title="tactic">eapply</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp/stdpp.list.html#Forall_cons"><span class="id" title="lemma">list.Forall_cons</span></a>]; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;Invalid&nbsp;User&nbsp;Action&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Lists.List.html#Forall_inv_tail"><span class="id" title="lemma">Forall_inv_tail</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">IHtrace</span>.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;Permutation&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">specialize_hypotheses</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">perm</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Local Hint Resolve</span> <span class="id" title="var">contracts_post_pre_none</span> : <span class="id" title="var">core</span>.<br/>
<span class="id" title="keyword">Local Hint Unfold</span> <a class="idref" href="ConCert.Execution.Blockchain.html#reachable"><span class="id" title="definition">reachable</span></a> : <span class="id" title="var">core</span>.<br/>

<br/>
<span class="comment">(*&nbsp;With&nbsp;this&nbsp;lemma&nbsp;proven,&nbsp;we&nbsp;can&nbsp;show&nbsp;that&nbsp;the&nbsp;(perhaps&nbsp;seemingly&nbsp;stronger)<br/>
fact,&nbsp;that&nbsp;an&nbsp;undeployed&nbsp;contract&nbsp;has&nbsp;no&nbsp;outgoing&nbsp;txs,&nbsp;holds.&nbsp;*)</span><br/>
<span class="id" title="keyword">Lemma</span> <a id="undeployed_contract_no_out_txs" class="idref" href="#undeployed_contract_no_out_txs"><span class="id" title="lemma">undeployed_contract_no_out_txs</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a id="contract:343" class="idref" href="#contract:343"><span class="id" title="binder">contract</span></a> <a id="state:344" class="idref" href="#state:344"><span class="id" title="binder">state</span></a> (<a id="trace:345" class="idref" href="#trace:345"><span class="id" title="binder">trace</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#ChainTrace"><span class="id" title="definition">ChainTrace</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#empty_state"><span class="id" title="definition">empty_state</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#state:344"><span class="id" title="variable">state</span></a>) :<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#address_is_contract"><span class="id" title="method">address_is_contract</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#contract:343"><span class="id" title="variable">contract</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#env_contracts"><span class="id" title="projection">env_contracts</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#state:344"><span class="id" title="variable">state</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#contract:343"><span class="id" title="variable">contract</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#outgoing_txs"><span class="id" title="definition">outgoing_txs</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#trace:345"><span class="id" title="variable">trace</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#contract:343"><span class="id" title="variable">contract</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">is_contract</span> <span class="id" title="var">undeployed</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">remember</span> <a class="idref" href="ConCert.Execution.Blockchain.html#empty_state"><span class="id" title="definition">empty_state</span></a>; <span class="id" title="tactic">induction</span> <span class="id" title="var">trace</span>; <span class="id" title="tactic">subst</span>; <span class="id" title="var">cbn</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">destruct_chain_step</span>; <span class="id" title="tactic">try</span> <span class="id" title="var">now</span> <span class="id" title="var">rewrite_environment_equiv</span>.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;In&nbsp;these&nbsp;steps&nbsp;we&nbsp;will&nbsp;use&nbsp;that&nbsp;the&nbsp;queue&nbsp;did&nbsp;not&nbsp;contain&nbsp;txs&nbsp;to&nbsp;the&nbsp;contract.&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ConCert.Execution.Blockchain.html#undeployed_contract_no_out_queue"><span class="id" title="lemma">undeployed_contract_no_out_queue</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">contract</span> <span class="id" title="var">mid</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">ltac</span>:(<span class="id" title="tactic">auto</span>) <span class="id" title="keyword">ltac</span>:(<span class="id" title="tactic">auto</span>) <span class="id" title="keyword">ltac</span>:(<span class="id" title="tactic">eauto</span>)) <span class="id" title="keyword">as</span> <span class="id" title="var">Hqueue</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">repeat</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [<span class="id" title="var">H</span>: <a class="idref" href="ConCert.Execution.Blockchain.html#chain_state_queue"><span class="id" title="projection">chain_state_queue</span></a> <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="var">_</span> |- <span class="id" title="var">_</span>] =&gt; <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H</span> <span class="id" title="tactic">in</span> *; <span class="id" title="tactic">clear</span> <span class="id" title="var">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion_clear</span> <span class="id" title="var">Hqueue</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">act</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">destruct_action_eval</span>; <span class="id" title="var">rewrite_environment_equiv</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">subst</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">destruct_address_eq</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="tactic">tauto</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="undeployed_contract_no_in_txs" class="idref" href="#undeployed_contract_no_in_txs"><span class="id" title="lemma">undeployed_contract_no_in_txs</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a id="contract:346" class="idref" href="#contract:346"><span class="id" title="binder">contract</span></a> <a id="state:347" class="idref" href="#state:347"><span class="id" title="binder">state</span></a> (<a id="trace:348" class="idref" href="#trace:348"><span class="id" title="binder">trace</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#ChainTrace"><span class="id" title="definition">ChainTrace</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#empty_state"><span class="id" title="definition">empty_state</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#state:347"><span class="id" title="variable">state</span></a>) :<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#address_is_contract"><span class="id" title="method">address_is_contract</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#contract:346"><span class="id" title="variable">contract</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#env_contracts"><span class="id" title="projection">env_contracts</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#state:347"><span class="id" title="variable">state</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#contract:346"><span class="id" title="variable">contract</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#incoming_txs"><span class="id" title="definition">incoming_txs</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#trace:348"><span class="id" title="variable">trace</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#contract:346"><span class="id" title="variable">contract</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">is_contract</span> <span class="id" title="var">undeployed</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">remember</span> <a class="idref" href="ConCert.Execution.Blockchain.html#empty_state"><span class="id" title="definition">empty_state</span></a>; <span class="id" title="tactic">induction</span> <span class="id" title="var">trace</span>; <span class="id" title="tactic">subst</span>; <span class="id" title="var">cbn</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">destruct_chain_step</span>; <span class="id" title="tactic">try</span> <span class="id" title="var">now</span> <span class="id" title="var">rewrite_environment_equiv</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">destruct_action_eval</span>; <span class="id" title="var">rewrite_environment_equiv</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">destruct_address_eq</span>; <span class="id" title="tactic">auto</span>; <span class="id" title="tactic">subst</span>; <span class="id" title="tactic">congruence</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="deployment_info_some" class="idref" href="#deployment_info_some"><span class="id" title="lemma">deployment_info_some</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a id="Setup:349" class="idref" href="#Setup:349"><span class="id" title="binder">Setup</span></a> `{<a id="H:350" class="idref" href="#H:350"><span class="id" title="binder">Serializable</span></a> <a id="H:350" class="idref" href="#H:350"><span class="id" title="binder">Setup</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<a id="to:351" class="idref" href="#to:351"><span class="id" title="binder">to</span></a>} (<a id="trace:352" class="idref" href="#trace:352"><span class="id" title="binder">trace</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#ChainTrace"><span class="id" title="definition">ChainTrace</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#empty_state"><span class="id" title="definition">empty_state</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#to:351"><span class="id" title="variable">to</span></a>) <a id="caddr:353" class="idref" href="#caddr:353"><span class="id" title="binder">caddr</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#deployment_info"><span class="id" title="definition">deployment_info</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Setup:349"><span class="id" title="variable">Setup</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#trace:352"><span class="id" title="variable">trace</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#caddr:353"><span class="id" title="variable">caddr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'&lt;&gt;'_x"><span class="id" title="notation">&lt;&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#env_contracts"><span class="id" title="projection">env_contracts</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#to:351"><span class="id" title="variable">to</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#caddr:353"><span class="id" title="variable">caddr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'&lt;&gt;'_x"><span class="id" title="notation">&lt;&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">remember</span> <a class="idref" href="ConCert.Execution.Blockchain.html#empty_state"><span class="id" title="definition">empty_state</span></a>; <span class="id" title="tactic">induction</span> <span class="id" title="var">trace</span> <span class="id" title="keyword">as</span> [|? ? ? ? <span class="id" title="var">IH</span>]; <span class="id" title="tactic">subst</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="tactic">try</span> <span class="id" title="tactic">tauto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">destruct_chain_step</span>; <span class="id" title="tactic">try</span> <span class="id" title="var">now</span> <span class="id" title="var">rewrite_environment_equiv</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">destruct_action_eval</span>; <span class="id" title="var">rewrite_environment_equiv</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;Deploy&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#address_eq_sym"><span class="id" title="lemma">address_eq_sym</span></a> <span class="id" title="var">caddr</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">destruct_address_eq</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">auto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="deployment_info_addr_format" class="idref" href="#deployment_info_addr_format"><span class="id" title="lemma">deployment_info_addr_format</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a id="Setup:354" class="idref" href="#Setup:354"><span class="id" title="binder">Setup</span></a> `{<a id="H:355" class="idref" href="#H:355"><span class="id" title="binder">Serializable</span></a> <a id="H:355" class="idref" href="#H:355"><span class="id" title="binder">Setup</span></a>} {<a id="to:356" class="idref" href="#to:356"><span class="id" title="binder">to</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="trace:357" class="idref" href="#trace:357"><span class="id" title="binder">trace</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#ChainTrace"><span class="id" title="definition">ChainTrace</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#empty_state"><span class="id" title="definition">empty_state</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#to:356"><span class="id" title="variable">to</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a id="caddr:358" class="idref" href="#caddr:358"><span class="id" title="binder">caddr</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#deployment_info"><span class="id" title="definition">deployment_info</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Setup:354"><span class="id" title="variable">Setup</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#trace:357"><span class="id" title="variable">trace</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#caddr:358"><span class="id" title="variable">caddr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'&lt;&gt;'_x"><span class="id" title="notation">&lt;&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#address_is_contract"><span class="id" title="method">address_is_contract</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#caddr:358"><span class="id" title="variable">caddr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">has_deployment_info</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#deployment_info_some"><span class="id" title="lemma">deployment_info_some</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">has_deployment_info</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#env_contracts"><span class="id" title="projection">env_contracts</span></a> <span class="id" title="var">to</span> <span class="id" title="var">caddr</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">wc</span>|] <span class="id" title="var">eqn</span>:?; <span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="ConCert.Execution.Blockchain.html#contract_addr_format"><span class="id" title="lemma">contract_addr_format</span></a>; <span class="id" title="tactic">eauto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="incoming_txs_contract" class="idref" href="#incoming_txs_contract"><span class="id" title="lemma">incoming_txs_contract</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a id="caddr:359" class="idref" href="#caddr:359"><span class="id" title="binder">caddr</span></a> <a id="bstate:360" class="idref" href="#bstate:360"><span class="id" title="binder">bstate</span></a> (<a id="trace:361" class="idref" href="#trace:361"><span class="id" title="binder">trace</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#ChainTrace"><span class="id" title="definition">ChainTrace</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#empty_state"><span class="id" title="definition">empty_state</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#bstate:360"><span class="id" title="variable">bstate</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a id="Setup:362" class="idref" href="#Setup:362"><span class="id" title="binder">Setup</span></a> `{<a id="H:363" class="idref" href="#H:363"><span class="id" title="binder">Serializable</span></a> <a id="H:363" class="idref" href="#H:363"><span class="id" title="binder">Setup</span></a>} (<a id="depinfo:364" class="idref" href="#depinfo:364"><span class="id" title="binder">depinfo</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#DeploymentInfo"><span class="id" title="record">DeploymentInfo</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Setup:362"><span class="id" title="variable">Setup</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a id="Msg:365" class="idref" href="#Msg:365"><span class="id" title="binder">Msg</span></a> `{<a id="H0:366" class="idref" href="#H0:366"><span class="id" title="binder">Serializable</span></a> <a id="H0:366" class="idref" href="#H0:366"><span class="id" title="binder">Msg</span></a>} (<a id="msgs:367" class="idref" href="#msgs:367"><span class="id" title="binder">msgs</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#ContractCallInfo"><span class="id" title="record">ContractCallInfo</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Msg:365"><span class="id" title="variable">Msg</span></a>)) :<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#deployment_info"><span class="id" title="definition">deployment_info</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Setup:362"><span class="id" title="variable">Setup</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#trace:361"><span class="id" title="variable">trace</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#caddr:359"><span class="id" title="variable">caddr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#depinfo:364"><span class="id" title="variable">depinfo</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#incoming_calls"><span class="id" title="definition">incoming_calls</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Msg:365"><span class="id" title="variable">Msg</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#trace:361"><span class="id" title="variable">trace</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#caddr:359"><span class="id" title="variable">caddr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#msgs:367"><span class="id" title="variable">msgs</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Lists.List.html#map"><span class="id" title="definition">map</span></a> (<span class="id" title="keyword">fun</span> <a id="tx:368" class="idref" href="#tx:368"><span class="id" title="binder">tx</span></a> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Execution.Blockchain.html#tx_from"><span class="id" title="projection">tx_from</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#tx:368"><span class="id" title="variable">tx</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#tx_to"><span class="id" title="projection">tx_to</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#tx:368"><span class="id" title="variable">tx</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#tx_amount"><span class="id" title="projection">tx_amount</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#tx:368"><span class="id" title="variable">tx</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>) (<a class="idref" href="ConCert.Execution.Blockchain.html#incoming_txs"><span class="id" title="definition">incoming_txs</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#trace:361"><span class="id" title="variable">trace</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#caddr:359"><span class="id" title="variable">caddr</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Lists.List.html#map"><span class="id" title="definition">map</span></a> (<span class="id" title="keyword">fun</span> <a id="call:369" class="idref" href="#call:369"><span class="id" title="binder">call</span></a> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Execution.Blockchain.html#call_from"><span class="id" title="projection">call_from</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#call:369"><span class="id" title="variable">call</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#caddr:359"><span class="id" title="variable">caddr</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#call_amount"><span class="id" title="projection">call_amount</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#call:369"><span class="id" title="variable">call</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>) <a class="idref" href="ConCert.Execution.Blockchain.html#msgs:367"><span class="id" title="variable">msgs</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#bc347c51eaf667706ae54503b26d52c6"><span class="id" title="notation">++</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">[</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Execution.Blockchain.html#deployment_from"><span class="id" title="projection">deployment_from</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#depinfo:364"><span class="id" title="variable">depinfo</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#caddr:359"><span class="id" title="variable">caddr</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#deployment_amount"><span class="id" title="projection">deployment_amount</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#depinfo:364"><span class="id" title="variable">depinfo</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">]</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">depinfo_eq</span> <span class="id" title="var">calls_eq</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">enough</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Execution.Blockchain.html#env_contracts"><span class="id" title="projection">env_contracts</span></a> <span class="id" title="var">bstate</span> <span class="id" title="var">caddr</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#incoming_txs"><span class="id" title="definition">incoming_txs</span></a> <span class="id" title="var">trace</span> <span class="id" title="var">caddr</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#deployment_info"><span class="id" title="definition">deployment_info</span></a> <span class="id" title="var">Setup</span> <span class="id" title="var">trace</span> <span class="id" title="var">caddr</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#incoming_calls"><span class="id" title="definition">incoming_calls</span></a> <span class="id" title="var">Msg</span> <span class="id" title="var">trace</span> <span class="id" title="var">caddr</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Execution.Blockchain.html#env_contracts"><span class="id" title="projection">env_contracts</span></a> <span class="id" title="var">bstate</span> <span class="id" title="var">caddr</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'&lt;&gt;'_x"><span class="id" title="notation">&lt;&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#deployment_info"><span class="id" title="definition">deployment_info</span></a> <span class="id" title="var">Setup</span> <span class="id" title="var">trace</span> <span class="id" title="var">caddr</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'&lt;&gt;'_x"><span class="id" title="notation">&lt;&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#incoming_calls"><span class="id" title="definition">incoming_calls</span></a> <span class="id" title="var">Msg</span> <span class="id" title="var">trace</span> <span class="id" title="var">caddr</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'&lt;&gt;'_x"><span class="id" title="notation">&lt;&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">exists</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">(</span></a><a id="depinfo:376" class="idref" href="#depinfo:376"><span class="id" title="binder">depinfo</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#DeploymentInfo"><span class="id" title="record">DeploymentInfo</span></a> <span class="id" title="var">Setup</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="inc_calls:377" class="idref" href="#inc_calls:377"><span class="id" title="binder">inc_calls</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#ContractCallInfo"><span class="id" title="record">ContractCallInfo</span></a> <span class="id" title="var">Msg</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="call_txs:378" class="idref" href="#call_txs:378"><span class="id" title="binder">call_txs</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Tx"><span class="id" title="record">Tx</span></a>) (<a id="dep_tx:379" class="idref" href="#dep_tx:379"><span class="id" title="binder">dep_tx</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Tx"><span class="id" title="record">Tx</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">),</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#deployment_info"><span class="id" title="definition">deployment_info</span></a> <span class="id" title="var">Setup</span> <span class="id" title="var">trace</span> <span class="id" title="var">caddr</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#depinfo:370"><span class="id" title="variable">depinfo</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#incoming_calls"><span class="id" title="definition">incoming_calls</span></a> <span class="id" title="var">Msg</span> <span class="id" title="var">trace</span> <span class="id" title="var">caddr</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#inc_calls:371"><span class="id" title="variable">inc_calls</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#incoming_txs"><span class="id" title="definition">incoming_txs</span></a> <span class="id" title="var">trace</span> <span class="id" title="var">caddr</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#call_txs:372"><span class="id" title="variable">call_txs</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#bc347c51eaf667706ae54503b26d52c6"><span class="id" title="notation">++</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">[</span></a><a class="idref" href="ConCert.Execution.Blockchain.html#dep_tx:373"><span class="id" title="variable">dep_tx</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">]</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Lists.List.html#map"><span class="id" title="definition">map</span></a> (<span class="id" title="keyword">fun</span> <a id="tx:380" class="idref" href="#tx:380"><span class="id" title="binder">tx</span></a> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Execution.Blockchain.html#tx_from"><span class="id" title="projection">tx_from</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#tx:374"><span class="id" title="variable">tx</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#tx_to"><span class="id" title="projection">tx_to</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#tx:374"><span class="id" title="variable">tx</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#tx_amount"><span class="id" title="projection">tx_amount</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#tx:374"><span class="id" title="variable">tx</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>) <a class="idref" href="ConCert.Execution.Blockchain.html#call_txs:372"><span class="id" title="variable">call_txs</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Lists.List.html#map"><span class="id" title="definition">map</span></a> (<span class="id" title="keyword">fun</span> <a id="call:381" class="idref" href="#call:381"><span class="id" title="binder">call</span></a> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Execution.Blockchain.html#call_from"><span class="id" title="projection">call_from</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#call:375"><span class="id" title="variable">call</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">caddr</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#call_amount"><span class="id" title="projection">call_amount</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#call:375"><span class="id" title="variable">call</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>) <a class="idref" href="ConCert.Execution.Blockchain.html#inc_calls:371"><span class="id" title="variable">inc_calls</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Execution.Blockchain.html#tx_from"><span class="id" title="projection">tx_from</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#dep_tx:373"><span class="id" title="variable">dep_tx</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#tx_to"><span class="id" title="projection">tx_to</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#dep_tx:373"><span class="id" title="variable">dep_tx</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#tx_amount"><span class="id" title="projection">tx_amount</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#dep_tx:373"><span class="id" title="variable">dep_tx</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Execution.Blockchain.html#deployment_from"><span class="id" title="projection">deployment_from</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#depinfo:370"><span class="id" title="variable">depinfo</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">caddr</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#deployment_amount"><span class="id" title="projection">deployment_amount</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#depinfo:370"><span class="id" title="variable">depinfo</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">)</span></a>) <span class="id" title="keyword">as</span> <span class="id" title="var">generalized</span>.<br/>
&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">depinfo_eq</span>, <span class="id" title="var">calls_eq</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#env_contracts"><span class="id" title="projection">env_contracts</span></a> <span class="id" title="var">bstate</span> <span class="id" title="var">caddr</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">generalized</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">_</span> <span class="id" title="var">generalized</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">generalized</span> <span class="id" title="keyword">ltac</span>:(<span class="id" title="tactic">discriminate</span>) <span class="id" title="keyword">ltac</span>:(<span class="id" title="tactic">discriminate</span>) <span class="id" title="keyword">ltac</span>:(<span class="id" title="tactic">discriminate</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">generalized</span> <span class="id" title="keyword">as</span> [? [? [? [? [? [? [-&gt; [? ?]]]]]]]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Lists.List.html#map_app"><span class="id" title="lemma">map_app</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">generalized</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">generalized</span> <span class="id" title="var">_</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">generalized</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#eq_refl"><span class="id" title="constructor">eq_refl</span></a>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">generalized</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">_</span> [? <span class="id" title="var">_</span>]]; <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;}<br/>
<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">is_contract</span>: <a class="idref" href="ConCert.Execution.Blockchain.html#address_is_contract"><span class="id" title="method">address_is_contract</span></a> <span class="id" title="var">caddr</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a>).<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">assert</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#deployment_info"><span class="id" title="definition">deployment_info</span></a> <span class="id" title="var">Setup</span> <span class="id" title="var">trace</span> <span class="id" title="var">caddr</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'&lt;&gt;'_x"><span class="id" title="notation">&lt;&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a>) <span class="id" title="tactic">by</span> <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#deployment_info_addr_format"><span class="id" title="lemma">deployment_info_addr_format</span></a> <span class="id" title="var">Setup</span>); <span class="id" title="var">eassumption</span>. }<br/>
<br/>
&nbsp;&nbsp;<span class="id" title="tactic">clear</span> <span class="id" title="var">depinfo_eq</span> <span class="id" title="var">calls_eq</span> <span class="id" title="var">depinfo</span> <span class="id" title="var">msgs</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="var">remember</span> <a class="idref" href="ConCert.Execution.Blockchain.html#empty_state"><span class="id" title="definition">empty_state</span></a>; <span class="id" title="tactic">induction</span> <span class="id" title="var">trace</span> <span class="id" title="keyword">as</span> [|? ? ? ? <span class="id" title="var">IH</span>]; <span class="id" title="tactic">subst</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="tactic">tauto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">destruct_chain_step</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="tactic">try</span> <span class="id" title="var">now</span> <span class="id" title="var">rewrite_environment_equiv</span>.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;Evaluation&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">destruct_action_eval</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="var">rewrite_environment_equiv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="comment">(*&nbsp;Transfer&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">destruct_address_eq</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="comment">(*&nbsp;Deploy&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#address_eq_sym"><span class="id" title="lemma">address_eq_sym</span></a> <span class="id" title="var">caddr</span>) <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">destruct_address_eq</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">_</span> <span class="id" title="var">depinfo_ne_none</span> <span class="id" title="var">calls_ne_none</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="ConCert.Execution.Serializable.html#deserialize"><span class="id" title="method">deserialize</span></a> <span class="id" title="var">setup</span>); <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">remember</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#build_deployment_info"><span class="id" title="constructor">build_deployment_info</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">depinfo</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">remember</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#build_tx"><span class="id" title="constructor">build_tx</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">deptx</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">IH</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">IH</span> <span class="id" title="var">_</span>]; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">IH</span> <span class="id" title="keyword">ltac</span>:(<span class="id" title="tactic">auto</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">fold</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#incoming_txs"><span class="id" title="definition">incoming_txs</span></a> <span class="id" title="var">trace</span> <span class="id" title="var">caddr</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">IH</span> <span class="id" title="keyword">as</span> [-&gt; [? -&gt;]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exists</span> <span class="id" title="var">depinfo</span>, <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a>, <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a>, <span class="id" title="var">deptx</span>; <span class="id" title="tactic">subst</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="comment">(*&nbsp;Call&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">destruct_address_eq</span>; <span class="id" title="tactic">subst</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; [<span class="id" title="tactic">intros</span>; <span class="id" title="tactic">congruence</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">IH</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">_</span> <span class="id" title="var">IH</span>]; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">_</span> <span class="id" title="var">deploy_info</span> <span class="id" title="var">calls</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="keyword">match</span> <span class="id" title="var">msg</span> <span class="id" title="keyword">with</span> | <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">_</span> | <span class="id" title="var">_</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> <span class="id" title="keyword">end</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#incoming_calls"><span class="id" title="definition">incoming_calls</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">inc_calls</span>|]; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">unshelve</span> <span class="id" title="var">epose</span> <span class="id" title="var">proof</span> (<span class="id" title="var">IH</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">IH</span>; <span class="id" title="tactic">auto</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">IH</span> <span class="id" title="keyword">as</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="var">depinfo</span> [<span class="id" title="var">prev_calls</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="var">prev_call_txs</span> [<span class="id" title="var">dep_tx</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="var">depinfo_eq</span> [<span class="id" title="var">inc_calls_eq</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="var">inc_txs_eq</span> [<span class="id" title="var">map_eq</span> ?]]]]]]]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">remember</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#build_tx"><span class="id" title="constructor">build_tx</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">new_tx</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">remember</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#build_call_info"><span class="id" title="constructor">build_call_info</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">new_call</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exists</span> <span class="id" title="var">depinfo</span>, (<span class="id" title="var">new_call</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#::list_scope:x_'::'_x"><span class="id" title="notation">::</span></a> <span class="id" title="var">inc_calls</span>), (<span class="id" title="var">new_tx</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#::list_scope:x_'::'_x"><span class="id" title="notation">::</span></a> <span class="id" title="var">prev_call_txs</span>), <span class="id" title="var">dep_tx</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">fold</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#incoming_txs"><span class="id" title="definition">incoming_txs</span></a> <span class="id" title="var">trace</span> <span class="id" title="var">caddr</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">inc_txs_eq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; [<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Lists.List.html#app_comm_cons"><span class="id" title="lemma">app_comm_cons</span></a>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion_clear</span> <span class="id" title="var">inc_calls_eq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">map_eq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">subst</span>; <span class="id" title="tactic">tauto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="undeployed_contract_no_in_calls" class="idref" href="#undeployed_contract_no_in_calls"><span class="id" title="lemma">undeployed_contract_no_in_calls</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<a id="Msg:384" class="idref" href="#Msg:384"><span class="id" title="binder">Msg</span></a>} `{<a id="H:385" class="idref" href="#H:385"><span class="id" title="binder">Serializable</span></a> <a id="H:385" class="idref" href="#H:385"><span class="id" title="binder">Msg</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a id="contract:386" class="idref" href="#contract:386"><span class="id" title="binder">contract</span></a> <a id="state:387" class="idref" href="#state:387"><span class="id" title="binder">state</span></a> (<a id="trace:388" class="idref" href="#trace:388"><span class="id" title="binder">trace</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#ChainTrace"><span class="id" title="definition">ChainTrace</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#empty_state"><span class="id" title="definition">empty_state</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#state:387"><span class="id" title="variable">state</span></a>) :<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#env_contracts"><span class="id" title="projection">env_contracts</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#state:387"><span class="id" title="variable">state</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#contract:386"><span class="id" title="variable">contract</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#incoming_calls"><span class="id" title="definition">incoming_calls</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Msg:384"><span class="id" title="variable">Msg</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#trace:388"><span class="id" title="variable">trace</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#contract:386"><span class="id" title="variable">contract</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="ConCert.Execution.Blockchain.html#incoming_calls"><span class="id" title="definition">incoming_calls</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">undeployed</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">remember</span> <a class="idref" href="ConCert.Execution.Blockchain.html#empty_state"><span class="id" title="definition">empty_state</span></a>; <span class="id" title="tactic">induction</span> <span class="id" title="var">trace</span>; <span class="id" title="tactic">subst</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">destruct_chain_step</span>; <span class="id" title="tactic">try</span> <span class="id" title="var">now</span> <span class="id" title="var">rewrite_environment_equiv</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">destruct_action_eval</span>; <span class="id" title="var">rewrite_environment_equiv</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">destruct_address_eq</span>; <span class="id" title="tactic">auto</span>; <span class="id" title="tactic">subst</span>; <span class="id" title="tactic">congruence</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Local Open</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">Z</span>.<br/>
<span class="id" title="keyword">Lemma</span> <a id="account_balance_trace" class="idref" href="#account_balance_trace"><span class="id" title="lemma">account_balance_trace</span></a> <a id="state:389" class="idref" href="#state:389"><span class="id" title="binder">state</span></a> (<a id="trace:390" class="idref" href="#trace:390"><span class="id" title="binder">trace</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#ChainTrace"><span class="id" title="definition">ChainTrace</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#empty_state"><span class="id" title="definition">empty_state</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#state:389"><span class="id" title="variable">state</span></a>) <a id="addr:391" class="idref" href="#addr:391"><span class="id" title="binder">addr</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#env_account_balances"><span class="id" title="projection">env_account_balances</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#state:389"><span class="id" title="variable">state</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#addr:391"><span class="id" title="variable">addr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Utils.Extras.html#sumZ"><span class="id" title="definition">sumZ</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#tx_amount"><span class="id" title="projection">tx_amount</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#incoming_txs"><span class="id" title="definition">incoming_txs</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#trace:390"><span class="id" title="variable">trace</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#addr:391"><span class="id" title="variable">addr</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a"><span class="id" title="notation">+</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Utils.Extras.html#sumZ"><span class="id" title="definition">sumZ</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#block_reward"><span class="id" title="projection">block_reward</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#created_blocks"><span class="id" title="definition">created_blocks</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#trace:390"><span class="id" title="variable">trace</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#addr:391"><span class="id" title="variable">addr</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.ZArith.BinInt.html#::Z_scope:x_'-'_x"><span class="id" title="notation">-</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Utils.Extras.html#sumZ"><span class="id" title="definition">sumZ</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#tx_amount"><span class="id" title="projection">tx_amount</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#outgoing_txs"><span class="id" title="definition">outgoing_txs</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#trace:390"><span class="id" title="variable">trace</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#addr:391"><span class="id" title="variable">addr</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="ConCert.Execution.Blockchain.html#incoming_txs"><span class="id" title="definition">incoming_txs</span></a>, <a class="idref" href="ConCert.Execution.Blockchain.html#outgoing_txs"><span class="id" title="definition">outgoing_txs</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="var">remember</span> <a class="idref" href="ConCert.Execution.Blockchain.html#empty_state"><span class="id" title="definition">empty_state</span></a> <span class="id" title="keyword">as</span> <span class="id" title="var">from_state</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">trace</span>; [|<span class="id" title="var">destruct_chain_step</span>].<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">subst</span>. <span class="id" title="var">cbn</span>. <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;Block&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rewrite_environment_equiv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">fold</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#created_blocks"><span class="id" title="definition">created_blocks</span></a> <span class="id" title="var">trace</span> <span class="id" title="var">addr</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHtrace</span> <span class="id" title="tactic">by</span> <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">destruct_address_eq</span>; <span class="id" title="tactic">subst</span>; <span class="id" title="var">cbn</span>; <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;Step&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">destruct_action_eval</span>; <span class="id" title="var">cbn</span>; <span class="id" title="var">rewrite_environment_equiv</span>; <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">all</span>: <span class="id" title="tactic">fold</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#created_blocks"><span class="id" title="definition">created_blocks</span></a> <span class="id" title="var">trace</span> <span class="id" title="var">addr</span>); <span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHtrace</span> <span class="id" title="tactic">by</span> <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">all</span>: <span class="id" title="var">destruct_address_eq</span>; <span class="id" title="var">cbn</span>; <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;Invalid&nbsp;User&nbsp;Action&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">rewrite_environment_equiv</span>.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;Permutation&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">rewrite_environment_equiv</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="contract_no_created_blocks" class="idref" href="#contract_no_created_blocks"><span class="id" title="lemma">contract_no_created_blocks</span></a> <a id="state:392" class="idref" href="#state:392"><span class="id" title="binder">state</span></a> (<a id="trace:393" class="idref" href="#trace:393"><span class="id" title="binder">trace</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#ChainTrace"><span class="id" title="definition">ChainTrace</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#empty_state"><span class="id" title="definition">empty_state</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#state:392"><span class="id" title="variable">state</span></a>) <a id="addr:394" class="idref" href="#addr:394"><span class="id" title="binder">addr</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#address_is_contract"><span class="id" title="method">address_is_contract</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#addr:394"><span class="id" title="variable">addr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#created_blocks"><span class="id" title="definition">created_blocks</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#trace:393"><span class="id" title="variable">trace</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#addr:394"><span class="id" title="variable">addr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">is_contract</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">remember</span> <a class="idref" href="ConCert.Execution.Blockchain.html#empty_state"><span class="id" title="definition">empty_state</span></a> <span class="id" title="var">eqn</span>:<span class="id" title="var">eq</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">trace</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">destruct_chain_step</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">valid_header</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#address_eqb_spec"><span class="id" title="method">address_eqb_spec</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#block_creator"><span class="id" title="projection">block_creator</span></a> <span class="id" title="var">header</span>) <span class="id" title="var">addr</span>); <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">congruence</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="undeployed_contract_balance_0" class="idref" href="#undeployed_contract_balance_0"><span class="id" title="lemma">undeployed_contract_balance_0</span></a> <a id="state:395" class="idref" href="#state:395"><span class="id" title="binder">state</span></a> <a id="addr:396" class="idref" href="#addr:396"><span class="id" title="binder">addr</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#reachable"><span class="id" title="definition">reachable</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#state:395"><span class="id" title="variable">state</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#address_is_contract"><span class="id" title="method">address_is_contract</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#addr:396"><span class="id" title="variable">addr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#env_contracts"><span class="id" title="projection">env_contracts</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#state:395"><span class="id" title="variable">state</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#addr:396"><span class="id" title="variable">addr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#env_account_balances"><span class="id" title="projection">env_account_balances</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#state:395"><span class="id" title="variable">state</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#addr:396"><span class="id" title="variable">addr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> 0.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> [<span class="id" title="var">trace</span>] <span class="id" title="var">is_contract</span> <span class="id" title="var">no_contract</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#account_balance_trace"><span class="id" title="lemma">account_balance_trace</span></a> <span class="id" title="var">_</span> <span class="id" title="var">trace</span>); <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Execution.Blockchain.html#undeployed_contract_no_out_txs"><span class="id" title="lemma">undeployed_contract_no_out_txs</span></a>, <a class="idref" href="ConCert.Execution.Blockchain.html#undeployed_contract_no_in_txs"><span class="id" title="lemma">undeployed_contract_no_in_txs</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#contract_no_created_blocks"><span class="id" title="lemma">contract_no_created_blocks</span></a>; <span class="id" title="tactic">auto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="account_balance_nonnegative" class="idref" href="#account_balance_nonnegative"><span class="id" title="lemma">account_balance_nonnegative</span></a> <a id="state:397" class="idref" href="#state:397"><span class="id" title="binder">state</span></a> <a id="addr:398" class="idref" href="#addr:398"><span class="id" title="binder">addr</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#reachable"><span class="id" title="definition">reachable</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#state:397"><span class="id" title="variable">state</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#env_account_balances"><span class="id" title="projection">env_account_balances</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#state:397"><span class="id" title="variable">state</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#addr:398"><span class="id" title="variable">addr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.ZArith.BinInt.html#b1f0780291abe9bd18804d2c9a5039d4"><span class="id" title="notation">&gt;=</span></a> 0.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> [<span class="id" title="var">trace</span>].<br/>
&nbsp;&nbsp;<span class="id" title="var">remember</span> <a class="idref" href="ConCert.Execution.Blockchain.html#empty_state"><span class="id" title="definition">empty_state</span></a> <span class="id" title="var">eqn</span>:<span class="id" title="var">eq</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">trace</span>; <span class="id" title="tactic">subst</span>; <span class="id" title="var">cbn</span>; <span class="id" title="tactic">try</span> <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">IHtrace</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#eq_refl"><span class="id" title="constructor">eq_refl</span></a>).<br/>
&nbsp;&nbsp;<span class="id" title="var">destruct_chain_step</span>.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;New&nbsp;block&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rewrite_environment_equiv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">valid_header</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">destruct_address_eq</span>; <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;Action&nbsp;evaluation&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#account_balance_post"><span class="id" title="lemma">account_balance_post</span></a> <span class="id" title="tactic">eval</span> <span class="id" title="var">addr</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#eval_amount_nonnegative"><span class="id" title="lemma">eval_amount_nonnegative</span></a> <span class="id" title="tactic">eval</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#eval_amount_le_account_balance"><span class="id" title="lemma">eval_amount_le_account_balance</span></a> <span class="id" title="tactic">eval</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">destruct_address_eq</span>; <span class="id" title="tactic">subst</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;Invalid&nbsp;User&nbsp;Action&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">rewrite_environment_equiv</span>.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;Permutation&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">rewrite_environment_equiv</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="wc_init_strong" class="idref" href="#wc_init_strong"><span class="id" title="lemma">wc_init_strong</span></a> {<a id="Setup:399" class="idref" href="#Setup:399"><span class="id" title="binder">Setup</span></a> <a id="Msg:400" class="idref" href="#Msg:400"><span class="id" title="binder">Msg</span></a> <a id="State:401" class="idref" href="#State:401"><span class="id" title="binder">State</span></a> : <span class="id" title="keyword">Type</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`{<a id="H:402" class="idref" href="#H:402"><span class="id" title="binder">Serializable</span></a> <a id="H:402" class="idref" href="#H:402"><span class="id" title="binder">Setup</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`{<a id="H0:403" class="idref" href="#H0:403"><span class="id" title="binder">Serializable</span></a> <a id="H0:403" class="idref" href="#H0:403"><span class="id" title="binder">Msg</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`{<a id="H1:404" class="idref" href="#H1:404"><span class="id" title="binder">Serializable</span></a> <a id="H1:404" class="idref" href="#H1:404"><span class="id" title="binder">State</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<a id="contract:405" class="idref" href="#contract:405"><span class="id" title="binder">contract</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Contract"><span class="id" title="record">Contract</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Setup:399"><span class="id" title="variable">Setup</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Msg:400"><span class="id" title="variable">Msg</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#State:401"><span class="id" title="variable">State</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<a id="chain:406" class="idref" href="#chain:406"><span class="id" title="binder">chain</span></a> <a id="ctx:407" class="idref" href="#ctx:407"><span class="id" title="binder">ctx</span></a> <a id="setup:408" class="idref" href="#setup:408"><span class="id" title="binder">setup</span></a> <a id="result:409" class="idref" href="#result:409"><span class="id" title="binder">result</span></a>} :<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#wc_init"><span class="id" title="definition">wc_init</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#contract:405"><span class="id" title="variable">contract</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#WeakContract"><span class="id" title="inductive">WeakContract</span></a>) <a class="idref" href="ConCert.Execution.Blockchain.html#chain:406"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ctx:407"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#setup:408"><span class="id" title="variable">setup</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#result:409"><span class="id" title="variable">result</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">exists</span></a> <a id="setup_strong:410" class="idref" href="#setup_strong:410"><span class="id" title="binder">setup_strong</span></a> <a id="result_strong:411" class="idref" href="#result_strong:411"><span class="id" title="binder">result_strong</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Serializable.html#deserialize"><span class="id" title="method">deserialize</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#setup:408"><span class="id" title="variable">setup</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#setup_strong:410"><span class="id" title="variable">setup_strong</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Serializable.html#serialize"><span class="id" title="method">serialize</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#result_strong:411"><span class="id" title="variable">result_strong</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#result:409"><span class="id" title="variable">result</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#init"><span class="id" title="projection">Blockchain.init</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#contract:405"><span class="id" title="variable">contract</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#chain:406"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ctx:407"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#setup_strong:410"><span class="id" title="variable">setup_strong</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#result_strong:411"><span class="id" title="variable">result_strong</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">init</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="ConCert.Execution.Serializable.html#deserialize"><span class="id" title="method">deserialize</span></a> <span class="id" title="var">setup</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">setup_strong</span>|] <span class="id" title="var">eqn</span>:<span class="id" title="var">deser_setup</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">exists</span> <span class="id" title="var">setup_strong</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#init"><span class="id" title="projection">Blockchain.init</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">result_strong</span>|] <span class="id" title="var">eqn</span>:<span class="id" title="var">result_eq</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">exists</span> <span class="id" title="var">result_strong</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> <span class="id" title="tactic">split</span>; <span class="id" title="tactic">auto</span> <span class="id" title="keyword">with</span> <span class="id" title="tactic">congruence</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="wc_receive_strong" class="idref" href="#wc_receive_strong"><span class="id" title="lemma">wc_receive_strong</span></a> {<a id="Setup:412" class="idref" href="#Setup:412"><span class="id" title="binder">Setup</span></a> <a id="Msg:413" class="idref" href="#Msg:413"><span class="id" title="binder">Msg</span></a> <a id="State:414" class="idref" href="#State:414"><span class="id" title="binder">State</span></a> : <span class="id" title="keyword">Type</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`{<a id="H:415" class="idref" href="#H:415"><span class="id" title="binder">Serializable</span></a> <a id="H:415" class="idref" href="#H:415"><span class="id" title="binder">Setup</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`{<a id="H0:416" class="idref" href="#H0:416"><span class="id" title="binder">Serializable</span></a> <a id="H0:416" class="idref" href="#H0:416"><span class="id" title="binder">Msg</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`{<a id="H1:417" class="idref" href="#H1:417"><span class="id" title="binder">Serializable</span></a> <a id="H1:417" class="idref" href="#H1:417"><span class="id" title="binder">State</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<a id="contract:418" class="idref" href="#contract:418"><span class="id" title="binder">contract</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Contract"><span class="id" title="record">Contract</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Setup:412"><span class="id" title="variable">Setup</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Msg:413"><span class="id" title="variable">Msg</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#State:414"><span class="id" title="variable">State</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<a id="chain:419" class="idref" href="#chain:419"><span class="id" title="binder">chain</span></a> <a id="ctx:420" class="idref" href="#ctx:420"><span class="id" title="binder">ctx</span></a> <a id="prev_state:421" class="idref" href="#prev_state:421"><span class="id" title="binder">prev_state</span></a> <a id="msg:422" class="idref" href="#msg:422"><span class="id" title="binder">msg</span></a> <a id="new_state:423" class="idref" href="#new_state:423"><span class="id" title="binder">new_state</span></a> <a id="new_acts:424" class="idref" href="#new_acts:424"><span class="id" title="binder">new_acts</span></a>} :<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#wc_receive"><span class="id" title="definition">wc_receive</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#contract:418"><span class="id" title="variable">contract</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#WeakContract"><span class="id" title="inductive">WeakContract</span></a>) <a class="idref" href="ConCert.Execution.Blockchain.html#chain:419"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ctx:420"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#prev_state:421"><span class="id" title="variable">prev_state</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#msg:422"><span class="id" title="variable">msg</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Execution.Blockchain.html#new_state:423"><span class="id" title="variable">new_state</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#new_acts:424"><span class="id" title="variable">new_acts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">exists</span></a> <a id="prev_state_strong:425" class="idref" href="#prev_state_strong:425"><span class="id" title="binder">prev_state_strong</span></a> <a id="msg_strong:426" class="idref" href="#msg_strong:426"><span class="id" title="binder">msg_strong</span></a> <a id="new_state_strong:427" class="idref" href="#new_state_strong:427"><span class="id" title="binder">new_state_strong</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Serializable.html#deserialize"><span class="id" title="method">deserialize</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#prev_state:421"><span class="id" title="variable">prev_state</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#prev_state_strong:425"><span class="id" title="variable">prev_state_strong</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="ConCert.Execution.Blockchain.html#msg_strong:426"><span class="id" title="variable">msg_strong</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">msg_strong</span> =&gt; <a class="idref" href="ConCert.Execution.Blockchain.html#msg:422"><span class="id" title="variable">msg</span></a> <a class="idref" href="ConCert.Execution.Monads.html#f1146025ce6377896c1a30f88a02c8cb"><span class="id" title="notation">&gt;&gt;=</span></a> <a class="idref" href="ConCert.Execution.Serializable.html#deserialize"><span class="id" title="method">deserialize</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#msg_strong:426"><span class="id" title="variable">msg_strong</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> =&gt; <a class="idref" href="ConCert.Execution.Blockchain.html#msg:422"><span class="id" title="variable">msg</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Serializable.html#serialize"><span class="id" title="method">serialize</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#new_state_strong:427"><span class="id" title="variable">new_state_strong</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#new_state:423"><span class="id" title="variable">new_state</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#receive"><span class="id" title="projection">Blockchain.receive</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#contract:418"><span class="id" title="variable">contract</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#chain:419"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ctx:420"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#prev_state_strong:425"><span class="id" title="variable">prev_state_strong</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#msg_strong:426"><span class="id" title="variable">msg_strong</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Execution.Blockchain.html#new_state_strong:427"><span class="id" title="variable">new_state_strong</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#new_acts:424"><span class="id" title="variable">new_acts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">receive</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="ConCert.Execution.Serializable.html#deserialize"><span class="id" title="method">deserialize</span></a> <span class="id" title="var">prev_state</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">prev_state_strong</span>|] <span class="id" title="var">eqn</span>:<span class="id" title="var">deser_state</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">exists</span> <span class="id" title="var">prev_state_strong</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">exists</span> (<span class="id" title="var">msg</span> <a class="idref" href="ConCert.Execution.Monads.html#f1146025ce6377896c1a30f88a02c8cb"><span class="id" title="notation">&gt;&gt;=</span></a> <a class="idref" href="ConCert.Execution.Serializable.html#deserialize"><span class="id" title="method">deserialize</span></a>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">msg</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">msg</span>|]; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;1: <span class="id" title="tactic">destruct</span> (<a class="idref" href="ConCert.Execution.Serializable.html#deserialize"><span class="id" title="method">deserialize</span></a> <span class="id" title="var">msg</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">msg_strong</span>|];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">all</span>: <span class="id" title="tactic">destruct</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#receive"><span class="id" title="projection">Blockchain.receive</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">as</span> [[<span class="id" title="var">resp_state_strong</span> <span class="id" title="var">resp_acts_strong</span>]|] <span class="id" title="var">eqn</span>:<span class="id" title="var">result_eq</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">all</span>: <span class="id" title="tactic">exists</span> <span class="id" title="var">resp_state_strong</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">all</span>: <span class="id" title="tactic">inversion_clear</span> <span class="id" title="var">receive</span>; <span class="id" title="tactic">auto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="deployed_contract_state_typed" class="idref" href="#deployed_contract_state_typed"><span class="id" title="lemma">deployed_contract_state_typed</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<a id="Setup:429" class="idref" href="#Setup:429"><span class="id" title="binder">Setup</span></a> <a id="Msg:430" class="idref" href="#Msg:430"><span class="id" title="binder">Msg</span></a> <a id="State:431" class="idref" href="#State:431"><span class="id" title="binder">State</span></a> : <span class="id" title="keyword">Type</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`{<a id="H:432" class="idref" href="#H:432"><span class="id" title="binder">Serializable</span></a> <a id="H:432" class="idref" href="#H:432"><span class="id" title="binder">Setup</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`{<a id="H0:433" class="idref" href="#H0:433"><span class="id" title="binder">Serializable</span></a> <a id="H0:433" class="idref" href="#H0:433"><span class="id" title="binder">Msg</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`{<a id="H1:434" class="idref" href="#H1:434"><span class="id" title="binder">Serializable</span></a> <a id="H1:434" class="idref" href="#H1:434"><span class="id" title="binder">State</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<a id="contract:435" class="idref" href="#contract:435"><span class="id" title="binder">contract</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Contract"><span class="id" title="record">Contract</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Setup:429"><span class="id" title="variable">Setup</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Msg:430"><span class="id" title="variable">Msg</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#State:431"><span class="id" title="variable">State</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<a id="bstate:436" class="idref" href="#bstate:436"><span class="id" title="binder">bstate</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#ChainState"><span class="id" title="record">ChainState</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<a id="caddr:437" class="idref" href="#caddr:437"><span class="id" title="binder">caddr</span></a>} :<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#env_contracts"><span class="id" title="projection">env_contracts</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#bstate:436"><span class="id" title="variable">bstate</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#caddr:437"><span class="id" title="variable">caddr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#contract:435"><span class="id" title="variable">contract</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#WeakContract"><span class="id" title="inductive">WeakContract</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#reachable"><span class="id" title="definition">reachable</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#bstate:436"><span class="id" title="variable">bstate</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">exists</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">(</span></a><a id="cstate:438" class="idref" href="#cstate:438"><span class="id" title="binder">cstate</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#State:431"><span class="id" title="variable">State</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">),</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#contract_state"><span class="id" title="definition">contract_state</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#bstate:436"><span class="id" title="variable">bstate</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#caddr:437"><span class="id" title="variable">caddr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#cstate:438"><span class="id" title="variable">cstate</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">contract_deployed</span> [<span class="id" title="var">trace</span>].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#contract_state"><span class="id" title="definition">contract_state</span></a> <span class="id" title="var">bstate</span> <span class="id" title="var">caddr</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">cstate</span>|] <span class="id" title="var">eqn</span>:<span class="id" title="var">eq</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="tactic">exists</span> <span class="id" title="var">cstate</span>; <span class="id" title="tactic">auto</span>|].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="ConCert.Execution.Blockchain.html#contract_state"><span class="id" title="definition">contract_state</span></a> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Show&nbsp;that&nbsp;eq&nbsp;is&nbsp;a&nbsp;contradiction.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="var">remember</span> <a class="idref" href="ConCert.Execution.Blockchain.html#empty_state"><span class="id" title="definition">empty_state</span></a>; <span class="id" title="tactic">induction</span> <span class="id" title="var">trace</span>; <span class="id" title="tactic">subst</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">destruct_chain_step</span>; <span class="id" title="tactic">try</span> <span class="id" title="var">now</span> <span class="id" title="var">rewrite_environment_equiv</span>.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;Action&nbsp;evaluation&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">destruct_action_eval</span>; <span class="id" title="tactic">subst</span>; <span class="id" title="var">rewrite_environment_equiv</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="comment">(*&nbsp;Transfer,&nbsp;use&nbsp;IH&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="comment">(*&nbsp;Deployment&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">destruct_address_eq</span>; <span class="id" title="tactic">subst</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;To&nbsp;this&nbsp;contract,&nbsp;show&nbsp;that&nbsp;deserialization&nbsp;would&nbsp;not&nbsp;fail.&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">replace</span> <span class="id" title="var">wc</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">contract</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#WeakContract"><span class="id" title="inductive">WeakContract</span></a>) <span class="id" title="tactic">in</span> * <span class="id" title="tactic">by</span> <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#wc_init_strong"><span class="id" title="lemma">wc_init_strong</span></a> <span class="id" title="keyword">ltac</span>:(<span class="id" title="var">eassumption</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">as</span> [<span class="id" title="var">setup_strong</span> [<span class="id" title="var">result_strong</span> [? [&lt;- <span class="id" title="var">init</span>]]]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">eq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Execution.Serializable.html#deserialize_serialize"><span class="id" title="method">deserialize_serialize</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">eq</span>; <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="comment">(*&nbsp;Call&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#address_eqb_spec"><span class="id" title="method">address_eqb_spec</span></a> <span class="id" title="var">caddr</span> <span class="id" title="var">to_addr</span>); <span class="id" title="tactic">subst</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;To&nbsp;this&nbsp;contract,&nbsp;show&nbsp;that&nbsp;deserialization&nbsp;would&nbsp;not&nbsp;fail.&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">replace</span> <span class="id" title="var">wc</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">contract</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#WeakContract"><span class="id" title="inductive">WeakContract</span></a>) <span class="id" title="tactic">in</span> * <span class="id" title="tactic">by</span> <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#wc_receive_strong"><span class="id" title="lemma">wc_receive_strong</span></a> <span class="id" title="keyword">ltac</span>:(<span class="id" title="var">eassumption</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">as</span> [<span class="id" title="var">state_strong</span> [<span class="id" title="var">msg_strong</span> [<span class="id" title="var">resp_state_strong</span> [? [? [&lt;- <span class="id" title="var">receive</span>]]]]]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">eq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Execution.Serializable.html#deserialize_serialize"><span class="id" title="method">deserialize_serialize</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">eq</span>; <span class="id" title="tactic">congruence</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="origin_is_always_account" class="idref" href="#origin_is_always_account"><span class="id" title="lemma">origin_is_always_account</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<a id="Setup:439" class="idref" href="#Setup:439"><span class="id" title="binder">Setup</span></a> <a id="Msg:440" class="idref" href="#Msg:440"><span class="id" title="binder">Msg</span></a> <a id="State:441" class="idref" href="#State:441"><span class="id" title="binder">State</span></a> : <span class="id" title="keyword">Type</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`{<a id="H:442" class="idref" href="#H:442"><span class="id" title="binder">Serializable</span></a> <a id="H:442" class="idref" href="#H:442"><span class="id" title="binder">Setup</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`{<a id="H0:443" class="idref" href="#H0:443"><span class="id" title="binder">Serializable</span></a> <a id="H0:443" class="idref" href="#H0:443"><span class="id" title="binder">Msg</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`{<a id="H1:444" class="idref" href="#H1:444"><span class="id" title="binder">Serializable</span></a> <a id="H1:444" class="idref" href="#H1:444"><span class="id" title="binder">State</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<a id="bstate:445" class="idref" href="#bstate:445"><span class="id" title="binder">bstate</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#ChainState"><span class="id" title="record">ChainState</span></a>} :<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#reachable"><span class="id" title="definition">reachable</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#bstate:445"><span class="id" title="variable">bstate</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Lists.List.html#Forall"><span class="id" title="inductive">Forall</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#act_origin_is_account"><span class="id" title="definition">act_origin_is_account</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#chain_state_queue"><span class="id" title="projection">chain_state_queue</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#bstate:445"><span class="id" title="variable">bstate</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> [<span class="id" title="var">trace</span>].<br/>
&nbsp;&nbsp;<span class="id" title="var">remember</span> <a class="idref" href="ConCert.Execution.Blockchain.html#empty_state"><span class="id" title="definition">empty_state</span></a>; <span class="id" title="tactic">induction</span> <span class="id" title="var">trace</span>;<span class="id" title="tactic">subst</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="tactic">try</span> <span class="id" title="tactic">constructor</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">destruct_chain_step</span>.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;New&nbsp;block,&nbsp;use&nbsp;the&nbsp;fact&nbsp;that&nbsp;<span class="inlinecode"><span class="id" title="var">act_origin</span></span>&nbsp;is&nbsp;the&nbsp;same&nbsp;as&nbsp;<span class="inlinecode"><span class="id" title="var">act_from</span></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;<span class="inlinecode"><span class="id" title="var">act_from</span></span>&nbsp;is&nbsp;an&nbsp;account&nbsp;address*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Execution.Blockchain.html#origin_is_account"><span class="id" title="lemma">origin_is_account</span></a>.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;Action&nbsp;evaluation&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">destruct_action_eval</span>; <span class="id" title="tactic">subst</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">queue_new</span> <span class="id" title="tactic">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">queue_prev</span> <span class="id" title="tactic">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">specialize_hypotheses</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">IHtrace</span>;<span class="id" title="tactic">subst</span>; <span class="id" title="tactic">try</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Utils.Extras.html#Forall_app"><span class="id" title="lemma">Forall_app</span></a>. <span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">apply</span> <a class="idref" href="https://metacoq.github.io/html/MetaCoq.Template.utils.All_Forall.html#Forall_map"><span class="id" title="lemma">All_Forall.Forall_map</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Lists.List.html#Forall_forall"><span class="id" title="lemma">Forall_forall</span></a>; <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;Invalid&nbsp;User&nbsp;Action&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">queue_new</span> <span class="id" title="tactic">in</span> *; <span class="id" title="tactic">rewrite</span> <span class="id" title="var">queue_prev</span> <span class="id" title="tactic">in</span> *; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">specialize_hypotheses</span>; <span class="id" title="tactic">inversion</span> <span class="id" title="var">IHtrace</span>; <span class="id" title="tactic">subst</span>; <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;Permutation&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="ConCert.Utils.Extras.html#forall_respects_permutation"><span class="id" title="lemma">forall_respects_permutation</span></a>; <span class="id" title="tactic">eauto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Inductive</span> <a id="TagFacts" class="idref" href="#TagFacts"><span class="id" title="inductive">TagFacts</span></a> := <a id="tag_facts" class="idref" href="#tag_facts"><span class="id" title="constructor">tag_facts</span></a>.<br/>
<span class="id" title="keyword">Inductive</span> <a id="TagAddBlock" class="idref" href="#TagAddBlock"><span class="id" title="inductive">TagAddBlock</span></a> := <a id="tag_add_block" class="idref" href="#tag_add_block"><span class="id" title="constructor">tag_add_block</span></a>.<br/>
<span class="id" title="keyword">Inductive</span> <a id="TagDeployment" class="idref" href="#TagDeployment"><span class="id" title="inductive">TagDeployment</span></a> := <a id="tag_deployment" class="idref" href="#tag_deployment"><span class="id" title="constructor">tag_deployment</span></a>.<br/>
<span class="id" title="keyword">Inductive</span> <a id="TagOutgoingAct" class="idref" href="#TagOutgoingAct"><span class="id" title="inductive">TagOutgoingAct</span></a> := <a id="tag_outgoing_act" class="idref" href="#tag_outgoing_act"><span class="id" title="constructor">tag_outgoing_act</span></a>.<br/>
<span class="id" title="keyword">Inductive</span> <a id="TagNonrecursiveCall" class="idref" href="#TagNonrecursiveCall"><span class="id" title="inductive">TagNonrecursiveCall</span></a> := <a id="tag_nonrecursive_call" class="idref" href="#tag_nonrecursive_call"><span class="id" title="constructor">tag_nonrecursive_call</span></a>.<br/>
<span class="id" title="keyword">Inductive</span> <a id="TagRecursiveCall" class="idref" href="#TagRecursiveCall"><span class="id" title="inductive">TagRecursiveCall</span></a> := <a id="tag_recursive_call" class="idref" href="#tag_recursive_call"><span class="id" title="constructor">tag_recursive_call</span></a>.<br/>
<span class="id" title="keyword">Inductive</span> <a id="TagPermuteQueue" class="idref" href="#TagPermuteQueue"><span class="id" title="inductive">TagPermuteQueue</span></a> := <a id="tag_permute_queue" class="idref" href="#tag_permute_queue"><span class="id" title="constructor">tag_permute_queue</span></a>.<br/>

<br/>
<span class="id" title="keyword">Hint Constructors</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#TagFacts"><span class="id" title="inductive">TagFacts</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#TagAddBlock"><span class="id" title="inductive">TagAddBlock</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#TagDeployment"><span class="id" title="inductive">TagDeployment</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#TagOutgoingAct"><span class="id" title="inductive">TagOutgoingAct</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#TagNonrecursiveCall"><span class="id" title="inductive">TagNonrecursiveCall</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#TagRecursiveCall"><span class="id" title="inductive">TagRecursiveCall</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#TagPermuteQueue"><span class="id" title="inductive">TagPermuteQueue</span></a> : <span class="id" title="var">core</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="contract_induction" class="idref" href="#contract_induction"><span class="id" title="lemma">contract_induction</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<a id="Setup:460" class="idref" href="#Setup:460"><span class="id" title="binder">Setup</span></a> <a id="Msg:461" class="idref" href="#Msg:461"><span class="id" title="binder">Msg</span></a> <a id="State:462" class="idref" href="#State:462"><span class="id" title="binder">State</span></a> : <span class="id" title="keyword">Type</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`{<a id="H:463" class="idref" href="#H:463"><span class="id" title="binder">Serializable</span></a> <a id="H:463" class="idref" href="#H:463"><span class="id" title="binder">Setup</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`{<a id="H0:464" class="idref" href="#H0:464"><span class="id" title="binder">Serializable</span></a> <a id="H0:464" class="idref" href="#H0:464"><span class="id" title="binder">Msg</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`{<a id="H1:465" class="idref" href="#H1:465"><span class="id" title="binder">Serializable</span></a> <a id="H1:465" class="idref" href="#H1:465"><span class="id" title="binder">State</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="contract:466" class="idref" href="#contract:466"><span class="id" title="binder">contract</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Contract"><span class="id" title="record">Contract</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Setup:460"><span class="id" title="variable">Setup</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Msg:461"><span class="id" title="variable">Msg</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#State:462"><span class="id" title="variable">State</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="AddBlockFacts:473" class="idref" href="#AddBlockFacts:473"><span class="id" title="binder">AddBlockFacts</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">forall</span> (<a id="chain_height:467" class="idref" href="#chain_height:467"><span class="id" title="binder">chain_height</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>) (<a id="current_slot:468" class="idref" href="#current_slot:468"><span class="id" title="binder">current_slot</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>) (<a id="finalized_height:469" class="idref" href="#finalized_height:469"><span class="id" title="binder">finalized_height</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="new_height:470" class="idref" href="#new_height:470"><span class="id" title="binder">new_height</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>) (<a id="new_slot:471" class="idref" href="#new_slot:471"><span class="id" title="binder">new_slot</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>) (<a id="new_finalized_height:472" class="idref" href="#new_finalized_height:472"><span class="id" title="binder">new_finalized_height</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>), <span class="id" title="keyword">Prop</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="DeployFacts:476" class="idref" href="#DeployFacts:476"><span class="id" title="binder">DeployFacts</span></a> : <span class="id" title="keyword">forall</span> (<a id="chain:474" class="idref" href="#chain:474"><span class="id" title="binder">chain</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Chain"><span class="id" title="record">Chain</span></a>) (<a id="ctx:475" class="idref" href="#ctx:475"><span class="id" title="binder">ctx</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#ContractCallContext"><span class="id" title="record">ContractCallContext</span></a>), <span class="id" title="keyword">Prop</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="CallFacts:482" class="idref" href="#CallFacts:482"><span class="id" title="binder">CallFacts</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">forall</span> (<a id="chain:477" class="idref" href="#chain:477"><span class="id" title="binder">chain</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Chain"><span class="id" title="record">Chain</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="ctx:478" class="idref" href="#ctx:478"><span class="id" title="binder">ctx</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#ContractCallContext"><span class="id" title="record">ContractCallContext</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="cstate:479" class="idref" href="#cstate:479"><span class="id" title="binder">cstate</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#State:462"><span class="id" title="variable">State</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="outgoing_actions:480" class="idref" href="#outgoing_actions:480"><span class="id" title="binder">outgoing_actions</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ActionBody"><span class="id" title="inductive">ActionBody</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="inc_calls:481" class="idref" href="#inc_calls:481"><span class="id" title="binder">inc_calls</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#ContractCallInfo"><span class="id" title="record">ContractCallInfo</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Msg:461"><span class="id" title="variable">Msg</span></a>))), <span class="id" title="keyword">Prop</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="P:493" class="idref" href="#P:493"><span class="id" title="binder">P</span></a> : <span class="id" title="keyword">forall</span> (<a id="chain_height:483" class="idref" href="#chain_height:483"><span class="id" title="binder">chain_height</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="current_slot:484" class="idref" href="#current_slot:484"><span class="id" title="binder">current_slot</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="finalized_height:485" class="idref" href="#finalized_height:485"><span class="id" title="binder">finalized_height</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="caddr:486" class="idref" href="#caddr:486"><span class="id" title="binder">caddr</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="deployment_info:487" class="idref" href="#deployment_info:487"><span class="id" title="binder">deployment_info</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#DeploymentInfo"><span class="id" title="record">DeploymentInfo</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Setup:460"><span class="id" title="variable">Setup</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="cstate:488" class="idref" href="#cstate:488"><span class="id" title="binder">cstate</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#State:462"><span class="id" title="variable">State</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="balance:489" class="idref" href="#balance:489"><span class="id" title="binder">balance</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Amount"><span class="id" title="definition">Amount</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="outgoing_actions_queued:490" class="idref" href="#outgoing_actions_queued:490"><span class="id" title="binder">outgoing_actions_queued</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ActionBody"><span class="id" title="inductive">ActionBody</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="incoming_calls_seen:491" class="idref" href="#incoming_calls_seen:491"><span class="id" title="binder">incoming_calls_seen</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#ContractCallInfo"><span class="id" title="record">ContractCallInfo</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Msg:461"><span class="id" title="variable">Msg</span></a>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="outgoing_txs_seen:492" class="idref" href="#outgoing_txs_seen:492"><span class="id" title="binder">outgoing_txs_seen</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Tx"><span class="id" title="record">Tx</span></a>), <span class="id" title="keyword">Prop</span>) :<br/>
<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Facts&nbsp;*)</span><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">(</span></a><span class="id" title="keyword">forall</span> (<a id="bstate_from:494" class="idref" href="#bstate_from:494"><span class="id" title="binder">bstate_from</span></a> <a id="bstate_to:495" class="idref" href="#bstate_to:495"><span class="id" title="binder">bstate_to</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#ChainState"><span class="id" title="record">ChainState</span></a>) (<a id="step:496" class="idref" href="#step:496"><span class="id" title="binder">step</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#ChainStep"><span class="id" title="inductive">ChainStep</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#bstate_from:494"><span class="id" title="variable">bstate_from</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#bstate_to:495"><span class="id" title="variable">bstate_to</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="from_reachable:497" class="idref" href="#from_reachable:497"><span class="id" title="binder">from_reachable</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#ChainTrace"><span class="id" title="definition">ChainTrace</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#empty_state"><span class="id" title="definition">empty_state</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#bstate_from:494"><span class="id" title="variable">bstate_from</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="tag:498" class="idref" href="#tag:498"><span class="id" title="binder">tag</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#TagFacts"><span class="id" title="inductive">TagFacts</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="ConCert.Execution.Blockchain.html#step:496"><span class="id" title="variable">step</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="ConCert.Execution.Blockchain.html#step_block"><span class="id" title="constructor">step_block</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">header</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#AddBlockFacts:473"><span class="id" title="variable">AddBlockFacts</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#chain_height"><span class="id" title="projection">chain_height</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#bstate_from:494"><span class="id" title="variable">bstate_from</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ConCert.Execution.Blockchain.html#current_slot"><span class="id" title="projection">current_slot</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#bstate_from:494"><span class="id" title="variable">bstate_from</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ConCert.Execution.Blockchain.html#finalized_height"><span class="id" title="projection">finalized_height</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#bstate_from:494"><span class="id" title="variable">bstate_from</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ConCert.Execution.Blockchain.html#block_height"><span class="id" title="projection">block_height</span></a> <span class="id" title="var">header</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ConCert.Execution.Blockchain.html#block_slot"><span class="id" title="projection">block_slot</span></a> <span class="id" title="var">header</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ConCert.Execution.Blockchain.html#block_finalized_height"><span class="id" title="projection">block_finalized_height</span></a> <span class="id" title="var">header</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="ConCert.Execution.Blockchain.html#step_action"><span class="id" title="constructor">step_action</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">act</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#eval_deploy"><span class="id" title="constructor">eval_deploy</span></a> <span class="id" title="var">origin</span> <span class="id" title="var">from</span> <span class="id" title="var">to</span> <span class="id" title="var">amount</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) <span class="id" title="var">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#DeployFacts:476"><span class="id" title="variable">DeployFacts</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ConCert.Execution.Blockchain.html#transfer_balance"><span class="id" title="definition">transfer_balance</span></a> <span class="id" title="var">from</span> <span class="id" title="var">to</span> <span class="id" title="var">amount</span> <a class="idref" href="ConCert.Execution.Blockchain.html#bstate_from:494"><span class="id" title="variable">bstate_from</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ConCert.Execution.Blockchain.html#build_ctx"><span class="id" title="constructor">build_ctx</span></a> <span class="id" title="var">origin</span> <span class="id" title="var">from</span> <span class="id" title="var">to</span> <span class="id" title="var">amount</span> <span class="id" title="var">amount</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="ConCert.Execution.Blockchain.html#step_action"><span class="id" title="constructor">step_action</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">act</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#eval_call"><span class="id" title="constructor">eval_call</span></a> <span class="id" title="var">origin</span> <span class="id" title="var">from</span> <span class="id" title="var">to</span> <span class="id" title="var">amount</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) <span class="id" title="var">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="new_state:500" class="idref" href="#new_state:500"><span class="id" title="binder">new_state</span></a> := <a class="idref" href="ConCert.Execution.Blockchain.html#transfer_balance"><span class="id" title="definition">transfer_balance</span></a> <span class="id" title="var">from</span> <span class="id" title="var">to</span> <span class="id" title="var">amount</span> <a class="idref" href="ConCert.Execution.Blockchain.html#bstate_from:494"><span class="id" title="variable">bstate_from</span></a> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">forall</span> (<a id="cstate:501" class="idref" href="#cstate:501"><span class="id" title="binder">cstate</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#State:462"><span class="id" title="variable">State</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#env_contracts"><span class="id" title="projection">env_contracts</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#bstate_from:494"><span class="id" title="variable">bstate_from</span></a> <span class="id" title="var">to</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#contract:466"><span class="id" title="variable">contract</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#WeakContract"><span class="id" title="inductive">WeakContract</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#contract_state"><span class="id" title="definition">contract_state</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#bstate_from:494"><span class="id" title="variable">bstate_from</span></a> <span class="id" title="var">to</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#cstate:501"><span class="id" title="variable">cstate</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#CallFacts:482"><span class="id" title="variable">CallFacts</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#new_state:500"><span class="id" title="variable">new_state</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ConCert.Execution.Blockchain.html#build_ctx"><span class="id" title="constructor">build_ctx</span></a> <span class="id" title="var">origin</span> <span class="id" title="var">from</span> <span class="id" title="var">to</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#env_account_balances"><span class="id" title="projection">env_account_balances</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#new_state:500"><span class="id" title="variable">new_state</span></a> <span class="id" title="var">to</span>) <span class="id" title="var">amount</span>) <a class="idref" href="ConCert.Execution.Blockchain.html#cstate:501"><span class="id" title="variable">cstate</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ConCert.Execution.Blockchain.html#outgoing_acts"><span class="id" title="definition">outgoing_acts</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#bstate_from:494"><span class="id" title="variable">bstate_from</span></a> <span class="id" title="var">to</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ConCert.Execution.Blockchain.html#incoming_calls"><span class="id" title="definition">incoming_calls</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Msg:461"><span class="id" title="variable">Msg</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#from_reachable:497"><span class="id" title="variable">from_reachable</span></a> <span class="id" title="var">to</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#True"><span class="id" title="inductive">Logic.True</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Add&nbsp;block&nbsp;*)</span><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">(</span></a><span class="id" title="keyword">forall</span> <a id="old_chain_height:502" class="idref" href="#old_chain_height:502"><span class="id" title="binder">old_chain_height</span></a> <a id="old_cur_slot:503" class="idref" href="#old_cur_slot:503"><span class="id" title="binder">old_cur_slot</span></a> <a id="old_fin_height:504" class="idref" href="#old_fin_height:504"><span class="id" title="binder">old_fin_height</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a id="new_chain_height:505" class="idref" href="#new_chain_height:505"><span class="id" title="binder">new_chain_height</span></a> <a id="new_cur_slot:506" class="idref" href="#new_cur_slot:506"><span class="id" title="binder">new_cur_slot</span></a> <a id="new_fin_height:507" class="idref" href="#new_fin_height:507"><span class="id" title="binder">new_fin_height</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a id="caddr:508" class="idref" href="#caddr:508"><span class="id" title="binder">caddr</span></a> <a id="dep_info:509" class="idref" href="#dep_info:509"><span class="id" title="binder">dep_info</span></a> <a id="state:510" class="idref" href="#state:510"><span class="id" title="binder">state</span></a> <a id="balance:511" class="idref" href="#balance:511"><span class="id" title="binder">balance</span></a> <a id="inc_calls:512" class="idref" href="#inc_calls:512"><span class="id" title="binder">inc_calls</span></a> <a id="out_txs:513" class="idref" href="#out_txs:513"><span class="id" title="binder">out_txs</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="facts:514" class="idref" href="#facts:514"><span class="id" title="binder">facts</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#AddBlockFacts:473"><span class="id" title="variable">AddBlockFacts</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#old_chain_height:502"><span class="id" title="variable">old_chain_height</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#old_cur_slot:503"><span class="id" title="variable">old_cur_slot</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#old_fin_height:504"><span class="id" title="variable">old_fin_height</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#new_chain_height:505"><span class="id" title="variable">new_chain_height</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#new_cur_slot:506"><span class="id" title="variable">new_cur_slot</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#new_fin_height:507"><span class="id" title="variable">new_fin_height</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="IH:515" class="idref" href="#IH:515"><span class="id" title="binder">IH</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#P:493"><span class="id" title="variable">P</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#old_chain_height:502"><span class="id" title="variable">old_chain_height</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#old_cur_slot:503"><span class="id" title="variable">old_cur_slot</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#old_fin_height:504"><span class="id" title="variable">old_fin_height</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#caddr:508"><span class="id" title="variable">caddr</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#dep_info:509"><span class="id" title="variable">dep_info</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#state:510"><span class="id" title="variable">state</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#balance:511"><span class="id" title="variable">balance</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#inc_calls:512"><span class="id" title="variable">inc_calls</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#out_txs:513"><span class="id" title="variable">out_txs</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="tag:516" class="idref" href="#tag:516"><span class="id" title="binder">tag</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#TagAddBlock"><span class="id" title="inductive">TagAddBlock</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#P:493"><span class="id" title="variable">P</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#new_chain_height:505"><span class="id" title="variable">new_chain_height</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#new_cur_slot:506"><span class="id" title="variable">new_cur_slot</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#new_fin_height:507"><span class="id" title="variable">new_fin_height</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#caddr:508"><span class="id" title="variable">caddr</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#dep_info:509"><span class="id" title="variable">dep_info</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#state:510"><span class="id" title="variable">state</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#balance:511"><span class="id" title="variable">balance</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#inc_calls:512"><span class="id" title="variable">inc_calls</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#out_txs:513"><span class="id" title="variable">out_txs</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Deploy&nbsp;contract&nbsp;*)</span><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">(</span></a><span class="id" title="keyword">forall</span> <a id="chain:517" class="idref" href="#chain:517"><span class="id" title="binder">chain</span></a> <a id="ctx:518" class="idref" href="#ctx:518"><span class="id" title="binder">ctx</span></a> <a id="setup:519" class="idref" href="#setup:519"><span class="id" title="binder">setup</span></a> <a id="result:520" class="idref" href="#result:520"><span class="id" title="binder">result</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="facts:521" class="idref" href="#facts:521"><span class="id" title="binder">facts</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#DeployFacts:476"><span class="id" title="variable">DeployFacts</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#chain:517"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ctx:518"><span class="id" title="variable">ctx</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="init_some:522" class="idref" href="#init_some:522"><span class="id" title="binder">init_some</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#init"><span class="id" title="projection">init</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#contract:466"><span class="id" title="variable">contract</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#chain:517"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ctx:518"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#setup:519"><span class="id" title="variable">setup</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#result:520"><span class="id" title="variable">result</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="tag:523" class="idref" href="#tag:523"><span class="id" title="binder">tag</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#TagDeployment"><span class="id" title="inductive">TagDeployment</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#P:493"><span class="id" title="variable">P</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#chain_height"><span class="id" title="projection">chain_height</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#chain:517"><span class="id" title="variable">chain</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ConCert.Execution.Blockchain.html#current_slot"><span class="id" title="projection">current_slot</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#chain:517"><span class="id" title="variable">chain</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ConCert.Execution.Blockchain.html#finalized_height"><span class="id" title="projection">finalized_height</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#chain:517"><span class="id" title="variable">chain</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ConCert.Execution.Blockchain.html#ctx_contract_address"><span class="id" title="projection">ctx_contract_address</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ctx:518"><span class="id" title="variable">ctx</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ConCert.Execution.Blockchain.html#build_deployment_info"><span class="id" title="constructor">build_deployment_info</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#ctx_origin"><span class="id" title="projection">ctx_origin</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ctx:518"><span class="id" title="variable">ctx</span></a>) (<a class="idref" href="ConCert.Execution.Blockchain.html#ctx_from"><span class="id" title="projection">ctx_from</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ctx:518"><span class="id" title="variable">ctx</span></a>) (<a class="idref" href="ConCert.Execution.Blockchain.html#ctx_amount"><span class="id" title="projection">ctx_amount</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ctx:518"><span class="id" title="variable">ctx</span></a>) <a class="idref" href="ConCert.Execution.Blockchain.html#setup:519"><span class="id" title="variable">setup</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#result:520"><span class="id" title="variable">result</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ConCert.Execution.Blockchain.html#ctx_amount"><span class="id" title="projection">ctx_amount</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ctx:518"><span class="id" title="variable">ctx</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Transfer/call/deploy&nbsp;to&nbsp;someone&nbsp;else&nbsp;*)</span><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">(</span></a><span class="id" title="keyword">forall</span> <a id="height:524" class="idref" href="#height:524"><span class="id" title="binder">height</span></a> <a id="slot:525" class="idref" href="#slot:525"><span class="id" title="binder">slot</span></a> <a id="fin_height:526" class="idref" href="#fin_height:526"><span class="id" title="binder">fin_height</span></a> <a id="caddr:527" class="idref" href="#caddr:527"><span class="id" title="binder">caddr</span></a> <a id="dep_info:528" class="idref" href="#dep_info:528"><span class="id" title="binder">dep_info</span></a> <a id="cstate:529" class="idref" href="#cstate:529"><span class="id" title="binder">cstate</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a id="balance:530" class="idref" href="#balance:530"><span class="id" title="binder">balance</span></a> <a id="out_act:531" class="idref" href="#out_act:531"><span class="id" title="binder">out_act</span></a> <a id="out_acts:532" class="idref" href="#out_acts:532"><span class="id" title="binder">out_acts</span></a> <a id="inc_calls:533" class="idref" href="#inc_calls:533"><span class="id" title="binder">inc_calls</span></a> <a id="prev_out_txs:534" class="idref" href="#prev_out_txs:534"><span class="id" title="binder">prev_out_txs</span></a> <a id="tx:535" class="idref" href="#tx:535"><span class="id" title="binder">tx</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="IH:536" class="idref" href="#IH:536"><span class="id" title="binder">IH</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#P:493"><span class="id" title="variable">P</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#height:524"><span class="id" title="variable">height</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#slot:525"><span class="id" title="variable">slot</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#fin_height:526"><span class="id" title="variable">fin_height</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#caddr:527"><span class="id" title="variable">caddr</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#dep_info:528"><span class="id" title="variable">dep_info</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#cstate:529"><span class="id" title="variable">cstate</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#balance:530"><span class="id" title="variable">balance</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ConCert.Execution.Blockchain.html#out_act:531"><span class="id" title="variable">out_act</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#::list_scope:x_'::'_x"><span class="id" title="notation">::</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#out_acts:532"><span class="id" title="variable">out_acts</span></a>) <a class="idref" href="ConCert.Execution.Blockchain.html#inc_calls:533"><span class="id" title="variable">inc_calls</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#prev_out_txs:534"><span class="id" title="variable">prev_out_txs</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="tx_from_caddr:537" class="idref" href="#tx_from_caddr:537"><span class="id" title="binder">tx_from_caddr</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#tx_from"><span class="id" title="projection">tx_from</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#tx:535"><span class="id" title="variable">tx</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#caddr:527"><span class="id" title="variable">caddr</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="tx_amount_eq:538" class="idref" href="#tx_amount_eq:538"><span class="id" title="binder">tx_amount_eq</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#tx_amount"><span class="id" title="projection">tx_amount</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#tx:535"><span class="id" title="variable">tx</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#act_body_amount"><span class="id" title="definition">act_body_amount</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#out_act:531"><span class="id" title="variable">out_act</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="tx_act_match:540" class="idref" href="#tx_act_match:540"><span class="id" title="binder">tx_act_match</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="ConCert.Execution.Blockchain.html#out_act:531"><span class="id" title="variable">out_act</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="ConCert.Execution.Blockchain.html#act_transfer"><span class="id" title="constructor">act_transfer</span></a> <span class="id" title="var">to</span> <span class="id" title="var">amount</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#tx_to"><span class="id" title="projection">tx_to</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#tx:535"><span class="id" title="variable">tx</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="var">to</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#tx_amount"><span class="id" title="projection">tx_amount</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#tx:535"><span class="id" title="variable">tx</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="var">amount</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Execution.Blockchain.html#tx_body"><span class="id" title="projection">tx_body</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#tx:535"><span class="id" title="variable">tx</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#tx_empty"><span class="id" title="constructor">tx_empty</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#f031fe1957c4a4a8e217aa46af2b4e25"><span class="id" title="notation">\/</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#tx_body"><span class="id" title="projection">tx_body</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#tx:535"><span class="id" title="variable">tx</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#tx_call"><span class="id" title="constructor">tx_call</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="ConCert.Execution.Blockchain.html#act_deploy"><span class="id" title="constructor">act_deploy</span></a> <span class="id" title="var">amount</span> <span class="id" title="var">wc</span> <span class="id" title="var">setup</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#tx_amount"><span class="id" title="projection">tx_amount</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#tx:535"><span class="id" title="variable">tx</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="var">amount</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#tx_body"><span class="id" title="projection">tx_body</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#tx:535"><span class="id" title="variable">tx</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#tx_deploy"><span class="id" title="constructor">tx_deploy</span></a> <span class="id" title="var">wc</span> <span class="id" title="var">setup</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="ConCert.Execution.Blockchain.html#act_call"><span class="id" title="constructor">act_call</span></a> <span class="id" title="var">to</span> <span class="id" title="var">amount</span> <span class="id" title="var">msg</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#tx_to"><span class="id" title="projection">tx_to</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#tx:535"><span class="id" title="variable">tx</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="var">to</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#tx_amount"><span class="id" title="projection">tx_amount</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#tx:535"><span class="id" title="variable">tx</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="var">amount</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#tx_body"><span class="id" title="projection">tx_body</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#tx:535"><span class="id" title="variable">tx</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#tx_call"><span class="id" title="constructor">tx_call</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">msg</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="tag:541" class="idref" href="#tag:541"><span class="id" title="binder">tag</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#TagOutgoingAct"><span class="id" title="inductive">TagOutgoingAct</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#P:493"><span class="id" title="variable">P</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#height:524"><span class="id" title="variable">height</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#slot:525"><span class="id" title="variable">slot</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#fin_height:526"><span class="id" title="variable">fin_height</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#caddr:527"><span class="id" title="variable">caddr</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#dep_info:528"><span class="id" title="variable">dep_info</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#cstate:529"><span class="id" title="variable">cstate</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#balance:530"><span class="id" title="variable">balance</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.ZArith.BinInt.html#::Z_scope:x_'-'_x"><span class="id" title="notation">-</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#act_body_amount"><span class="id" title="definition">act_body_amount</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#out_act:531"><span class="id" title="variable">out_act</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#out_acts:532"><span class="id" title="variable">out_acts</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#inc_calls:533"><span class="id" title="variable">inc_calls</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#tx:535"><span class="id" title="variable">tx</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#::list_scope:x_'::'_x"><span class="id" title="notation">::</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#prev_out_txs:534"><span class="id" title="variable">prev_out_txs</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Non-recursive&nbsp;call&nbsp;*)</span><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">(</span></a><span class="id" title="keyword">forall</span> <a id="chain:542" class="idref" href="#chain:542"><span class="id" title="binder">chain</span></a> <a id="ctx:543" class="idref" href="#ctx:543"><span class="id" title="binder">ctx</span></a> <a id="dep_info:544" class="idref" href="#dep_info:544"><span class="id" title="binder">dep_info</span></a> <a id="prev_state:545" class="idref" href="#prev_state:545"><span class="id" title="binder">prev_state</span></a> <a id="msg:546" class="idref" href="#msg:546"><span class="id" title="binder">msg</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a id="prev_out_queue:547" class="idref" href="#prev_out_queue:547"><span class="id" title="binder">prev_out_queue</span></a> <a id="prev_inc_calls:548" class="idref" href="#prev_inc_calls:548"><span class="id" title="binder">prev_inc_calls</span></a> <a id="prev_out_txs:549" class="idref" href="#prev_out_txs:549"><span class="id" title="binder">prev_out_txs</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a id="new_state:550" class="idref" href="#new_state:550"><span class="id" title="binder">new_state</span></a> <a id="new_acts:551" class="idref" href="#new_acts:551"><span class="id" title="binder">new_acts</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="from_other:552" class="idref" href="#from_other:552"><span class="id" title="binder">from_other</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#ctx_from"><span class="id" title="projection">ctx_from</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ctx:543"><span class="id" title="variable">ctx</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'&lt;&gt;'_x"><span class="id" title="notation">&lt;&gt;</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ctx_contract_address"><span class="id" title="projection">ctx_contract_address</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ctx:543"><span class="id" title="variable">ctx</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="facts:553" class="idref" href="#facts:553"><span class="id" title="binder">facts</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#CallFacts:482"><span class="id" title="variable">CallFacts</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#chain:542"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ctx:543"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#prev_state:545"><span class="id" title="variable">prev_state</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#prev_out_queue:547"><span class="id" title="variable">prev_out_queue</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#prev_inc_calls:548"><span class="id" title="variable">prev_inc_calls</span></a>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="IH:554" class="idref" href="#IH:554"><span class="id" title="binder">IH</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#P:493"><span class="id" title="variable">P</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#chain_height"><span class="id" title="projection">chain_height</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#chain:542"><span class="id" title="variable">chain</span></a>) (<a class="idref" href="ConCert.Execution.Blockchain.html#current_slot"><span class="id" title="projection">current_slot</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#chain:542"><span class="id" title="variable">chain</span></a>) (<a class="idref" href="ConCert.Execution.Blockchain.html#finalized_height"><span class="id" title="projection">finalized_height</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#chain:542"><span class="id" title="variable">chain</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ConCert.Execution.Blockchain.html#ctx_contract_address"><span class="id" title="projection">ctx_contract_address</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ctx:543"><span class="id" title="variable">ctx</span></a>) <a class="idref" href="ConCert.Execution.Blockchain.html#dep_info:544"><span class="id" title="variable">dep_info</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#prev_state:545"><span class="id" title="variable">prev_state</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ConCert.Execution.Blockchain.html#ctx_contract_balance"><span class="id" title="projection">ctx_contract_balance</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ctx:543"><span class="id" title="variable">ctx</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.ZArith.BinInt.html#::Z_scope:x_'-'_x"><span class="id" title="notation">-</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ctx_amount"><span class="id" title="projection">ctx_amount</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ctx:543"><span class="id" title="variable">ctx</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#prev_out_queue:547"><span class="id" title="variable">prev_out_queue</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#prev_inc_calls:548"><span class="id" title="variable">prev_inc_calls</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#prev_out_txs:549"><span class="id" title="variable">prev_out_txs</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="receive_some:555" class="idref" href="#receive_some:555"><span class="id" title="binder">receive_some</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#receive"><span class="id" title="projection">receive</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#contract:466"><span class="id" title="variable">contract</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#chain:542"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ctx:543"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#prev_state:545"><span class="id" title="variable">prev_state</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#msg:546"><span class="id" title="variable">msg</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Execution.Blockchain.html#new_state:550"><span class="id" title="variable">new_state</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#new_acts:551"><span class="id" title="variable">new_acts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="tag:556" class="idref" href="#tag:556"><span class="id" title="binder">tag</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#TagNonrecursiveCall"><span class="id" title="inductive">TagNonrecursiveCall</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#P:493"><span class="id" title="variable">P</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#chain_height"><span class="id" title="projection">chain_height</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#chain:542"><span class="id" title="variable">chain</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ConCert.Execution.Blockchain.html#current_slot"><span class="id" title="projection">current_slot</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#chain:542"><span class="id" title="variable">chain</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ConCert.Execution.Blockchain.html#finalized_height"><span class="id" title="projection">finalized_height</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#chain:542"><span class="id" title="variable">chain</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ConCert.Execution.Blockchain.html#ctx_contract_address"><span class="id" title="projection">ctx_contract_address</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ctx:543"><span class="id" title="variable">ctx</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#dep_info:544"><span class="id" title="variable">dep_info</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#new_state:550"><span class="id" title="variable">new_state</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ConCert.Execution.Blockchain.html#ctx_contract_balance"><span class="id" title="projection">ctx_contract_balance</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ctx:543"><span class="id" title="variable">ctx</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ConCert.Execution.Blockchain.html#new_acts:551"><span class="id" title="variable">new_acts</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#bc347c51eaf667706ae54503b26d52c6"><span class="id" title="notation">++</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#prev_out_queue:547"><span class="id" title="variable">prev_out_queue</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ConCert.Execution.Blockchain.html#build_call_info"><span class="id" title="constructor">build_call_info</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#ctx_origin"><span class="id" title="projection">ctx_origin</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ctx:543"><span class="id" title="variable">ctx</span></a>) (<a class="idref" href="ConCert.Execution.Blockchain.html#ctx_from"><span class="id" title="projection">ctx_from</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ctx:543"><span class="id" title="variable">ctx</span></a>) (<a class="idref" href="ConCert.Execution.Blockchain.html#ctx_amount"><span class="id" title="projection">ctx_amount</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ctx:543"><span class="id" title="variable">ctx</span></a>) <a class="idref" href="ConCert.Execution.Blockchain.html#msg:546"><span class="id" title="variable">msg</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#::list_scope:x_'::'_x"><span class="id" title="notation">::</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#prev_inc_calls:548"><span class="id" title="variable">prev_inc_calls</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#prev_out_txs:549"><span class="id" title="variable">prev_out_txs</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Recursive&nbsp;call&nbsp;*)</span><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">(</span></a><span class="id" title="keyword">forall</span> <a id="chain:557" class="idref" href="#chain:557"><span class="id" title="binder">chain</span></a> <a id="ctx:558" class="idref" href="#ctx:558"><span class="id" title="binder">ctx</span></a> <a id="dep_info:559" class="idref" href="#dep_info:559"><span class="id" title="binder">dep_info</span></a> <a id="prev_state:560" class="idref" href="#prev_state:560"><span class="id" title="binder">prev_state</span></a> <a id="msg:561" class="idref" href="#msg:561"><span class="id" title="binder">msg</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a id="head:562" class="idref" href="#head:562"><span class="id" title="binder">head</span></a> <a id="prev_out_queue:563" class="idref" href="#prev_out_queue:563"><span class="id" title="binder">prev_out_queue</span></a> <a id="prev_inc_calls:564" class="idref" href="#prev_inc_calls:564"><span class="id" title="binder">prev_inc_calls</span></a> <a id="prev_out_txs:565" class="idref" href="#prev_out_txs:565"><span class="id" title="binder">prev_out_txs</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a id="new_state:566" class="idref" href="#new_state:566"><span class="id" title="binder">new_state</span></a> <a id="new_acts:567" class="idref" href="#new_acts:567"><span class="id" title="binder">new_acts</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="from_self:568" class="idref" href="#from_self:568"><span class="id" title="binder">from_self</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#ctx_from"><span class="id" title="projection">ctx_from</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ctx:558"><span class="id" title="variable">ctx</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ctx_contract_address"><span class="id" title="projection">ctx_contract_address</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ctx:558"><span class="id" title="variable">ctx</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="facts:569" class="idref" href="#facts:569"><span class="id" title="binder">facts</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#CallFacts:482"><span class="id" title="variable">CallFacts</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#chain:557"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ctx:558"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#prev_state:560"><span class="id" title="variable">prev_state</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#head:562"><span class="id" title="variable">head</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#::list_scope:x_'::'_x"><span class="id" title="notation">::</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#prev_out_queue:563"><span class="id" title="variable">prev_out_queue</span></a>) (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#prev_inc_calls:564"><span class="id" title="variable">prev_inc_calls</span></a>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="IH:570" class="idref" href="#IH:570"><span class="id" title="binder">IH</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#P:493"><span class="id" title="variable">P</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#chain_height"><span class="id" title="projection">chain_height</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#chain:557"><span class="id" title="variable">chain</span></a>) (<a class="idref" href="ConCert.Execution.Blockchain.html#current_slot"><span class="id" title="projection">current_slot</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#chain:557"><span class="id" title="variable">chain</span></a>) (<a class="idref" href="ConCert.Execution.Blockchain.html#finalized_height"><span class="id" title="projection">finalized_height</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#chain:557"><span class="id" title="variable">chain</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ConCert.Execution.Blockchain.html#ctx_contract_address"><span class="id" title="projection">ctx_contract_address</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ctx:558"><span class="id" title="variable">ctx</span></a>) <a class="idref" href="ConCert.Execution.Blockchain.html#dep_info:559"><span class="id" title="variable">dep_info</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#prev_state:560"><span class="id" title="variable">prev_state</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ConCert.Execution.Blockchain.html#ctx_contract_balance"><span class="id" title="projection">ctx_contract_balance</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ctx:558"><span class="id" title="variable">ctx</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ConCert.Execution.Blockchain.html#head:562"><span class="id" title="variable">head</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#::list_scope:x_'::'_x"><span class="id" title="notation">::</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#prev_out_queue:563"><span class="id" title="variable">prev_out_queue</span></a>) <a class="idref" href="ConCert.Execution.Blockchain.html#prev_inc_calls:564"><span class="id" title="variable">prev_inc_calls</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#prev_out_txs:565"><span class="id" title="variable">prev_out_txs</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="action_facts:572" class="idref" href="#action_facts:572"><span class="id" title="binder">action_facts</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="ConCert.Execution.Blockchain.html#head:562"><span class="id" title="variable">head</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="ConCert.Execution.Blockchain.html#act_transfer"><span class="id" title="constructor">act_transfer</span></a> <span class="id" title="var">to</span> <span class="id" title="var">amount</span> =&gt; <span class="id" title="var">to</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ctx_contract_address"><span class="id" title="projection">ctx_contract_address</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ctx:558"><span class="id" title="variable">ctx</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">amount</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ctx_amount"><span class="id" title="projection">ctx_amount</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ctx:558"><span class="id" title="variable">ctx</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#msg:561"><span class="id" title="variable">msg</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="ConCert.Execution.Blockchain.html#act_call"><span class="id" title="constructor">act_call</span></a> <span class="id" title="var">to</span> <span class="id" title="var">amount</span> <span class="id" title="var">msg_ser</span> =&gt; <span class="id" title="var">to</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ctx_contract_address"><span class="id" title="projection">ctx_contract_address</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ctx:558"><span class="id" title="variable">ctx</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">amount</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ctx_amount"><span class="id" title="projection">ctx_amount</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ctx:558"><span class="id" title="variable">ctx</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#msg:561"><span class="id" title="variable">msg</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'&lt;&gt;'_x"><span class="id" title="notation">&lt;&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Serializable.html#deserialize"><span class="id" title="method">deserialize</span></a> <span class="id" title="var">msg_ser</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#msg:561"><span class="id" title="variable">msg</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#False"><span class="id" title="inductive">False</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="receive_some:573" class="idref" href="#receive_some:573"><span class="id" title="binder">receive_some</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#receive"><span class="id" title="projection">receive</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#contract:466"><span class="id" title="variable">contract</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#chain:557"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ctx:558"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#prev_state:560"><span class="id" title="variable">prev_state</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#msg:561"><span class="id" title="variable">msg</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Execution.Blockchain.html#new_state:566"><span class="id" title="variable">new_state</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#new_acts:567"><span class="id" title="variable">new_acts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="tag:574" class="idref" href="#tag:574"><span class="id" title="binder">tag</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#TagRecursiveCall"><span class="id" title="inductive">TagRecursiveCall</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#P:493"><span class="id" title="variable">P</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#chain_height"><span class="id" title="projection">chain_height</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#chain:557"><span class="id" title="variable">chain</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ConCert.Execution.Blockchain.html#current_slot"><span class="id" title="projection">current_slot</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#chain:557"><span class="id" title="variable">chain</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ConCert.Execution.Blockchain.html#finalized_height"><span class="id" title="projection">finalized_height</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#chain:557"><span class="id" title="variable">chain</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ConCert.Execution.Blockchain.html#ctx_contract_address"><span class="id" title="projection">ctx_contract_address</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ctx:558"><span class="id" title="variable">ctx</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#dep_info:559"><span class="id" title="variable">dep_info</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#new_state:566"><span class="id" title="variable">new_state</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ConCert.Execution.Blockchain.html#ctx_contract_balance"><span class="id" title="projection">ctx_contract_balance</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ctx:558"><span class="id" title="variable">ctx</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ConCert.Execution.Blockchain.html#new_acts:567"><span class="id" title="variable">new_acts</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#bc347c51eaf667706ae54503b26d52c6"><span class="id" title="notation">++</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#prev_out_queue:563"><span class="id" title="variable">prev_out_queue</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ConCert.Execution.Blockchain.html#build_call_info"><span class="id" title="constructor">build_call_info</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#ctx_origin"><span class="id" title="projection">ctx_origin</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ctx:558"><span class="id" title="variable">ctx</span></a>) (<a class="idref" href="ConCert.Execution.Blockchain.html#ctx_from"><span class="id" title="projection">ctx_from</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ctx:558"><span class="id" title="variable">ctx</span></a>) (<a class="idref" href="ConCert.Execution.Blockchain.html#ctx_amount"><span class="id" title="projection">ctx_amount</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ctx:558"><span class="id" title="variable">ctx</span></a>) <a class="idref" href="ConCert.Execution.Blockchain.html#msg:561"><span class="id" title="variable">msg</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#::list_scope:x_'::'_x"><span class="id" title="notation">::</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#prev_inc_calls:564"><span class="id" title="variable">prev_inc_calls</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ConCert.Execution.Blockchain.html#build_tx"><span class="id" title="constructor">build_tx</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#ctx_origin"><span class="id" title="projection">ctx_origin</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ctx:558"><span class="id" title="variable">ctx</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ConCert.Execution.Blockchain.html#ctx_from"><span class="id" title="projection">ctx_from</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ctx:558"><span class="id" title="variable">ctx</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ConCert.Execution.Blockchain.html#ctx_contract_address"><span class="id" title="projection">ctx_contract_address</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ctx:558"><span class="id" title="variable">ctx</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ConCert.Execution.Blockchain.html#ctx_amount"><span class="id" title="projection">ctx_amount</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ctx:558"><span class="id" title="variable">ctx</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ConCert.Execution.Blockchain.html#tx_call"><span class="id" title="constructor">tx_call</span></a> (<span class="id" title="keyword">match</span> <a class="idref" href="ConCert.Execution.Blockchain.html#head:562"><span class="id" title="variable">head</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="ConCert.Execution.Blockchain.html#act_call"><span class="id" title="constructor">act_call</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">msg</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#msg:561"><span class="id" title="variable">msg</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>)) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#::list_scope:x_'::'_x"><span class="id" title="notation">::</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#prev_out_txs:565"><span class="id" title="variable">prev_out_txs</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Queue&nbsp;permutation&nbsp;*)</span><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">(</span></a><span class="id" title="keyword">forall</span> <a id="height:576" class="idref" href="#height:576"><span class="id" title="binder">height</span></a> <a id="slot:577" class="idref" href="#slot:577"><span class="id" title="binder">slot</span></a> <a id="fin_height:578" class="idref" href="#fin_height:578"><span class="id" title="binder">fin_height</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a id="caddr:579" class="idref" href="#caddr:579"><span class="id" title="binder">caddr</span></a> <a id="dep_info:580" class="idref" href="#dep_info:580"><span class="id" title="binder">dep_info</span></a> <a id="cstate:581" class="idref" href="#cstate:581"><span class="id" title="binder">cstate</span></a> <a id="balance:582" class="idref" href="#balance:582"><span class="id" title="binder">balance</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a id="out_queue:583" class="idref" href="#out_queue:583"><span class="id" title="binder">out_queue</span></a> <a id="inc_calls:584" class="idref" href="#inc_calls:584"><span class="id" title="binder">inc_calls</span></a> <a id="out_txs:585" class="idref" href="#out_txs:585"><span class="id" title="binder">out_txs</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a id="out_queue':586" class="idref" href="#out_queue':586"><span class="id" title="binder">out_queue'</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="IH:587" class="idref" href="#IH:587"><span class="id" title="binder">IH</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#P:493"><span class="id" title="variable">P</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#height:576"><span class="id" title="variable">height</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#slot:577"><span class="id" title="variable">slot</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#fin_height:578"><span class="id" title="variable">fin_height</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#caddr:579"><span class="id" title="variable">caddr</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#dep_info:580"><span class="id" title="variable">dep_info</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#cstate:581"><span class="id" title="variable">cstate</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#balance:582"><span class="id" title="variable">balance</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#out_queue:583"><span class="id" title="variable">out_queue</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#inc_calls:584"><span class="id" title="variable">inc_calls</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#out_txs:585"><span class="id" title="variable">out_txs</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="perm:588" class="idref" href="#perm:588"><span class="id" title="binder">perm</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Sorting.Permutation.html#Permutation"><span class="id" title="inductive">Permutation</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#out_queue:583"><span class="id" title="variable">out_queue</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#out_queue':586"><span class="id" title="variable">out_queue'</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="tag:589" class="idref" href="#tag:589"><span class="id" title="binder">tag</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#TagPermuteQueue"><span class="id" title="inductive">TagPermuteQueue</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#P:493"><span class="id" title="variable">P</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#height:576"><span class="id" title="variable">height</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#slot:577"><span class="id" title="variable">slot</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#fin_height:578"><span class="id" title="variable">fin_height</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#caddr:579"><span class="id" title="variable">caddr</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#dep_info:580"><span class="id" title="variable">dep_info</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#cstate:581"><span class="id" title="variable">cstate</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#balance:582"><span class="id" title="variable">balance</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#out_queue':586"><span class="id" title="variable">out_queue'</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#inc_calls:584"><span class="id" title="variable">inc_calls</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#out_txs:585"><span class="id" title="variable">out_txs</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <a id="bstate:590" class="idref" href="#bstate:590"><span class="id" title="binder">bstate</span></a> <a id="caddr:591" class="idref" href="#caddr:591"><span class="id" title="binder">caddr</span></a> (<a id="trace:592" class="idref" href="#trace:592"><span class="id" title="binder">trace</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#ChainTrace"><span class="id" title="definition">ChainTrace</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#empty_state"><span class="id" title="definition">empty_state</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#bstate:590"><span class="id" title="variable">bstate</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#env_contracts"><span class="id" title="projection">env_contracts</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#bstate:590"><span class="id" title="variable">bstate</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#caddr:591"><span class="id" title="variable">caddr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#contract:466"><span class="id" title="variable">contract</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#WeakContract"><span class="id" title="inductive">WeakContract</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">exists</span></a> <a id="dep:593" class="idref" href="#dep:593"><span class="id" title="binder">dep</span></a> <a id="cstate:594" class="idref" href="#cstate:594"><span class="id" title="binder">cstate</span></a> <a id="inc_calls:595" class="idref" href="#inc_calls:595"><span class="id" title="binder">inc_calls</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#deployment_info"><span class="id" title="definition">deployment_info</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Setup:460"><span class="id" title="variable">Setup</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#trace:592"><span class="id" title="variable">trace</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#caddr:591"><span class="id" title="variable">caddr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#dep:593"><span class="id" title="variable">dep</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#contract_state"><span class="id" title="definition">contract_state</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#bstate:590"><span class="id" title="variable">bstate</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#caddr:591"><span class="id" title="variable">caddr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#cstate:594"><span class="id" title="variable">cstate</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#incoming_calls"><span class="id" title="definition">incoming_calls</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Msg:461"><span class="id" title="variable">Msg</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#trace:592"><span class="id" title="variable">trace</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#caddr:591"><span class="id" title="variable">caddr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#inc_calls:595"><span class="id" title="variable">inc_calls</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#P:493"><span class="id" title="variable">P</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#chain_height"><span class="id" title="projection">chain_height</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#bstate:590"><span class="id" title="variable">bstate</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ConCert.Execution.Blockchain.html#current_slot"><span class="id" title="projection">current_slot</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#bstate:590"><span class="id" title="variable">bstate</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ConCert.Execution.Blockchain.html#finalized_height"><span class="id" title="projection">finalized_height</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#bstate:590"><span class="id" title="variable">bstate</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#caddr:591"><span class="id" title="variable">caddr</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#dep:593"><span class="id" title="variable">dep</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#cstate:594"><span class="id" title="variable">cstate</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ConCert.Execution.Blockchain.html#env_account_balances"><span class="id" title="projection">env_account_balances</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#bstate:590"><span class="id" title="variable">bstate</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#caddr:591"><span class="id" title="variable">caddr</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ConCert.Execution.Blockchain.html#outgoing_acts"><span class="id" title="definition">outgoing_acts</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#bstate:590"><span class="id" title="variable">bstate</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#caddr:591"><span class="id" title="variable">caddr</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#inc_calls:595"><span class="id" title="variable">inc_calls</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ConCert.Execution.Blockchain.html#outgoing_txs"><span class="id" title="definition">outgoing_txs</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#trace:592"><span class="id" title="variable">trace</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#caddr:591"><span class="id" title="variable">caddr</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">establish_facts</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">add_block_case</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">init_case</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">transfer_case</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">nonrecursive_call_case</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">recursive_call_case</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">permute_queue_case</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">bstate</span> <span class="id" title="var">caddr</span> <span class="id" title="var">trace</span> <span class="id" title="var">contract_deployed</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#address_is_contract"><span class="id" title="method">address_is_contract</span></a> <span class="id" title="var">caddr</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a>) <span class="id" title="keyword">as</span> <span class="id" title="var">is_contract</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> (<span class="id" title="tactic">eapply</span> <a class="idref" href="ConCert.Execution.Blockchain.html#contract_addr_format"><span class="id" title="lemma">contract_addr_format</span></a>; <span class="id" title="tactic">eauto</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="ConCert.Execution.Blockchain.html#contract_state"><span class="id" title="definition">contract_state</span></a> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;<span class="id" title="var">remember</span> <a class="idref" href="ConCert.Execution.Blockchain.html#empty_state"><span class="id" title="definition">empty_state</span></a>; <span class="id" title="tactic">induction</span> <span class="id" title="var">trace</span> <span class="id" title="keyword">as</span> [|? ? ? ? <span class="id" title="var">IH</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>; <span class="id" title="tactic">subst</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">solve</span> [<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="tactic">congruence</span>].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">IH</span> <span class="id" title="keyword">ltac</span>:(<span class="id" title="tactic">auto</span>) <span class="id" title="keyword">ltac</span>:(<span class="id" title="tactic">auto</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">establish_facts</span> <span class="id" title="var">mid</span> <span class="id" title="var">to</span> <span class="id" title="keyword">ltac</span>:(<span class="id" title="tactic">auto</span>) <span class="id" title="keyword">ltac</span>:(<span class="id" title="tactic">auto</span>) <a class="idref" href="ConCert.Execution.Blockchain.html#tag_facts"><span class="id" title="constructor">tag_facts</span></a>).<br/>
&nbsp;&nbsp;<span class="id" title="var">destruct_chain_step</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;[|<span class="id" title="tactic">clear</span> <span class="id" title="var">add_block_case</span>; <span class="id" title="var">destruct_action_eval</span>; <span class="id" title="var">rewrite_environment_equiv</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *| |].<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;New&nbsp;block&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">clear</span> <span class="id" title="var">init_case</span> <span class="id" title="var">recursive_call_case</span> <span class="id" title="var">nonrecursive_call_case</span> <span class="id" title="var">permute_queue_case</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rewrite_environment_equiv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">specialize_hypotheses</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">IH</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">depinfo'</span> &amp; <span class="id" title="var">cstate'</span> &amp; <span class="id" title="var">inc_calls'</span> &amp; -&gt; &amp; ? &amp; -&gt; &amp; ?).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exists</span> <span class="id" title="var">depinfo'</span>, <span class="id" title="var">cstate'</span>, <span class="id" title="var">inc_calls'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rewrite_environment_equiv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> <span class="id" title="tactic">split</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">valid_header</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">destruct_address_eq</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Execution.Blockchain.html#outgoing_acts_after_block_nil"><span class="id" title="lemma">outgoing_acts_after_block_nil</span></a> <span class="id" title="tactic">by</span> <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="ConCert.Execution.Blockchain.html#outgoing_acts"><span class="id" title="definition">outgoing_acts</span></a> <span class="id" title="tactic">in</span> *; <span class="id" title="tactic">rewrite</span> <span class="id" title="var">queue_prev</span> <span class="id" title="tactic">in</span> *; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="var">add_block_case</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <span class="id" title="var">establish_facts</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;Evaluation:&nbsp;transfer&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">clear</span> <span class="id" title="var">init_case</span> <span class="id" title="var">recursive_call_case</span> <span class="id" title="var">nonrecursive_call_case</span> <span class="id" title="var">permute_queue_case</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">specialize_hypotheses</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">IH</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">depinfo'</span> &amp; <span class="id" title="var">cstate'</span> &amp; <span class="id" title="var">inc_calls'</span> &amp; -&gt; &amp; ? &amp; -&gt; &amp; ?).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exists</span> <span class="id" title="var">depinfo'</span>, <span class="id" title="var">cstate'</span>, <span class="id" title="var">inc_calls'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rewrite_environment_equiv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> <span class="id" title="tactic">split</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#address_eq_sym"><span class="id" title="lemma">address_eq_sym</span></a> <span class="id" title="var">from_addr</span>) <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;Transfer&nbsp;cannot&nbsp;be&nbsp;to&nbsp;contract&nbsp;as&nbsp;that&nbsp;would&nbsp;be&nbsp;a<br/>
&nbsp;&nbsp;&nbsp;&nbsp;call.&nbsp;Resolve&nbsp;this&nbsp;now.&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#address_eqb_spec"><span class="id" title="method">address_eqb_spec</span></a> <span class="id" title="var">caddr</span> <span class="id" title="var">to_addr</span>) <span class="id" title="keyword">as</span> [-&gt;|];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="ConCert.Execution.Blockchain.html#outgoing_acts"><span class="id" title="definition">outgoing_acts</span></a> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">queue_prev</span>, <span class="id" title="var">queue_new</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| [ <span class="id" title="var">H</span> : <span class="id" title="var">act</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="var">_</span> |- <span class="id" title="var">_</span> ] =&gt; <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H</span> <span class="id" title="tactic">in</span> *<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#address_eq_sym"><span class="id" title="lemma">address_eq_sym</span></a> <span class="id" title="var">from_addr</span>) <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#address_eqb_spec"><span class="id" title="method">address_eqb_spec</span></a> <span class="id" title="var">caddr</span> <span class="id" title="var">from_addr</span>) <span class="id" title="keyword">as</span> [&lt;-|];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="comment">(*&nbsp;Transfer&nbsp;from&nbsp;contract&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">remember</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#act_transfer"><span class="id" title="constructor">act_transfer</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">out_act</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">replace</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.ZArith.BinInt.html#::Z_scope:'-'_x"><span class="id" title="notation">-</span></a><span class="id" title="var">amount</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a"><span class="id" title="notation">+</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#env_account_balances"><span class="id" title="projection">env_account_balances</span></a> <span class="id" title="var">mid</span> <span class="id" title="var">caddr</span>) <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ConCert.Execution.Blockchain.html#env_account_balances"><span class="id" title="projection">env_account_balances</span></a> <span class="id" title="var">mid</span> <span class="id" title="var">caddr</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.ZArith.BinInt.html#::Z_scope:x_'-'_x"><span class="id" title="notation">-</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#act_body_amount"><span class="id" title="definition">act_body_amount</span></a> <span class="id" title="var">out_act</span>) <span class="id" title="tactic">by</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="tactic">subst</span>; <span class="id" title="var">cbn</span>; <span class="id" title="var">lia</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">transfer_case</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="comment">(*&nbsp;Irrelevant&nbsp;transfer&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;Evaluation:&nbsp;Deploy&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">clear</span> <span class="id" title="var">recursive_call_case</span> <span class="id" title="var">nonrecursive_call_case</span> <span class="id" title="var">permute_queue_case</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#address_eq_sym"><span class="id" title="lemma">address_eq_sym</span></a> <span class="id" title="var">to_addr</span> <span class="id" title="var">caddr</span>) <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#address_eqb_spec"><span class="id" title="method">address_eqb_spec</span></a> <span class="id" title="var">caddr</span> <span class="id" title="var">to_addr</span>) <span class="id" title="keyword">as</span> [&lt;-|]; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="comment">(*&nbsp;Deployment&nbsp;of&nbsp;this&nbsp;contract&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">replace</span> <span class="id" title="var">wc</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">contract</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#WeakContract"><span class="id" title="inductive">WeakContract</span></a>) <span class="id" title="tactic">in</span> * <span class="id" title="tactic">by</span> <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [ <span class="id" title="var">H</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#wc_init"><span class="id" title="definition">wc_init</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">_</span> |- <span class="id" title="var">_</span> ] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#wc_init_strong"><span class="id" title="lemma">wc_init_strong</span></a> <span class="id" title="var">H</span>) <span class="id" title="keyword">as</span> (<span class="id" title="var">setup_strong</span> &amp; <span class="id" title="var">result_strong</span> &amp; <span class="id" title="var">deser_setup_eq</span> &amp; &lt;- &amp; <span class="id" title="var">init</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">deser_setup_eq</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exists</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#build_deployment_info"><span class="id" title="constructor">build_deployment_info</span></a> <span class="id" title="var">origin</span> <span class="id" title="var">from_addr</span> <span class="id" title="var">amount</span> <span class="id" title="var">setup_strong</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">result_strong</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rewrite_environment_equiv</span>; <span class="id" title="var">cbn</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Execution.Blockchain.html#address_eq_refl"><span class="id" title="lemma">address_eq_refl</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Execution.Serializable.html#deserialize_serialize"><span class="id" title="method">deserialize_serialize</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#incoming_calls"><span class="id" title="definition">incoming_calls</span></a> <span class="id" title="var">Msg</span> <span class="id" title="var">trace</span> <span class="id" title="var">caddr</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> (<span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Execution.Blockchain.html#undeployed_contract_no_in_calls"><span class="id" title="lemma">undeployed_contract_no_in_calls</span></a>; <span class="id" title="tactic">auto</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="ConCert.Execution.Blockchain.html#incoming_calls"><span class="id" title="definition">incoming_calls</span></a> <span class="id" title="tactic">in</span> *; <span class="id" title="tactic">rewrite</span> <span class="id" title="var">is_contract</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> <span class="id" title="tactic">split</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="tactic">subst</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="ConCert.Execution.Blockchain.html#outgoing_acts"><span class="id" title="definition">outgoing_acts</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">queue_new</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#address_eq_sym"><span class="id" title="lemma">address_eq_sym</span></a> <span class="id" title="var">caddr</span>) <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">fold</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#outgoing_txs"><span class="id" title="definition">outgoing_txs</span></a> <span class="id" title="var">trace</span> <span class="id" title="var">caddr</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#undeployed_contract_no_out_queue"><span class="id" title="lemma">undeployed_contract_no_out_queue</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">caddr</span> <span class="id" title="var">mid</span> <span class="id" title="keyword">ltac</span>:(<span class="id" title="tactic">auto</span>) <span class="id" title="keyword">ltac</span>:(<span class="id" title="tactic">auto</span>) <span class="id" title="keyword">ltac</span>:(<span class="id" title="tactic">auto</span>)) <span class="id" title="keyword">as</span> <span class="id" title="var">queue_ne_to</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">queue_prev</span> <span class="id" title="tactic">in</span> <span class="id" title="var">queue_ne_to</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion_clear</span> <span class="id" title="var">queue_ne_to</span> <span class="id" title="keyword">as</span> [|? ? <span class="id" title="var">from_ne_to</span> <span class="id" title="var">rest_ne_to</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">from_ne_to</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#address_eq_ne"><span class="id" title="lemma">address_eq_ne</span></a> <span class="id" title="var">from_addr</span> <span class="id" title="var">caddr</span>) <span class="id" title="tactic">by</span> (<span class="id" title="var">destruct_address_eq</span>; <span class="id" title="tactic">auto</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Utils.Extras.html#Forall_false_filter_nil"><span class="id" title="lemma">Forall_false_filter_nil</span></a> <span class="id" title="tactic">by</span> <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Execution.Blockchain.html#undeployed_contract_no_out_txs"><span class="id" title="lemma">undeployed_contract_no_out_txs</span></a>, <a class="idref" href="ConCert.Execution.Blockchain.html#undeployed_contract_balance_0"><span class="id" title="lemma">undeployed_contract_balance_0</span></a> <span class="id" title="tactic">by</span> <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">remember</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#build_ctx"><span class="id" title="constructor">build_ctx</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">ctx</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">replace</span> <span class="id" title="var">origin</span> <span class="id" title="keyword">with</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#ctx_origin"><span class="id" title="projection">ctx_origin</span></a> <span class="id" title="var">ctx</span>) <span class="id" title="tactic">by</span> (<span class="id" title="tactic">subst</span>; <span class="id" title="tactic">auto</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">replace</span> <span class="id" title="var">from_addr</span> <span class="id" title="keyword">with</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#ctx_from"><span class="id" title="projection">ctx_from</span></a> <span class="id" title="var">ctx</span>) <span class="id" title="tactic">by</span> (<span class="id" title="tactic">subst</span>; <span class="id" title="tactic">auto</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">replace</span> <span class="id" title="var">caddr</span> <span class="id" title="keyword">with</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#ctx_contract_address"><span class="id" title="projection">ctx_contract_address</span></a> <span class="id" title="var">ctx</span>) <span class="id" title="tactic">by</span> (<span class="id" title="tactic">subst</span>; <span class="id" title="tactic">auto</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">replace</span> <span class="id" title="var">amount</span> <span class="id" title="keyword">with</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#ctx_amount"><span class="id" title="projection">ctx_amount</span></a> <span class="id" title="var">ctx</span>) <span class="id" title="tactic">by</span> (<span class="id" title="tactic">subst</span>; <span class="id" title="tactic">auto</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.ZArith.BinInt.html#Z.add_0_r"><span class="id" title="lemma">Z.add_0_r</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">init_case</span>;<span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="comment">(*&nbsp;Deployment&nbsp;of&nbsp;other&nbsp;contract,&nbsp;might&nbsp;be&nbsp;by&nbsp;this&nbsp;contract.&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">specialize_hypotheses</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">IH</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">depinfo</span> &amp; <span class="id" title="var">cstate</span> &amp; <span class="id" title="var">inc_calls</span> &amp; -&gt; &amp; ? &amp; -&gt; &amp; ?).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exists</span> <span class="id" title="var">depinfo</span>, <span class="id" title="var">cstate</span>, <span class="id" title="var">inc_calls</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rewrite_environment_equiv</span>; <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Execution.Blockchain.html#address_eq_ne"><span class="id" title="lemma">address_eq_ne</span></a> <span class="id" title="tactic">by</span> <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> <span class="id" title="tactic">split</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#address_eq_sym"><span class="id" title="lemma">address_eq_sym</span></a> <span class="id" title="var">caddr</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="ConCert.Execution.Blockchain.html#outgoing_acts"><span class="id" title="definition">outgoing_acts</span></a> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">queue_prev</span>, <span class="id" title="var">queue_new</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [ <span class="id" title="var">H</span> : <span class="id" title="var">act</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="var">_</span> |- <span class="id" title="var">_</span> ] =&gt; <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H</span> <span class="id" title="tactic">in</span> *<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">subst</span> <span class="id" title="var">new_acts</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">fold</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#outgoing_txs"><span class="id" title="definition">outgoing_txs</span></a> <span class="id" title="var">trace</span> <span class="id" title="var">caddr</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">destruct_address_eq</span>; <span class="id" title="tactic">subst</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;This&nbsp;contract&nbsp;deploys&nbsp;other&nbsp;contract&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">remember</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#act_deploy"><span class="id" title="constructor">act_deploy</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">abody</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">replace</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.ZArith.BinInt.html#::Z_scope:'-'_x"><span class="id" title="notation">-</span></a><span class="id" title="var">amount</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a"><span class="id" title="notation">+</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#env_account_balances"><span class="id" title="projection">env_account_balances</span></a> <span class="id" title="var">mid</span> <span class="id" title="var">caddr</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">with</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#env_account_balances"><span class="id" title="projection">env_account_balances</span></a> <span class="id" title="var">mid</span> <span class="id" title="var">caddr</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.ZArith.BinInt.html#::Z_scope:x_'-'_x"><span class="id" title="notation">-</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#act_body_amount"><span class="id" title="definition">act_body_amount</span></a> <span class="id" title="var">abody</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> (<span class="id" title="tactic">subst</span>; <span class="id" title="var">cbn</span>; <span class="id" title="var">lia</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">transfer_case</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;Evaluation:&nbsp;Call&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">clear</span> <span class="id" title="var">init_case</span> <span class="id" title="var">permute_queue_case</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">specialize_hypotheses</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [ <span class="id" title="var">H</span> : <span class="id" title="var">act</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="var">_</span> |- <span class="id" title="var">_</span> ] =&gt; <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H</span> <span class="id" title="tactic">in</span> *<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">subst</span> <span class="id" title="var">new_acts</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">IH</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">depinfo</span> &amp; <span class="id" title="var">cstate</span> &amp; <span class="id" title="var">inc_calls</span> &amp; -&gt; &amp; ? &amp; <span class="id" title="var">inc_calls_eq</span> &amp; <span class="id" title="var">IH</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;rewrite&nbsp;inc_calls_eq&nbsp;in&nbsp;*.&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="ConCert.Execution.Blockchain.html#outgoing_acts"><span class="id" title="definition">outgoing_acts</span></a> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">queue_prev</span>, <span class="id" title="var">queue_new</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Utils.Extras.html#filter_app"><span class="id" title="lemma">filter_app</span></a>, <a class="idref" href="ConCert.Utils.Extras.html#filter_map"><span class="id" title="lemma">filter_map</span></a>, <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Lists.List.html#map_app"><span class="id" title="lemma">map_app</span></a>, <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Lists.List.html#map_map"><span class="id" title="lemma">map_map</span></a>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#address_eqb_spec"><span class="id" title="method">address_eqb_spec</span></a> <span class="id" title="var">to_addr</span> <span class="id" title="var">caddr</span>) <span class="id" title="keyword">as</span> [-&gt;|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="comment">(*&nbsp;Call&nbsp;to&nbsp;contract&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">inc_calls_eq</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">replace</span> <span class="id" title="var">wc</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">contract</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#WeakContract"><span class="id" title="inductive">WeakContract</span></a>) <span class="id" title="tactic">in</span> * <span class="id" title="tactic">by</span> <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#wc_receive_strong"><span class="id" title="lemma">wc_receive_strong</span></a> <span class="id" title="keyword">ltac</span>:(<span class="id" title="var">eassumption</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">as</span> (<span class="id" title="var">prev_state_strong</span> &amp; <span class="id" title="var">msg_strong</span> &amp; <span class="id" title="var">resp_state_strong</span> &amp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">deser_state</span> &amp; <span class="id" title="var">deser_msg</span> &amp; &lt;- &amp; <span class="id" title="var">receive</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">replace</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#env_contract_states"><span class="id" title="projection">env_contract_states</span></a> <span class="id" title="var">mid</span> <span class="id" title="var">caddr</span>) <span class="id" title="keyword">with</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">prev_state</span>) <span class="id" title="tactic">in</span> * <span class="id" title="tactic">by</span> <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">replace</span> <span class="id" title="var">prev_state_strong</span> <span class="id" title="keyword">with</span> <span class="id" title="var">cstate</span> <span class="id" title="tactic">in</span> * <span class="id" title="tactic">by</span> <span class="id" title="tactic">congruence</span>; <span class="id" title="tactic">clear</span> <span class="id" title="var">prev_state_strong</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exists</span> <span class="id" title="var">depinfo</span>, <span class="id" title="var">resp_state_strong</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exists</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#build_call_info"><span class="id" title="constructor">build_call_info</span></a> <span class="id" title="var">origin</span> <span class="id" title="var">from_addr</span> <span class="id" title="var">amount</span> <span class="id" title="var">msg_strong</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#::list_scope:x_'::'_x"><span class="id" title="notation">::</span></a> <span class="id" title="var">inc_calls</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rewrite_environment_equiv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Execution.Blockchain.html#address_eq_refl"><span class="id" title="lemma">address_eq_refl</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Execution.Serializable.html#deserialize_serialize"><span class="id" title="method">deserialize_serialize</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> <span class="id" title="tactic">split</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">msg_strong</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">msg_strong</span>|], <span class="id" title="var">msg</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">msg</span>|];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="tactic">solve</span> [<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="tactic">congruence</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">replace</span> (<a class="idref" href="ConCert.Execution.Serializable.html#deserialize"><span class="id" title="method">deserialize</span></a> <span class="id" title="var">msg</span>) <span class="id" title="keyword">with</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">msg_strong</span>) <span class="id" title="tactic">by</span> <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#address_eq_sym"><span class="id" title="lemma">address_eq_sym</span></a> <span class="id" title="var">caddr</span>), <a class="idref" href="ConCert.Utils.Extras.html#filter_true"><span class="id" title="lemma">filter_true</span></a>, <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Lists.List.html#map_id"><span class="id" title="lemma">map_id</span></a>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#address_eqb_spec"><span class="id" title="method">address_eqb_spec</span></a> <span class="id" title="var">from_addr</span> <span class="id" title="var">caddr</span>) <span class="id" title="keyword">as</span> [-&gt;|?]; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">all</span>: <span class="id" title="tactic">rewrite</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#address_eq_refl"><span class="id" title="lemma">address_eq_refl</span></a> <span class="id" title="var">caddr</span>) <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="comment">(*&nbsp;Recursive&nbsp;call&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">remember</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#build_ctx"><span class="id" title="constructor">build_ctx</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">ctx</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">recursive_call_case</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ConCert.Execution.Blockchain.html#transfer_balance"><span class="id" title="definition">transfer_balance</span></a> <span class="id" title="var">caddr</span> <span class="id" title="var">caddr</span> <span class="id" title="var">amount</span> <span class="id" title="var">mid</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">ctx</span> <span class="id" title="var">depinfo</span> <span class="id" title="var">cstate</span> <span class="id" title="var">msg_strong</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">match</span> <span class="id" title="var">msg</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">msg</span> =&gt; <a class="idref" href="ConCert.Execution.Blockchain.html#act_call"><span class="id" title="constructor">act_call</span></a> <span class="id" title="var">caddr</span> <span class="id" title="var">amount</span> <span class="id" title="var">msg</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> =&gt; <a class="idref" href="ConCert.Execution.Blockchain.html#act_transfer"><span class="id" title="constructor">act_transfer</span></a> <span class="id" title="var">caddr</span> <span class="id" title="var">amount</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>)) <span class="id" title="keyword">as</span> <span class="id" title="tactic">case</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">subst</span> <span class="id" title="var">ctx</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="tactic">case</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">replace</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.ZArith.BinInt.html#::Z_scope:'-'_x"><span class="id" title="notation">-</span></a><span class="id" title="var">amount</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a"><span class="id" title="notation">+</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a"><span class="id" title="notation">(</span></a><span class="id" title="var">amount</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a"><span class="id" title="notation">+</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#env_account_balances"><span class="id" title="projection">env_account_balances</span></a> <span class="id" title="var">mid</span> <span class="id" title="var">caddr</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a"><span class="id" title="notation">)</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">with</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#env_account_balances"><span class="id" title="projection">env_account_balances</span></a> <span class="id" title="var">mid</span> <span class="id" title="var">caddr</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">in</span> * <span class="id" title="tactic">by</span> <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">msg_strong</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">msg_strong</span>|], <span class="id" title="var">msg</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">msg</span>|];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="comment">(*&nbsp;Someone&nbsp;else&nbsp;calls&nbsp;contract&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">remember</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#build_ctx"><span class="id" title="constructor">build_ctx</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">ctx</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">nonrecursive_call_case</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ConCert.Execution.Blockchain.html#transfer_balance"><span class="id" title="definition">transfer_balance</span></a> <span class="id" title="var">from_addr</span> <span class="id" title="var">caddr</span> <span class="id" title="var">amount</span> <span class="id" title="var">mid</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">ctx</span> <span class="id" title="var">depinfo</span> <span class="id" title="var">cstate</span> <span class="id" title="var">msg_strong</span>) <span class="id" title="keyword">as</span> <span class="id" title="tactic">case</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">subst</span> <span class="id" title="var">ctx</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="tactic">case</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#address_eq_ne"><span class="id" title="lemma">address_eq_ne</span></a> <span class="id" title="var">caddr</span> <span class="id" title="var">from_addr</span>) <span class="id" title="tactic">in</span> * <span class="id" title="tactic">by</span> (<span class="id" title="tactic">subst</span>; <span class="id" title="tactic">auto</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">replace</span> (<span class="id" title="var">amount</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a"><span class="id" title="notation">+</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#env_account_balances"><span class="id" title="projection">env_account_balances</span></a> <span class="id" title="var">mid</span> <span class="id" title="var">caddr</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.ZArith.BinInt.html#::Z_scope:x_'-'_x"><span class="id" title="notation">-</span></a> <span class="id" title="var">amount</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">with</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#env_account_balances"><span class="id" title="projection">env_account_balances</span></a> <span class="id" title="var">mid</span> <span class="id" title="var">caddr</span>) <span class="id" title="tactic">in</span> <span class="id" title="tactic">case</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">fold</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#outgoing_txs"><span class="id" title="definition">outgoing_txs</span></a> <span class="id" title="var">trace</span> <span class="id" title="var">caddr</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="tactic">case</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="comment">(*&nbsp;Call&nbsp;to&nbsp;other&nbsp;contract&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exists</span> <span class="id" title="var">depinfo</span>, <span class="id" title="var">cstate</span>, <span class="id" title="var">inc_calls</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rewrite_environment_equiv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Utils.Extras.html#filter_false"><span class="id" title="lemma">filter_false</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Execution.Blockchain.html#address_eq_ne"><span class="id" title="lemma">address_eq_ne</span></a> <span class="id" title="tactic">by</span> <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#address_eq_sym"><span class="id" title="lemma">address_eq_sym</span></a> <span class="id" title="var">caddr</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#address_eqb_spec"><span class="id" title="method">address_eqb_spec</span></a> <span class="id" title="var">from_addr</span> <span class="id" title="var">caddr</span>) <span class="id" title="keyword">as</span> [-&gt;|?].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="comment">(*&nbsp;Call&nbsp;from&nbsp;us&nbsp;to&nbsp;other&nbsp;contract&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> <span class="id" title="tactic">split</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">fold</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#outgoing_txs"><span class="id" title="definition">outgoing_txs</span></a> <span class="id" title="var">trace</span> <span class="id" title="var">caddr</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">msg</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">msg</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1: <span class="id" title="var">remember</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#act_call"><span class="id" title="constructor">act_call</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">abody</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2: <span class="id" title="var">remember</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#act_transfer"><span class="id" title="constructor">act_transfer</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">abody</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1, 2: <span class="id" title="tactic">replace</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.ZArith.BinInt.html#::Z_scope:'-'_x"><span class="id" title="notation">-</span></a><span class="id" title="var">amount</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a"><span class="id" title="notation">+</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#env_account_balances"><span class="id" title="projection">env_account_balances</span></a> <span class="id" title="var">mid</span> <span class="id" title="var">caddr</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">with</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#env_account_balances"><span class="id" title="projection">env_account_balances</span></a> <span class="id" title="var">mid</span> <span class="id" title="var">caddr</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.ZArith.BinInt.html#::Z_scope:x_'-'_x"><span class="id" title="notation">-</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#act_body_amount"><span class="id" title="definition">act_body_amount</span></a> <span class="id" title="var">abody</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> (<span class="id" title="tactic">subst</span>; <span class="id" title="var">cbn</span>; <span class="id" title="var">lia</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1, 2: <span class="id" title="tactic">subst</span>; <span class="id" title="tactic">apply</span> <span class="id" title="var">transfer_case</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="comment">(*&nbsp;Irrelevant&nbsp;call.&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">fold</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#outgoing_txs"><span class="id" title="definition">outgoing_txs</span></a> <span class="id" title="var">trace</span> <span class="id" title="var">caddr</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;Invalid&nbsp;User&nbsp;Action&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rewrite_environment_equiv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">IH</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">depinfo</span> &amp; <span class="id" title="var">cstate</span> &amp; <span class="id" title="var">inc_calls</span> &amp; ? &amp; ? &amp; ? &amp; <span class="id" title="var">IH</span>); <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exists</span> <span class="id" title="var">depinfo</span>, <span class="id" title="var">cstate</span>, <span class="id" title="var">inc_calls</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> <span class="id" title="tactic">split</span>; <span class="id" title="var">rewrite_environment_equiv</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">outgoing_acts_eq</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#outgoing_acts"><span class="id" title="definition">outgoing_acts</span></a> <span class="id" title="var">mid</span> <span class="id" title="var">caddr</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#outgoing_acts"><span class="id" title="definition">outgoing_acts</span></a> <span class="id" title="var">to</span> <span class="id" title="var">caddr</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">unfold</span> <a class="idref" href="ConCert.Execution.Blockchain.html#outgoing_acts"><span class="id" title="definition">outgoing_acts</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">setoid_rewrite</span> <span class="id" title="var">queue_new</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">setoid_rewrite</span> <span class="id" title="var">queue_prev</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="ConCert.Execution.Blockchain.html#act_is_from_account"><span class="id" title="definition">act_is_from_account</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">act_from_acc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">destruct_address_eq</span>; <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">outgoing_acts_eq</span> <span class="id" title="tactic">in</span> <span class="id" title="var">IH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">fold</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#outgoing_txs"><span class="id" title="definition">outgoing_txs</span></a> <span class="id" title="var">trace</span> <span class="id" title="var">caddr</span>).<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;Permutation&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rewrite_environment_equiv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">specialize_hypotheses</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">IH</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">depinfo</span> &amp; <span class="id" title="var">cstate</span> &amp; <span class="id" title="var">inc_calls</span> &amp; ? &amp; ? &amp; ? &amp; <span class="id" title="var">IH</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exists</span> <span class="id" title="var">depinfo</span>, <span class="id" title="var">cstate</span>, <span class="id" title="var">inc_calls</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rewrite_environment_equiv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> <span class="id" title="tactic">split</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="ConCert.Execution.Blockchain.html#outgoing_acts"><span class="id" title="definition">outgoing_acts</span></a> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">fold</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#outgoing_txs"><span class="id" title="definition">outgoing_txs</span></a> <span class="id" title="var">trace</span> <span class="id" title="var">caddr</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">permute_queue_case</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">out_queue</span> := <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Lists.List.html#map"><span class="id" title="definition">map</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#act_body"><span class="id" title="projection">act_body</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Lists.List.html#filter"><span class="id" title="definition">filter</span></a> (<span class="id" title="keyword">fun</span> <a id="a:599" class="idref" href="#a:599"><span class="id" title="binder">a</span></a> =&gt; (<a class="idref" href="ConCert.Execution.Blockchain.html#act_from"><span class="id" title="projection">act_from</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#a:598"><span class="id" title="variable">a</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#6f617e0e5500b437e5aeb1eaa876d41f"><span class="id" title="notation">=?</span></a> <span class="id" title="var">caddr</span>)%<span class="id" title="var">address</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ConCert.Execution.Blockchain.html#chain_state_queue"><span class="id" title="projection">chain_state_queue</span></a> <span class="id" title="var">mid</span>))); <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Sorting.Permutation.html#Permutation_map"><span class="id" title="lemma">Permutation_map</span></a>, <a class="idref" href="ConCert.Utils.Extras.html#Permutation_filter"><span class="id" title="lemma">Permutation_filter</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">End</span> <a class="idref" href="ConCert.Execution.Blockchain.html#Blockchain.Semantics.Trace.Theories"><span class="id" title="section">Theories</span></a>.<br/>
<span class="id" title="keyword">End</span> <a class="idref" href="ConCert.Execution.Blockchain.html#Blockchain.Semantics.Trace"><span class="id" title="section">Trace</span></a>.<br/>
<span class="id" title="keyword">End</span> <a class="idref" href="ConCert.Execution.Blockchain.html#Blockchain.Semantics"><span class="id" title="section">Semantics</span></a>.<br/>

<br/>
<span class="id" title="keyword">Inductive</span> <a id="ActionEvaluationError" class="idref" href="#ActionEvaluationError"><span class="id" title="inductive">ActionEvaluationError</span></a> :=<br/>
| <a id="amount_negative" class="idref" href="#amount_negative"><span class="id" title="constructor">amount_negative</span></a> <span class="comment">(*&nbsp;amount&nbsp;is&nbsp;negative&nbsp;*)</span><br/>
| <a id="amount_too_high" class="idref" href="#amount_too_high"><span class="id" title="constructor">amount_too_high</span></a> <span class="comment">(*&nbsp;sender&nbsp;does&nbsp;not&nbsp;have&nbsp;enough&nbsp;money&nbsp;*)</span><br/>
| <a id="no_such_contract" class="idref" href="#no_such_contract"><span class="id" title="constructor">no_such_contract</span></a> <span class="comment">(*&nbsp;there&nbsp;is&nbsp;not&nbsp;contract&nbsp;at&nbsp;that&nbsp;address&nbsp;*)</span><br/>
| <a id="too_many_contracts" class="idref" href="#too_many_contracts"><span class="id" title="constructor">too_many_contracts</span></a> <span class="comment">(*&nbsp;cannot&nbsp;generate&nbsp;fresh&nbsp;address&nbsp;for&nbsp;new&nbsp;contract&nbsp;*)</span><br/>
| <a id="init_failed" class="idref" href="#init_failed"><span class="id" title="constructor">init_failed</span></a> <span class="comment">(*&nbsp;contract&nbsp;init&nbsp;function&nbsp;failed&nbsp;*)</span><br/>
| <a id="receive_failed" class="idref" href="#receive_failed"><span class="id" title="constructor">receive_failed</span></a> <span class="comment">(*&nbsp;contract&nbsp;receive&nbsp;function&nbsp;failed&nbsp;*)</span><br/>
| <a id="internal_error" class="idref" href="#internal_error"><span class="id" title="constructor">internal_error</span></a>. <span class="comment">(*&nbsp;unexpected&nbsp;internal&nbsp;error&nbsp;*)</span><br/>

<br/>
<span class="id" title="keyword">Inductive</span> <a id="AddBlockError" class="idref" href="#AddBlockError"><span class="id" title="inductive">AddBlockError</span></a> :=<br/>
| <a id="invalid_header" class="idref" href="#invalid_header"><span class="id" title="constructor">invalid_header</span></a> <span class="comment">(*&nbsp;header&nbsp;for&nbsp;next&nbsp;block&nbsp;is&nbsp;invalid&nbsp;*)</span><br/>
| <a id="invalid_root_action" class="idref" href="#invalid_root_action"><span class="id" title="constructor">invalid_root_action</span></a> (<a id="act:604" class="idref" href="#act:604"><span class="id" title="binder">act</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Action"><span class="id" title="record">Action</span></a>) <span class="comment">(*&nbsp;a&nbsp;specified&nbsp;root&nbsp;action&nbsp;is&nbsp;invalid&nbsp;*)</span><br/>
| <a id="origin_from_mismatch" class="idref" href="#origin_from_mismatch"><span class="id" title="constructor">origin_from_mismatch</span></a> (<a id="act:605" class="idref" href="#act:605"><span class="id" title="binder">act</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Action"><span class="id" title="record">Action</span></a>) <span class="comment">(*&nbsp;origin&nbsp;and&nbsp;from&nbsp;addresses&nbsp;do&nbsp;not&nbsp;match&nbsp;for&nbsp;an&nbsp;action&nbsp;in&nbsp;a&nbsp;new&nbsp;block&nbsp;*)</span><br/>
| <a id="action_evaluation_depth_exceeded" class="idref" href="#action_evaluation_depth_exceeded"><span class="id" title="constructor">action_evaluation_depth_exceeded</span></a> <span class="comment">(*&nbsp;out&nbsp;of&nbsp;fuel&nbsp;while&nbsp;evaluating&nbsp;actions&nbsp;recursively&nbsp;*)</span><br/>
| <a id="action_evaluation_error" class="idref" href="#action_evaluation_error"><span class="id" title="constructor">action_evaluation_error</span></a> <span class="comment">(*&nbsp;error&nbsp;when&nbsp;evaluating&nbsp;single&nbsp;action&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a id="act:606" class="idref" href="#act:606"><span class="id" title="binder">act</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Action"><span class="id" title="record">Action</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a id="err:607" class="idref" href="#err:607"><span class="id" title="binder">err</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#ActionEvaluationError"><span class="id" title="inductive">ActionEvaluationError</span></a>).<br/>

<br/>
<span class="id" title="keyword">Class</span> <a id="ChainBuilderType" class="idref" href="#ChainBuilderType"><span class="id" title="record">ChainBuilderType</span></a> :=<br/>
&nbsp;&nbsp;<a id="build_builder" class="idref" href="#build_builder"><span class="id" title="constructor">build_builder</span></a> {<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a id="builder_type" class="idref" href="#builder_type"><span class="id" title="projection">builder_type</span></a> : <span class="id" title="keyword">Type</span>;<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a id="builder_initial" class="idref" href="#builder_initial"><span class="id" title="projection">builder_initial</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#builder_type:609"><span class="id" title="method">builder_type</span></a>;<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a id="builder_env" class="idref" href="#builder_env"><span class="id" title="projection">builder_env</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#builder_type:609"><span class="id" title="method">builder_type</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Environment"><span class="id" title="record">Environment</span></a>;<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a id="builder_add_block" class="idref" href="#builder_add_block"><span class="id" title="projection">builder_add_block</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="builder:612" class="idref" href="#builder:612"><span class="id" title="binder">builder</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#builder_type:609"><span class="id" title="method">builder_type</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="header:613" class="idref" href="#header:613"><span class="id" title="binder">header</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#BlockHeader"><span class="id" title="record">BlockHeader</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="actions:614" class="idref" href="#actions:614"><span class="id" title="binder">actions</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Action"><span class="id" title="record">Action</span></a>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.ResultMonad.html#result"><span class="id" title="inductive">result</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#builder_type:609"><span class="id" title="method">builder_type</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#AddBlockError"><span class="id" title="inductive">AddBlockError</span></a>;<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a id="builder_trace" class="idref" href="#builder_trace"><span class="id" title="projection">builder_trace</span></a> (<a id="builder:616" class="idref" href="#builder:616"><span class="id" title="binder">builder</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#builder_type:609"><span class="id" title="method">builder_type</span></a>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#ChainTrace"><span class="id" title="definition">ChainTrace</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#empty_state"><span class="id" title="definition">empty_state</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#build_chain_state"><span class="id" title="constructor">build_chain_state</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#builder_env:611"><span class="id" title="method">builder_env</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#builder:616"><span class="id" title="variable">builder</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a>);<br/>
&nbsp;&nbsp;}.<br/>

<br/>
<span class="id" title="keyword">Global</span> <a class="idref" href="ConCert.Execution.Blockchain.html#builder_type"><span class="id" title="method">Coercion</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#builder_type"><span class="id" title="method">builder_type</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#builder_type"><span class="id" title="method">:</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#builder_type"><span class="id" title="method">ChainBuilderType</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#builder_type"><span class="id" title="method">&gt;-&gt;</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#builder_type"><span class="id" title="method">Sortclass</span></a>.<br/>
<span class="id" title="keyword">Global</span> <a class="idref" href="ConCert.Execution.Blockchain.html#builder_env"><span class="id" title="method">Coercion</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#builder_env"><span class="id" title="method">builder_env</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#builder_env"><span class="id" title="method">:</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#builder_env"><span class="id" title="method">builder_type</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#builder_env"><span class="id" title="method">&gt;-&gt;</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#builder_env"><span class="id" title="method">Environment</span></a>.<br/>
<span class="id" title="keyword">End</span> <a class="idref" href="ConCert.Execution.Blockchain.html#Blockchain"><span class="id" title="section">Blockchain</span></a>.<br/>

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">destruct_chain_step</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| [<span class="id" title="var">step</span>: <a class="idref" href="ConCert.Execution.Blockchain.html#ChainStep"><span class="id" title="inductive">ChainStep</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> |- <span class="id" title="var">_</span>] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">step</span> <span class="id" title="keyword">as</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[?<span class="id" title="var">header</span> ?<span class="id" title="var">queue_prev</span> ?<span class="id" title="var">valid_header</span> ?<span class="id" title="var">acts_from_accs</span> ?<span class="id" title="var">origin_correct</span> ?<span class="id" title="var">env_eq</span>|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;?<span class="id" title="var">act</span> ?<span class="id" title="var">acts</span> ?<span class="id" title="var">new_acts</span> ?<span class="id" title="var">queue_prev</span> ?<span class="id" title="tactic">eval</span> ?<span class="id" title="var">queue_new</span>|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;?<span class="id" title="var">act</span> ?<span class="id" title="var">acts</span> ?<span class="id" title="var">env_eq</span> ?<span class="id" title="var">queue_prev</span> ?<span class="id" title="var">queue_new</span> ?<span class="id" title="var">act_from_acc</span> ?<span class="id" title="var">no_eval</span>|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;?<span class="id" title="var">env_eq</span> ?<span class="id" title="var">perm</span>]<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">destruct_action_eval</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| [<span class="id" title="tactic">eval</span>: <a class="idref" href="ConCert.Execution.Blockchain.html#ActionEvaluation"><span class="id" title="inductive">ActionEvaluation</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> |- <span class="id" title="var">_</span>] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="tactic">eval</span> <span class="id" title="keyword">as</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[?<span class="id" title="var">origin</span> ?<span class="id" title="var">from_addr</span> ?<span class="id" title="var">to_addr</span> ?<span class="id" title="var">amount</span> ?<span class="id" title="var">amount_nonnegative</span> ?<span class="id" title="var">enough_balance</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;?<span class="id" title="var">to_addr_not_contract</span> ?<span class="id" title="var">act_eq</span> ?<span class="id" title="var">env_eq</span> ?<span class="id" title="var">new_acts_eq</span> |<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;?<span class="id" title="var">origin</span> ?<span class="id" title="var">from_addr</span> ?<span class="id" title="var">to_addr</span> ?<span class="id" title="var">amount</span> ?<span class="id" title="var">wc</span> ?<span class="id" title="var">setup</span> ?<span class="id" title="var">state</span> ?<span class="id" title="var">amount_nonnegative</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;?<span class="id" title="var">enough_balance</span> ?<span class="id" title="var">to_addr_contract</span> ?<span class="id" title="var">not_deployed</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;?<span class="id" title="var">act_eq</span> ?<span class="id" title="var">init_some</span> ?<span class="id" title="var">env_eq</span> ?<span class="id" title="var">new_acts_eq</span> |<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;?<span class="id" title="var">origin</span> ?<span class="id" title="var">from_addr</span> ?<span class="id" title="var">to_addr</span> ?<span class="id" title="var">amount</span> ?<span class="id" title="var">wc</span> ?<span class="id" title="var">msg</span> ?<span class="id" title="var">prev_state</span> ?<span class="id" title="var">new_state</span> ?<span class="id" title="var">resp_acts</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;?<span class="id" title="var">amount_nonnegative</span> ?<span class="id" title="var">enough_balance</span> ?<span class="id" title="var">deployed</span> ?<span class="id" title="var">deployed_state</span> ?<span class="id" title="var">act_eq</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;?<span class="id" title="var">receive_some</span> ?<span class="id" title="var">new_acts_eq</span> ?<span class="id" title="var">env_eq</span> ]<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">rewrite_environment_equiv</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| [<span class="id" title="var">eq</span>: <a class="idref" href="ConCert.Execution.Blockchain.html#EnvironmentEquiv"><span class="id" title="record">EnvironmentEquiv</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> |- <span class="id" title="var">_</span>] =&gt; <span class="id" title="tactic">rewrite</span> <span class="id" title="var">eq</span> <span class="id" title="tactic">in</span> *<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Local Ltac</span> <span class="id" title="var">generalize_contract_statement_aux</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">bstate</span> <span class="id" title="var">caddr</span> <span class="id" title="var">trace</span> <span class="id" title="var">is_deployed</span> <span class="id" title="var">Setup</span> <span class="id" title="var">Msg</span> <span class="id" title="var">State</span> <span class="id" title="var">post</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">P</span> := <span class="id" title="tactic">fresh</span> "P" <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;<span class="id" title="tactic">evar</span> (<span class="id" title="var">P</span> : <span class="id" title="keyword">forall</span> (<a id="chain_height:618" class="idref" href="#chain_height:618"><span class="id" title="binder">chain_height</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>) (<a id="current_slot:619" class="idref" href="#current_slot:619"><span class="id" title="binder">current_slot</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>) (<a id="finalized_height:620" class="idref" href="#finalized_height:620"><span class="id" title="binder">finalized_height</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="caddr:621" class="idref" href="#caddr:621"><span class="id" title="binder">caddr</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a>) (<a id="deployment_info:622" class="idref" href="#deployment_info:622"><span class="id" title="binder">deployment_info</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#DeploymentInfo"><span class="id" title="record">DeploymentInfo</span></a> <span class="id" title="var">Setup</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="cstate:623" class="idref" href="#cstate:623"><span class="id" title="binder">cstate</span></a> : <span class="id" title="var">State</span>) (<a id="balance:624" class="idref" href="#balance:624"><span class="id" title="binder">balance</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Amount"><span class="id" title="definition">Amount</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="outgoing_actions_queued:625" class="idref" href="#outgoing_actions_queued:625"><span class="id" title="binder">outgoing_actions_queued</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ActionBody"><span class="id" title="inductive">ActionBody</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="incoming_calls_seen:626" class="idref" href="#incoming_calls_seen:626"><span class="id" title="binder">incoming_calls_seen</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#ContractCallInfo"><span class="id" title="record">ContractCallInfo</span></a> <span class="id" title="var">Msg</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="outgoing_txs_seen:627" class="idref" href="#outgoing_txs_seen:627"><span class="id" title="binder">outgoing_txs_seen</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Tx"><span class="id" title="record">Tx</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Prop</span>);<br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">H</span> := <span class="id" title="tactic">fresh</span> "H" <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;<span class="id" title="var">enough</span> (<span class="id" title="var">H</span>: <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">exists</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">(</span></a><a id="dep:628" class="idref" href="#dep:628"><span class="id" title="binder">dep</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#DeploymentInfo"><span class="id" title="record">DeploymentInfo</span></a> <span class="id" title="var">Setup</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="cstate:629" class="idref" href="#cstate:629"><span class="id" title="binder">cstate</span></a> : <span class="id" title="var">State</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="inc_calls:630" class="idref" href="#inc_calls:630"><span class="id" title="binder">inc_calls</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#ContractCallInfo"><span class="id" title="record">ContractCallInfo</span></a> <span class="id" title="var">Msg</span>)<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">),</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#deployment_info"><span class="id" title="definition">deployment_info</span></a> <span class="id" title="var">Setup</span> <span class="id" title="var">trace</span> <span class="id" title="var">caddr</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#dep:628"><span class="id" title="variable">dep</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#contract_state"><span class="id" title="definition">contract_state</span></a> <span class="id" title="var">bstate</span> <span class="id" title="var">caddr</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#cstate:629"><span class="id" title="variable">cstate</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#incoming_calls"><span class="id" title="definition">incoming_calls</span></a> <span class="id" title="var">Msg</span> <span class="id" title="var">trace</span> <span class="id" title="var">caddr</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#inc_calls:630"><span class="id" title="variable">inc_calls</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">P</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#chain_height"><span class="id" title="projection">chain_height</span></a> <span class="id" title="var">bstate</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ConCert.Execution.Blockchain.html#current_slot"><span class="id" title="projection">current_slot</span></a> <span class="id" title="var">bstate</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ConCert.Execution.Blockchain.html#finalized_height"><span class="id" title="projection">finalized_height</span></a> <span class="id" title="var">bstate</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">caddr</span> <a class="idref" href="ConCert.Execution.Blockchain.html#dep:628"><span class="id" title="variable">dep</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#cstate:629"><span class="id" title="variable">cstate</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ConCert.Execution.Blockchain.html#env_account_balances"><span class="id" title="projection">env_account_balances</span></a> <span class="id" title="var">bstate</span> <span class="id" title="var">caddr</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ConCert.Execution.Blockchain.html#outgoing_acts"><span class="id" title="definition">outgoing_acts</span></a> <span class="id" title="var">bstate</span> <span class="id" title="var">caddr</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#inc_calls:630"><span class="id" title="variable">inc_calls</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#outgoing_txs"><span class="id" title="definition">outgoing_txs</span></a> <span class="id" title="var">trace</span> <span class="id" title="var">caddr</span>));<br/>
&nbsp;&nbsp;[<span class="id" title="keyword">let</span> <span class="id" title="var">depinfo</span> := <span class="id" title="tactic">fresh</span> "depinfo" <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">cstate</span> := <span class="id" title="tactic">fresh</span> "cstate" <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">inc_calls</span> := <span class="id" title="tactic">fresh</span> "inc_calls" <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">depinfo_strong</span> := <span class="id" title="tactic">fresh</span> "depinfo_strong" <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">cstate_strong</span> := <span class="id" title="tactic">fresh</span> "cstate_strong" <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">inc_calls_strong</span> := <span class="id" title="tactic">fresh</span> "inc_calls_strong" <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">provenP</span> := <span class="id" title="tactic">fresh</span> "provenP" <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">H</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">depinfo</span> &amp; <span class="id" title="var">cstate</span> &amp; <span class="id" title="var">inc_calls</span> &amp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">depinfo_strong</span> &amp; <span class="id" title="var">cstate_strong</span> &amp; <span class="id" title="var">inc_calls_strong</span> &amp; <span class="id" title="var">provenP</span>);<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">repeat</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [|- <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">exists</span></a> <span class="id" title="var">_</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#DeploymentInfo"><span class="id" title="record">DeploymentInfo</span></a> <span class="id" title="var">Setup</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a> <span class="id" title="var">_</span>] =&gt; <span class="id" title="tactic">exists</span> <span class="id" title="var">depinfo</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [|- <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">exists</span></a> <span class="id" title="var">_</span> : <span class="id" title="var">State</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a> <span class="id" title="var">_</span>] =&gt; <span class="id" title="tactic">exists</span> <span class="id" title="var">cstate</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [|- <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">exists</span></a> <span class="id" title="var">_</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#ContractCallInfo"><span class="id" title="record">ContractCallInfo</span></a> <span class="id" title="var">Msg</span>)<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a> <span class="id" title="var">_</span>] =&gt; <span class="id" title="tactic">exists</span> <span class="id" title="var">inc_calls</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [|- ?<span class="id" title="var">a</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a> ?<span class="id" title="var">b</span>] =&gt; <span class="id" title="tactic">refine</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#conj"><span class="id" title="constructor">conj</span></a> <span class="id" title="var">depinfo_strong</span> <span class="id" title="var">_</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [|- ?<span class="id" title="var">a</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a> ?<span class="id" title="var">b</span>] =&gt; <span class="id" title="tactic">refine</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#conj"><span class="id" title="constructor">conj</span></a> <span class="id" title="var">cstate_strong</span> <span class="id" title="var">_</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [|- ?<span class="id" title="var">a</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a> ?<span class="id" title="var">b</span>] =&gt; <span class="id" title="tactic">refine</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#conj"><span class="id" title="constructor">conj</span></a> <span class="id" title="var">inc_calls_strong</span> <span class="id" title="var">_</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>;<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">pattern</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#chain_height"><span class="id" title="projection">chain_height</span></a> <span class="id" title="var">bstate</span>), (<a class="idref" href="ConCert.Execution.Blockchain.html#current_slot"><span class="id" title="projection">current_slot</span></a> <span class="id" title="var">bstate</span>), (<a class="idref" href="ConCert.Execution.Blockchain.html#finalized_height"><span class="id" title="projection">finalized_height</span></a> <span class="id" title="var">bstate</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">caddr</span>, <span class="id" title="var">depinfo</span>, <span class="id" title="var">cstate</span>, (<a class="idref" href="ConCert.Execution.Blockchain.html#env_account_balances"><span class="id" title="projection">env_account_balances</span></a> <span class="id" title="var">bstate</span> <span class="id" title="var">caddr</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ConCert.Execution.Blockchain.html#outgoing_acts"><span class="id" title="definition">outgoing_acts</span></a> <span class="id" title="var">bstate</span> <span class="id" title="var">caddr</span>), <span class="id" title="var">inc_calls</span>, (<a class="idref" href="ConCert.Execution.Blockchain.html#outgoing_txs"><span class="id" title="definition">outgoing_txs</span></a> <span class="id" title="var">trace</span> <span class="id" title="var">caddr</span>);<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;| [|- ?<span class="id" title="var">f</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>] =&gt; <span class="id" title="tactic">instantiate</span> (<span class="id" title="var">P</span> := <span class="id" title="var">f</span>); <span class="id" title="tactic">exact</span> <span class="id" title="var">provenP</span><br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">post</span> <span class="id" title="var">bstate</span> <span class="id" title="var">caddr</span> <span class="id" title="var">trace</span> <span class="id" title="var">is_deployed</span> <span class="id" title="var">Setup</span> <span class="id" title="var">Msg</span> <span class="id" title="var">State</span> <span class="id" title="var">P</span> ].<br/>

<br/>
<span class="id" title="keyword">Local Ltac</span> <span class="id" title="var">generalize_contract_statement_with_post</span> <span class="id" title="var">post</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>;<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| [<span class="id" title="var">bstate</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#ChainState"><span class="id" title="record">ChainState</span></a>, <span class="id" title="var">caddr</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a> |- <span class="id" title="var">_</span>] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [<span class="id" title="var">is_reachable</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#reachable"><span class="id" title="definition">reachable</span></a> <span class="id" title="var">bstate</span> |- <span class="id" title="var">_</span>] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">trace</span> := <span class="id" title="tactic">fresh</span> "trace" <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">is_reachable</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">trace</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="var">trace</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#ChainTrace"><span class="id" title="definition">ChainTrace</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#empty_state"><span class="id" title="definition">empty_state</span></a> <span class="id" title="var">bstate</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">is_deployed</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#env_contracts"><span class="id" title="projection">env_contracts</span></a> (<span class="id" title="var">_</span> <span class="id" title="var">bstate</span>) <span class="id" title="var">caddr</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#contract_to_weak_contract"><span class="id" title="definition">contract_to_weak_contract</span></a> ?<span class="id" title="var">c</span>) |- <span class="id" title="var">_</span>] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">type</span> <span class="id" title="keyword">of</span> <span class="id" title="var">c</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="ConCert.Execution.Blockchain.html#Contract"><span class="id" title="record">Contract</span></a> ?<span class="id" title="var">Setup</span> ?<span class="id" title="var">Msg</span> ?<span class="id" title="var">State</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">generalize_contract_statement_aux</span> <span class="id" title="var">bstate</span> <span class="id" title="var">caddr</span> <span class="id" title="var">trace</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">is_deployed</span> <span class="id" title="var">Setup</span> <span class="id" title="var">Msg</span> <span class="id" title="var">State</span> <span class="id" title="var">post</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">generalize_contract_statement</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="var">generalize_contract_statement_with_post</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">ltac</span>:(<span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">is_deployed</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">revert</span> <span class="id" title="var">is_deployed</span>).<br/>

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">contract_induction</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="var">generalize_contract_statement_with_post</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">ltac</span>:(<span class="id" title="keyword">fun</span> <span class="id" title="var">bstate</span> <span class="id" title="var">caddr</span> <span class="id" title="var">_</span> <span class="id" title="var">is_deployed</span> <span class="id" title="var">Setup</span> <span class="id" title="var">Msg</span> <span class="id" title="var">State</span> <span class="id" title="var">P</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">revert</span> <span class="id" title="var">is_deployed</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">AddBlockFacts</span> := <span class="id" title="tactic">fresh</span> "AddBlockFacts" <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">DeployFacts</span> := <span class="id" title="tactic">fresh</span> "DeployFacts" <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">CallFacts</span> := <span class="id" title="tactic">fresh</span> "CallFacts" <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">evar</span> (<span class="id" title="var">AddBlockFacts</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">forall</span> (<a id="chain_height:631" class="idref" href="#chain_height:631"><span class="id" title="binder">chain_height</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>) (<a id="current_slot:632" class="idref" href="#current_slot:632"><span class="id" title="binder">current_slot</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="finalized_height:633" class="idref" href="#finalized_height:633"><span class="id" title="binder">finalized_height</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>) (<a id="new_height:634" class="idref" href="#new_height:634"><span class="id" title="binder">new_height</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="new_slot:635" class="idref" href="#new_slot:635"><span class="id" title="binder">new_slot</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>) (<a id="new_finalized_height:636" class="idref" href="#new_finalized_height:636"><span class="id" title="binder">new_finalized_height</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>), <span class="id" title="keyword">Prop</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">evar</span> (<span class="id" title="var">DeployFacts</span> : <span class="id" title="keyword">forall</span> (<a id="chain:637" class="idref" href="#chain:637"><span class="id" title="binder">chain</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Chain"><span class="id" title="record">Chain</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="ctx:638" class="idref" href="#ctx:638"><span class="id" title="binder">ctx</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#ContractCallContext"><span class="id" title="record">ContractCallContext</span></a>), <span class="id" title="keyword">Prop</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">evar</span> (<span class="id" title="var">CallFacts</span> : <span class="id" title="keyword">forall</span> (<a id="chain:639" class="idref" href="#chain:639"><span class="id" title="binder">chain</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Chain"><span class="id" title="record">Chain</span></a>) (<a id="ctx:640" class="idref" href="#ctx:640"><span class="id" title="binder">ctx</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#ContractCallContext"><span class="id" title="record">ContractCallContext</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="cstate:641" class="idref" href="#cstate:641"><span class="id" title="binder">cstate</span></a> : <span class="id" title="var">State</span>) (<a id="outgoing_actions:642" class="idref" href="#outgoing_actions:642"><span class="id" title="binder">outgoing_actions</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ActionBody"><span class="id" title="inductive">ActionBody</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="inc_calls:643" class="idref" href="#inc_calls:643"><span class="id" title="binder">inc_calls</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#ContractCallInfo"><span class="id" title="record">ContractCallInfo</span></a> <span class="id" title="var">Msg</span>))), <span class="id" title="keyword">Prop</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#contract_induction"><span class="id" title="lemma">contract_induction</span></a> <span class="id" title="var">_</span> <span class="id" title="var">AddBlockFacts</span> <span class="id" title="var">DeployFacts</span> <span class="id" title="var">CallFacts</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">cbv</span> [<span class="id" title="var">P</span>]; <span class="id" title="tactic">clear</span> <span class="id" title="var">P</span>; <span class="id" title="var">cycle</span> 1; <span class="id" title="tactic">clear</span> <span class="id" title="tactic">dependent</span> <span class="id" title="var">bstate</span>; <span class="id" title="tactic">clear</span> <span class="id" title="tactic">dependent</span> <span class="id" title="var">caddr</span>).<br/>

<br/>
<span class="id" title="keyword">Global</span> <span class="id" title="keyword">Notation</span> "'Please' 'prove' 'your' 'facts'" := <a class="idref" href="ConCert.Execution.Blockchain.html#TagFacts"><span class="id" title="inductive">TagFacts</span></a> (<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 100, <span class="id" title="var">only</span> <span class="id" title="var">printing</span>).<br/>
<span class="id" title="keyword">Global</span> <span class="id" title="keyword">Notation</span> "'Please' 'reestablish' 'the' 'invariant' 'after' 'addition' 'of' 'a' 'block'"<br/>
&nbsp;&nbsp;:= <a class="idref" href="ConCert.Execution.Blockchain.html#TagAddBlock"><span class="id" title="inductive">TagAddBlock</span></a> (<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 100, <span class="id" title="var">only</span> <span class="id" title="var">printing</span>).<br/>
<span class="id" title="keyword">Global</span> <span class="id" title="keyword">Notation</span> "'Please' 'establish' 'the' 'invariant' 'after' 'deployment' 'of' 'the' 'contract'"<br/>
&nbsp;&nbsp;:= <a class="idref" href="ConCert.Execution.Blockchain.html#TagDeployment"><span class="id" title="inductive">TagDeployment</span></a> (<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 100, <span class="id" title="var">only</span> <span class="id" title="var">printing</span>).<br/>
<span class="id" title="keyword">Global</span> <span class="id" title="keyword">Notation</span> "'Please' 'reestablish' 'the' 'invariant' 'after' 'an' 'outgoing' 'action'"<br/>
&nbsp;&nbsp;:= <a class="idref" href="ConCert.Execution.Blockchain.html#TagOutgoingAct"><span class="id" title="inductive">TagOutgoingAct</span></a> (<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 100, <span class="id" title="var">only</span> <span class="id" title="var">printing</span>).<br/>
<span class="id" title="keyword">Global</span> <span class="id" title="keyword">Notation</span> "'Please' 'reestablish' 'the' 'invariant' 'after' 'a' 'nonrecursive' 'call'"<br/>
&nbsp;&nbsp;:= <a class="idref" href="ConCert.Execution.Blockchain.html#TagNonrecursiveCall"><span class="id" title="inductive">TagNonrecursiveCall</span></a> (<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 100, <span class="id" title="var">only</span> <span class="id" title="var">printing</span>).<br/>
<span class="id" title="keyword">Global</span> <span class="id" title="keyword">Notation</span> "'Please' 'reestablish' 'the' 'invariant' 'after' 'a' 'recursive' 'call'"<br/>
&nbsp;&nbsp;:= <a class="idref" href="ConCert.Execution.Blockchain.html#TagRecursiveCall"><span class="id" title="inductive">TagRecursiveCall</span></a> (<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 100, <span class="id" title="var">only</span> <span class="id" title="var">printing</span>).<br/>
<span class="id" title="keyword">Global</span> <span class="id" title="keyword">Notation</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"'Please' 'reestablish' 'the' 'invariant' 'after' 'permutation' 'of' 'the' 'action' 'queue'"<br/>
&nbsp;&nbsp;:= <a class="idref" href="ConCert.Execution.Blockchain.html#TagPermuteQueue"><span class="id" title="inductive">TagPermuteQueue</span></a> (<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 100, <span class="id" title="var">only</span> <span class="id" title="var">printing</span>).<br/>

<br/>
<span class="id" title="keyword">Section</span> <a id="LiftTransactionProp" class="idref" href="#LiftTransactionProp"><span class="id" title="section">LiftTransactionProp</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Context</span> {<a id="BaseTypes:644" class="idref" href="#BaseTypes:644"><span class="id" title="binder">BaseTypes</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#ChainBase"><span class="id" title="class">ChainBase</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<a id="Setup:645" class="idref" href="#Setup:645"><span class="id" title="binder">Setup</span></a> : <span class="id" title="keyword">Type</span>} `{<a id="H:646" class="idref" href="#H:646"><span class="id" title="binder">Serializable</span></a> <a id="H:646" class="idref" href="#H:646"><span class="id" title="binder">Setup</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<a id="Msg:647" class="idref" href="#Msg:647"><span class="id" title="binder">Msg</span></a> : <span class="id" title="keyword">Type</span>} `{<a id="H0:648" class="idref" href="#H0:648"><span class="id" title="binder">Serializable</span></a> <a id="H0:648" class="idref" href="#H0:648"><span class="id" title="binder">Msg</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<a id="State:649" class="idref" href="#State:649"><span class="id" title="binder">State</span></a> : <span class="id" title="keyword">Type</span>} `{<a id="H1:650" class="idref" href="#H1:650"><span class="id" title="binder">Serializable</span></a> <a id="H1:650" class="idref" href="#H1:650"><span class="id" title="binder">State</span></a>}.<br/>

<br/>
</div>

<div class="doc">
If some property <span class="inlinecode"><a class="idref" href="ConCert.Embedding.pcuic.PCUICTranslate.html#P"><span class="id" title="module">P</span></a></span> holds for all actions in the output of the receive function, the property can be lifted to all outgoing actions for all reachabile states. 
</div>
<div class="code">
<span class="id" title="keyword">Lemma</span> <a id="lift_outgoing_acts_prop" class="idref" href="#lift_outgoing_acts_prop"><span class="id" title="lemma">lift_outgoing_acts_prop</span></a> {<a id="P:651" class="idref" href="#P:651"><span class="id" title="binder">P</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#ActionBody"><span class="id" title="inductive">ActionBody</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <span class="id" title="keyword">Prop</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="contract:652" class="idref" href="#contract:652"><span class="id" title="binder">contract</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Contract"><span class="id" title="record">Contract</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#LiftTransactionProp.Setup"><span class="id" title="variable">Setup</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#LiftTransactionProp.Msg"><span class="id" title="variable">Msg</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#LiftTransactionProp.State"><span class="id" title="variable">State</span></a>) (<a id="bstate:653" class="idref" href="#bstate:653"><span class="id" title="binder">bstate</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#ChainState"><span class="id" title="record">ChainState</span></a>) (<a id="addr:654" class="idref" href="#addr:654"><span class="id" title="binder">addr</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a>) :<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#reachable"><span class="id" title="definition">reachable</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#bstate:653"><span class="id" title="variable">bstate</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">(</span></a><span class="id" title="keyword">forall</span> <a id="chain:655" class="idref" href="#chain:655"><span class="id" title="binder">chain</span></a> <a id="ctx:656" class="idref" href="#ctx:656"><span class="id" title="binder">ctx</span></a> <a id="cstate:657" class="idref" href="#cstate:657"><span class="id" title="binder">cstate</span></a> <a id="msg:658" class="idref" href="#msg:658"><span class="id" title="binder">msg</span></a> <a id="new_cstate:659" class="idref" href="#new_cstate:659"><span class="id" title="binder">new_cstate</span></a> <a id="acts:660" class="idref" href="#acts:660"><span class="id" title="binder">acts</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#contract:652"><span class="id" title="variable">contract</span></a>.(<a class="idref" href="ConCert.Execution.Blockchain.html#receive"><span class="id" title="projection">receive</span></a>) <a class="idref" href="ConCert.Execution.Blockchain.html#chain:655"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ctx:656"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#cstate:657"><span class="id" title="variable">cstate</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#msg:658"><span class="id" title="variable">msg</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Execution.Blockchain.html#new_cstate:659"><span class="id" title="variable">new_cstate</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#acts:660"><span class="id" title="variable">acts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Lists.List.html#Forall"><span class="id" title="inductive">Forall</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#P:651"><span class="id" title="variable">P</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#acts:660"><span class="id" title="variable">acts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#env_contracts"><span class="id" title="projection">env_contracts</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#bstate:653"><span class="id" title="variable">bstate</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#addr:654"><span class="id" title="variable">addr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#contract:652"><span class="id" title="variable">contract</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#WeakContract"><span class="id" title="inductive">WeakContract</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Lists.List.html#Forall"><span class="id" title="inductive">Forall</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#P:651"><span class="id" title="variable">P</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#outgoing_acts"><span class="id" title="definition">outgoing_acts</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#bstate:653"><span class="id" title="variable">bstate</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#addr:654"><span class="id" title="variable">addr</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">Hr</span> <span class="id" title="var">Hc</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">contract_induction</span>; <span class="id" title="tactic">intros</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">inversion_clear</span> <span class="id" title="var">IH</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Utils.Extras.html#Forall_app"><span class="id" title="lemma">Forall_app</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Utils.Extras.html#Forall_app"><span class="id" title="lemma">Forall_app</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion_clear</span> <span class="id" title="var">IH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">perm</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">instantiate</span> (<span class="id" title="var">AddBlockFacts</span> := <span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#True"><span class="id" title="inductive">Logic.True</span></a>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">instantiate</span> (<span class="id" title="var">DeployFacts</span> := <span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#True"><span class="id" title="inductive">Logic.True</span></a>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">instantiate</span> (<span class="id" title="var">CallFacts</span> := <span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#True"><span class="id" title="inductive">Logic.True</span></a>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">unset_all</span>; <span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">step</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">a</span>; <span class="id" title="tactic">auto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
If the receive function always returns an empty list of actions,
 the same holds for all reachable states 
</div>
<div class="code">
<span class="id" title="keyword">Lemma</span> <a id="lift_outgoing_acts_nil" class="idref" href="#lift_outgoing_acts_nil"><span class="id" title="lemma">lift_outgoing_acts_nil</span></a> (<a id="contract:661" class="idref" href="#contract:661"><span class="id" title="binder">contract</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Contract"><span class="id" title="record">Contract</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#LiftTransactionProp.Setup"><span class="id" title="variable">Setup</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#LiftTransactionProp.Msg"><span class="id" title="variable">Msg</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#LiftTransactionProp.State"><span class="id" title="variable">State</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="bstate:662" class="idref" href="#bstate:662"><span class="id" title="binder">bstate</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#ChainState"><span class="id" title="record">ChainState</span></a>) (<a id="addr:663" class="idref" href="#addr:663"><span class="id" title="binder">addr</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a>) :<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#reachable"><span class="id" title="definition">reachable</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#bstate:662"><span class="id" title="variable">bstate</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">(</span></a><span class="id" title="keyword">forall</span> <a id="chain:664" class="idref" href="#chain:664"><span class="id" title="binder">chain</span></a> <a id="ctx:665" class="idref" href="#ctx:665"><span class="id" title="binder">ctx</span></a> <a id="cstate:666" class="idref" href="#cstate:666"><span class="id" title="binder">cstate</span></a> <a id="msg:667" class="idref" href="#msg:667"><span class="id" title="binder">msg</span></a> <a id="new_cstate:668" class="idref" href="#new_cstate:668"><span class="id" title="binder">new_cstate</span></a> <a id="acts:669" class="idref" href="#acts:669"><span class="id" title="binder">acts</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#contract:661"><span class="id" title="variable">contract</span></a>.(<a class="idref" href="ConCert.Execution.Blockchain.html#receive"><span class="id" title="projection">receive</span></a>) <a class="idref" href="ConCert.Execution.Blockchain.html#chain:664"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ctx:665"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#cstate:666"><span class="id" title="variable">cstate</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#msg:667"><span class="id" title="variable">msg</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Execution.Blockchain.html#new_cstate:668"><span class="id" title="variable">new_cstate</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#acts:669"><span class="id" title="variable">acts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#acts:669"><span class="id" title="variable">acts</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#env_contracts"><span class="id" title="projection">env_contracts</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#bstate:662"><span class="id" title="variable">bstate</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#addr:663"><span class="id" title="variable">addr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#contract:661"><span class="id" title="variable">contract</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#WeakContract"><span class="id" title="inductive">WeakContract</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#outgoing_acts"><span class="id" title="definition">outgoing_acts</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#bstate:662"><span class="id" title="variable">bstate</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#addr:663"><span class="id" title="variable">addr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">enough</span> (<span class="id" title="var">all_false</span>: <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Lists.List.html#Forall"><span class="id" title="inductive">Forall</span></a> (<span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#False"><span class="id" title="inductive">False</span></a>) (<a class="idref" href="ConCert.Execution.Blockchain.html#outgoing_acts"><span class="id" title="definition">outgoing_acts</span></a> <span class="id" title="var">bstate</span> <span class="id" title="var">addr</span>)) <span class="id" title="tactic">by</span> (<span class="id" title="var">now</span> <span class="id" title="tactic">destruct</span> <span class="id" title="var">all_false</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#lift_outgoing_acts_prop"><span class="id" title="lemma">lift_outgoing_acts_prop</span></a> <span class="id" title="var">contract</span>); <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">erewrite</span> (<span class="id" title="var">H3</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">acts</span>); [<span class="id" title="tactic">constructor</span>|<span class="id" title="var">eassumption</span>].<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
If some property <span class="inlinecode"><a class="idref" href="ConCert.Embedding.pcuic.PCUICTranslate.html#P"><span class="id" title="module">P</span></a></span> holds for all contract states in the output of the receive function,
  the property can be lifted to all contract states for all reachabile states. 
</div>
<div class="code">
<span class="id" title="keyword">Lemma</span> <a id="lift_contract_state_prop" class="idref" href="#lift_contract_state_prop"><span class="id" title="lemma">lift_contract_state_prop</span></a> {<a id="P:670" class="idref" href="#P:670"><span class="id" title="binder">P</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#LiftTransactionProp.State"><span class="id" title="variable">State</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <span class="id" title="keyword">Prop</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="contract:671" class="idref" href="#contract:671"><span class="id" title="binder">contract</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Contract"><span class="id" title="record">Contract</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#LiftTransactionProp.Setup"><span class="id" title="variable">Setup</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#LiftTransactionProp.Msg"><span class="id" title="variable">Msg</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#LiftTransactionProp.State"><span class="id" title="variable">State</span></a>) (<a id="bstate:672" class="idref" href="#bstate:672"><span class="id" title="binder">bstate</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#ChainState"><span class="id" title="record">ChainState</span></a>) (<a id="addr:673" class="idref" href="#addr:673"><span class="id" title="binder">addr</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a>) :<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">(</span></a><span class="id" title="keyword">forall</span> <a id="chain:674" class="idref" href="#chain:674"><span class="id" title="binder">chain</span></a> <a id="ctx:675" class="idref" href="#ctx:675"><span class="id" title="binder">ctx</span></a> <a id="setup:676" class="idref" href="#setup:676"><span class="id" title="binder">setup</span></a> <a id="result:677" class="idref" href="#result:677"><span class="id" title="binder">result</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#contract:671"><span class="id" title="variable">contract</span></a>.(<a class="idref" href="ConCert.Execution.Blockchain.html#init"><span class="id" title="projection">init</span></a>) <a class="idref" href="ConCert.Execution.Blockchain.html#chain:674"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ctx:675"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#setup:676"><span class="id" title="variable">setup</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#result:677"><span class="id" title="variable">result</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#P:670"><span class="id" title="variable">P</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#result:677"><span class="id" title="variable">result</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">(</span></a><span class="id" title="keyword">forall</span> <a id="chain:678" class="idref" href="#chain:678"><span class="id" title="binder">chain</span></a> <a id="ctx:679" class="idref" href="#ctx:679"><span class="id" title="binder">ctx</span></a> <a id="cstate:680" class="idref" href="#cstate:680"><span class="id" title="binder">cstate</span></a> <a id="msg:681" class="idref" href="#msg:681"><span class="id" title="binder">msg</span></a> <a id="new_cstate:682" class="idref" href="#new_cstate:682"><span class="id" title="binder">new_cstate</span></a> <a id="acts:683" class="idref" href="#acts:683"><span class="id" title="binder">acts</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#P:670"><span class="id" title="variable">P</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#cstate:680"><span class="id" title="variable">cstate</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#contract:671"><span class="id" title="variable">contract</span></a>.(<a class="idref" href="ConCert.Execution.Blockchain.html#receive"><span class="id" title="projection">receive</span></a>) <a class="idref" href="ConCert.Execution.Blockchain.html#chain:678"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ctx:679"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#cstate:680"><span class="id" title="variable">cstate</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#msg:681"><span class="id" title="variable">msg</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Execution.Blockchain.html#new_cstate:682"><span class="id" title="variable">new_cstate</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#acts:683"><span class="id" title="variable">acts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#P:670"><span class="id" title="variable">P</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#new_cstate:682"><span class="id" title="variable">new_cstate</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#reachable"><span class="id" title="definition">reachable</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#bstate:672"><span class="id" title="variable">bstate</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#env_contracts"><span class="id" title="projection">env_contracts</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#bstate:672"><span class="id" title="variable">bstate</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#addr:673"><span class="id" title="variable">addr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#contract:671"><span class="id" title="variable">contract</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#WeakContract"><span class="id" title="inductive">WeakContract</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">exists</span></a> <a id="cstate:684" class="idref" href="#cstate:684"><span class="id" title="binder">cstate</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#contract_state"><span class="id" title="definition">contract_state</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#bstate:672"><span class="id" title="variable">bstate</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#addr:673"><span class="id" title="variable">addr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#cstate:684"><span class="id" title="variable">cstate</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#P:670"><span class="id" title="variable">P</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#cstate:684"><span class="id" title="variable">cstate</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">Hinit</span> <span class="id" title="var">Hreceive</span> <span class="id" title="var">Hreach</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">contract_induction</span>; <span class="id" title="tactic">intros</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <span class="id" title="var">Hinit</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <span class="id" title="var">Hreceive</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <span class="id" title="var">Hreceive</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">instantiate</span> (<span class="id" title="var">AddBlockFacts</span> := <span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#True"><span class="id" title="inductive">Logic.True</span></a>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">instantiate</span> (<span class="id" title="var">DeployFacts</span> := <span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#True"><span class="id" title="inductive">Logic.True</span></a>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">instantiate</span> (<span class="id" title="var">CallFacts</span> := <span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#True"><span class="id" title="inductive">Logic.True</span></a>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">unset_all</span>; <span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">step</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">a</span>; <span class="id" title="tactic">auto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="lift_dep_info_contract_state_prop" class="idref" href="#lift_dep_info_contract_state_prop"><span class="id" title="lemma">lift_dep_info_contract_state_prop</span></a> {<a id="P:685" class="idref" href="#P:685"><span class="id" title="binder">P</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#DeploymentInfo"><span class="id" title="record">DeploymentInfo</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#LiftTransactionProp.Setup"><span class="id" title="variable">Setup</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#LiftTransactionProp.State"><span class="id" title="variable">State</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <span class="id" title="keyword">Prop</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="contract:686" class="idref" href="#contract:686"><span class="id" title="binder">contract</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Contract"><span class="id" title="record">Contract</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#LiftTransactionProp.Setup"><span class="id" title="variable">Setup</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#LiftTransactionProp.Msg"><span class="id" title="variable">Msg</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#LiftTransactionProp.State"><span class="id" title="variable">State</span></a>) (<a id="bstate:687" class="idref" href="#bstate:687"><span class="id" title="binder">bstate</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#ChainState"><span class="id" title="record">ChainState</span></a>) (<a id="addr:688" class="idref" href="#addr:688"><span class="id" title="binder">addr</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="trace:689" class="idref" href="#trace:689"><span class="id" title="binder">trace</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#ChainTrace"><span class="id" title="definition">ChainTrace</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#empty_state"><span class="id" title="definition">empty_state</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#bstate:687"><span class="id" title="variable">bstate</span></a>) :<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">(</span></a><span class="id" title="keyword">forall</span> <a id="chain:690" class="idref" href="#chain:690"><span class="id" title="binder">chain</span></a> <a id="ctx:691" class="idref" href="#ctx:691"><span class="id" title="binder">ctx</span></a> <a id="setup:692" class="idref" href="#setup:692"><span class="id" title="binder">setup</span></a> <a id="result:693" class="idref" href="#result:693"><span class="id" title="binder">result</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#contract:686"><span class="id" title="variable">contract</span></a>.(<a class="idref" href="ConCert.Execution.Blockchain.html#init"><span class="id" title="projection">init</span></a>) <a class="idref" href="ConCert.Execution.Blockchain.html#chain:690"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ctx:691"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#setup:692"><span class="id" title="variable">setup</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#result:693"><span class="id" title="variable">result</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#P:685"><span class="id" title="variable">P</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#build_deployment_info"><span class="id" title="constructor">build_deployment_info</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#ctx_origin"><span class="id" title="projection">ctx_origin</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ctx:691"><span class="id" title="variable">ctx</span></a>) (<a class="idref" href="ConCert.Execution.Blockchain.html#ctx_from"><span class="id" title="projection">ctx_from</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ctx:691"><span class="id" title="variable">ctx</span></a>) (<a class="idref" href="ConCert.Execution.Blockchain.html#ctx_amount"><span class="id" title="projection">ctx_amount</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ctx:691"><span class="id" title="variable">ctx</span></a>) <a class="idref" href="ConCert.Execution.Blockchain.html#setup:692"><span class="id" title="variable">setup</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#result:693"><span class="id" title="variable">result</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">(</span></a><span class="id" title="keyword">forall</span> <a id="chain:694" class="idref" href="#chain:694"><span class="id" title="binder">chain</span></a> <a id="ctx:695" class="idref" href="#ctx:695"><span class="id" title="binder">ctx</span></a> <a id="cstate:696" class="idref" href="#cstate:696"><span class="id" title="binder">cstate</span></a> <a id="msg:697" class="idref" href="#msg:697"><span class="id" title="binder">msg</span></a> <a id="new_cstate:698" class="idref" href="#new_cstate:698"><span class="id" title="binder">new_cstate</span></a> <a id="acts:699" class="idref" href="#acts:699"><span class="id" title="binder">acts</span></a> <a id="dep:700" class="idref" href="#dep:700"><span class="id" title="binder">dep</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#P:685"><span class="id" title="variable">P</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#dep:700"><span class="id" title="variable">dep</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#cstate:696"><span class="id" title="variable">cstate</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#contract:686"><span class="id" title="variable">contract</span></a>.(<a class="idref" href="ConCert.Execution.Blockchain.html#receive"><span class="id" title="projection">receive</span></a>) <a class="idref" href="ConCert.Execution.Blockchain.html#chain:694"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ctx:695"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#cstate:696"><span class="id" title="variable">cstate</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#msg:697"><span class="id" title="variable">msg</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Execution.Blockchain.html#new_cstate:698"><span class="id" title="variable">new_cstate</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#acts:699"><span class="id" title="variable">acts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#P:685"><span class="id" title="variable">P</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#dep:700"><span class="id" title="variable">dep</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#new_cstate:698"><span class="id" title="variable">new_cstate</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#env_contracts"><span class="id" title="projection">env_contracts</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#bstate:687"><span class="id" title="variable">bstate</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#addr:688"><span class="id" title="variable">addr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#contract:686"><span class="id" title="variable">contract</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#WeakContract"><span class="id" title="inductive">WeakContract</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">exists</span></a> <a id="dep:701" class="idref" href="#dep:701"><span class="id" title="binder">dep</span></a> <a id="cstate:702" class="idref" href="#cstate:702"><span class="id" title="binder">cstate</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#deployment_info"><span class="id" title="definition">deployment_info</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#LiftTransactionProp.Setup"><span class="id" title="variable">Setup</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#trace:689"><span class="id" title="variable">trace</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#addr:688"><span class="id" title="variable">addr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#dep:701"><span class="id" title="variable">dep</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#contract_state"><span class="id" title="definition">contract_state</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#bstate:687"><span class="id" title="variable">bstate</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#addr:688"><span class="id" title="variable">addr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#cstate:702"><span class="id" title="variable">cstate</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#P:685"><span class="id" title="variable">P</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#dep:701"><span class="id" title="variable">dep</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#cstate:702"><span class="id" title="variable">cstate</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">Hinit</span> <span class="id" title="var">Hreceive</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">contract_induction</span>; <span class="id" title="tactic">intros</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <span class="id" title="var">Hinit</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <span class="id" title="var">Hreceive</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <span class="id" title="var">Hreceive</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">instantiate</span> (<span class="id" title="var">AddBlockFacts</span> := <span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#True"><span class="id" title="inductive">Logic.True</span></a>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">instantiate</span> (<span class="id" title="var">DeployFacts</span> := <span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#True"><span class="id" title="inductive">Logic.True</span></a>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">instantiate</span> (<span class="id" title="var">CallFacts</span> := <span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib/Coq.Init.Logic.html#True"><span class="id" title="inductive">Logic.True</span></a>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">unset_all</span>; <span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">step</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">a</span>; <span class="id" title="tactic">auto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">End</span> <a class="idref" href="ConCert.Execution.Blockchain.html#LiftTransactionProp"><span class="id" title="section">LiftTransactionProp</span></a>.<br/>
</div>
</div>
<div id="footer">
  Generated by <a href="https://coq.inria.fr/">coqdoc</a> and improved with <a href="https://github.com/tebbi/coqdocjs">CoqdocJS</a> and <a href="https://github.com/jgallen23/toc">TOC</a>
</div>
</div>
<script>
  const elements = document.getElementsByClassName("libtitle");
  while(elements.length > 0){
        elements[0].parentNode.removeChild(elements[0]);
  }
  if (window.location.pathname.endsWith("/toc.html")) {
      const jstocDiv = document.getElementById("js-toc");
      jstocDiv.classList.remove("toc");
      jstocDiv.classList.add("jstoc-hidden");
      const jstocHeaderDiv = document.getElementById("js-toc-header");
      jstocHeaderDiv.classList.add("jstoc-hidden");
      const mainDiv = document.getElementById("main");
      mainDiv.classList.add("jstoc-hidden-main");
      const toggleDiv = document.getElementById("toggle-toc");
      toggleDiv.classList.add("jstoc-hidden");
  }
  console.log(window.location.pathname);
</script>
<script type="text/javascript" src="toc.js"></script>
</body>

</html>
